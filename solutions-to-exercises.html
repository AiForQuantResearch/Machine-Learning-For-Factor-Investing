<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 19 Solutions to exercises | Machine Learning for Factor Investing</title>
<meta name="author" content="Guillaume Coqueret and Tony Guida">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 19 Solutions to exercises | Machine Learning for Factor Investing">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 19 Solutions to exercises | Machine Learning for Factor Investing">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><meta name="description" content=".container-fluid main { max-width: 60rem; }  19.1 Chapter 3 For annual values, see 19.1: data_ml %&gt;%   group_by(date) %&gt;%                         mutate(growth = Pb &gt; median(Pb)) %&gt;%      #...">
<meta property="og:description" content=".container-fluid main { max-width: 60rem; }  19.1 Chapter 3 For annual values, see 19.1: data_ml %&gt;%   group_by(date) %&gt;%                         mutate(growth = Pb &gt; median(Pb)) %&gt;%      #...">
<meta name="twitter:description" content=".container-fluid main { max-width: 60rem; }  19.1 Chapter 3 For annual values, see 19.1: data_ml %&gt;%   group_by(date) %&gt;%                         mutate(growth = Pb &gt; median(Pb)) %&gt;%      #...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Machine Learning for Factor Investing</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="notdata.html"><span class="header-section-number">1</span> Notations and data</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="factor.html"><span class="header-section-number">3</span> Factor investing and asset pricing anomalies</a></li>
<li><a class="" href="Data.html"><span class="header-section-number">4</span> Data preprocessing</a></li>
<li class="book-part">Common supervised algorithms</li>
<li><a class="" href="lasso.html"><span class="header-section-number">5</span> Penalized regressions and sparse hedging for minimum variance portfolios</a></li>
<li><a class="" href="trees.html"><span class="header-section-number">6</span> Tree-based methods</a></li>
<li><a class="" href="NN.html"><span class="header-section-number">7</span> Neural networks</a></li>
<li><a class="" href="svm.html"><span class="header-section-number">8</span> Support vector machines</a></li>
<li><a class="" href="bayes.html"><span class="header-section-number">9</span> Bayesian methods</a></li>
<li class="book-part">From predictions to portfolios</li>
<li><a class="" href="valtune.html"><span class="header-section-number">10</span> Validating and tuning</a></li>
<li><a class="" href="ensemble.html"><span class="header-section-number">11</span> Ensemble models</a></li>
<li><a class="" href="backtest.html"><span class="header-section-number">12</span> Portfolio backtesting</a></li>
<li class="book-part">Further important topics</li>
<li><a class="" href="interp.html"><span class="header-section-number">13</span> Interpretability</a></li>
<li><a class="" href="causality.html"><span class="header-section-number">14</span> Two key concepts: causality and non-stationarity</a></li>
<li><a class="" href="unsup.html"><span class="header-section-number">15</span> Unsupervised learning</a></li>
<li><a class="" href="RL.html"><span class="header-section-number">16</span> Reinforcement learning</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="data-description.html"><span class="header-section-number">17</span> Data description</a></li>
<li><a class="" href="python.html"><span class="header-section-number">18</span> Python notebooks</a></li>
<li><a class="active" href="solutions-to-exercises.html"><span class="header-section-number">19</span> Solutions to exercises</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="solutions-to-exercises" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Solutions to exercises<a class="anchor" aria-label="anchor" href="#solutions-to-exercises"><i class="fas fa-link"></i></a>
</h1>
<style>
.container-fluid main {
max-width: 60rem;
}
</style>
<div id="chapter-3" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Chapter 3<a class="anchor" aria-label="anchor" href="#chapter-3"><i class="fas fa-link"></i></a>
</h2>
<p>For annual values, see <a href="solutions-to-exercises.html#fig:ex41b">19.1</a>:
</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                            
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>growth <span class="op">=</span> <span class="va">Pb</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Pb</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>            <span class="co"># Creates the sort</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                   <span class="co"># Ungroup</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>        <span class="co"># Creates a year variable</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">growth</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                      <span class="co"># Analyze by year &amp; sort</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarize</a></span><span class="op">(</span>ret <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>              <span class="co"># Compute average return</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">ret</span>, fill <span class="op">=</span> <span class="va">growth</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Plot!</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex41b"></span>
<img src="ML_factor_files/figure-html/ex41b-1.png" alt="The value factor: annual returns." width="400px" height="150px"><p class="caption">
FIGURE 19.1: The value factor: annual returns.
</p>
</div>
<p></p>
<p>For monthly values, see <a href="solutions-to-exercises.html#fig:ex41">19.2</a>:
</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">returns_m</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                            
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>growth <span class="op">=</span> <span class="va">Pb</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Pb</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                         <span class="co"># Creates the sort</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">growth</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                   <span class="co"># Analyze by date &amp; sort</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarize</a></span><span class="op">(</span>ret <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                           <span class="co"># Compute average return</span>
    <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/spread.html">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">growth</span>, value <span class="op">=</span> <span class="va">ret</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                        <span class="co"># Pivot to wide matrix format</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">returns_m</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"value"</span>, <span class="st">"growth"</span><span class="op">)</span>                 <span class="co"># Changing column names</span>
<span class="va">returns_m</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">value</span><span class="op">)</span>,                           <span class="co"># From returns to portf. values</span>
           growth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">growth</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">portfolio</span>, value <span class="op">=</span> <span class="va">value</span>, <span class="op">-</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>            <span class="co"># Back in tidy format</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">portfolio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>     <span class="co"># Plot!  </span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex41"></span>
<img src="ML_factor_files/figure-html/ex41-1.png" alt="The value factor: portfolio values." width="400px" height="150px"><p class="caption">
FIGURE 19.2: The value factor: portfolio values.
</p>
</div>
<p></p>
<p>Portfolios based on quartiles, using the tidyverse only. We rely heavily on the fact that features are uniformized, i.e., that their distribution is uniform for each given date. Overall, small firms outperform heavily (see Figure <a href="solutions-to-exercises.html#fig:ex43">19.3</a>).</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>small <span class="op">=</span> <span class="va">Mkt_Cap_6M_Usd</span> <span class="op">&lt;=</span> <span class="fl">0.25</span>,                        <span class="co"># Small firms...</span>
           medium <span class="op">=</span> <span class="va">Mkt_Cap_6M_Usd</span> <span class="op">&gt;</span> <span class="fl">0.25</span> <span class="op">&amp;</span> <span class="va">Mkt_Cap_6M_Usd</span> <span class="op">&lt;=</span> <span class="fl">0.5</span>, 
           large <span class="op">=</span> <span class="va">Mkt_Cap_6M_Usd</span> <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">&amp;</span> <span class="va">Mkt_Cap_6M_Usd</span> <span class="op">&lt;=</span> <span class="fl">0.75</span>,
           xl <span class="op">=</span> <span class="va">Mkt_Cap_6M_Usd</span> <span class="op">&gt;</span> <span class="fl">0.75</span>,                            <span class="co"># ...Xlarge firms</span>
           year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                        
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarize</a></span><span class="op">(</span>small <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">small</span> <span class="op">*</span> <span class="va">R1M_Usd</span><span class="op">)</span>,                      <span class="co"># Compute avg returns</span>
              medium <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">medium</span> <span class="op">*</span> <span class="va">R1M_Usd</span><span class="op">)</span>,
              large <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">large</span> <span class="op">*</span> <span class="va">R1M_Usd</span><span class="op">)</span>,
              xl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xl</span> <span class="op">*</span> <span class="va">R1M_Usd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">size</span>, value <span class="op">=</span> <span class="va">return</span>, <span class="op">-</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">return</span>, fill <span class="op">=</span> <span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex43"></span>
<img src="ML_factor_files/figure-html/ex43-1.png" alt="The value factor: portfolio values." width="432"><p class="caption">
FIGURE 19.3: The value factor: portfolio values.
</p>
</div>
<p></p>
</div>
<div id="chapter-4" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Chapter 4<a class="anchor" aria-label="anchor" href="#chapter-4"><i class="fas fa-link"></i></a>
</h2>
<p>Below, we import a credit spread supplied by Bank of America. Its symbol/ticker is “BAMLC0A0CM.” We apply the data expansion on the small number of predictors to save memory space. One important trick that should not be overlooked is the uniformization step after the product <a href="Data.html#eq:macrocond">(4.3)</a> is computed. Indeed, we want the new features to have the same properties as the old ones. If we skip this step, distributions will be altered, as we show in one example below.</p>
<p>We start with the data extraction and joining. It’s important to join early so as to keep the highest data frequency (daily) in order to replace missing points with <strong>close values</strong>. Joining with monthly data before replacing creates unnecessary lags.</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.FRED.html">getSymbols.FRED</a></span><span class="op">(</span><span class="st">"BAMLC0A0CM"</span>,                                    <span class="co"># Extract data</span>
                env <span class="op">=</span> <span class="st">".GlobalEnv"</span>, 
                return.class <span class="op">=</span> <span class="st">"xts"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "BAMLC0A0CM"</code></pre>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cred_spread</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/fortify.html">fortify</a></span><span class="op">(</span><span class="va">BAMLC0A0CM</span><span class="op">)</span>                               <span class="co"># Transform to dataframe</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cred_spread</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"spread"</span><span class="op">)</span>                     <span class="co"># Change column name</span>
<span class="va">cred_spread</span> <span class="op">&lt;-</span> <span class="va">cred_spread</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                   <span class="co"># Take extraction and...</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>  <span class="co"># Join!</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>spread <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/na.locf.html">na.locf</a></span><span class="op">(</span><span class="va">spread</span><span class="op">)</span><span class="op">)</span>                             <span class="co"># Replace NA by previous</span>
<span class="va">cred_spread</span> <span class="op">&lt;-</span> <span class="va">cred_spread</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">cred_spread</span><span class="op">)</span>,<span class="op">]</span>            <span class="co"># Remove duplicates</span></code></pre></div>
<p></p>
<p>The creation of the augmented dataset requires some manipulation. Features are no longer uniform as is shown in Figure <a href="solutions-to-exercises.html#fig:ex5b">19.4</a>.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_cond</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                    <span class="co"># Create new dataset</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"stock_id"</span>, <span class="st">"date"</span>, <span class="va">features_short</span><span class="op">)</span><span class="op">)</span>
<span class="va">names_cred_spread</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">features_short</span>, <span class="st">"_cred_spread"</span><span class="op">)</span> <span class="co"># New column names</span>
<span class="va">feat_cred_spread</span> <span class="op">&lt;-</span> <span class="va">data_cond</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                           <span class="co"># Old values</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features_short</span><span class="op">)</span>
<span class="va">cred_spread</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                  <span class="co"># Create vector of spreads</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">cred_spread</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> 
<span class="va">feat_cred_spread</span> <span class="op">&lt;-</span> <span class="va">feat_cred_spread</span> <span class="op">*</span>                      <span class="co"># This product creates...</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">cred_spread</span><span class="op">$</span><span class="va">spread</span>,                              <span class="co"># the new values...</span>
           <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cred_spread</span><span class="op">$</span><span class="va">spread</span><span class="op">)</span>,                      <span class="co"># using duplicated...</span>
           <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">features_short</span><span class="op">)</span><span class="op">)</span>                          <span class="co"># columns</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">feat_cred_spread</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">names_cred_spread</span>             <span class="co"># New column names</span>
<span class="va">data_cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">data_cond</span>, <span class="va">feat_cred_spread</span><span class="op">)</span>         <span class="co"># Aggregate old &amp; new</span>
<span class="va">data_cond</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Eps_cred_spread</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Plot example</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex5b"></span>
<img src="ML_factor_files/figure-html/ex5b-1.png" alt="Distribution of Eps after conditioning." width="400px" height="150px"><p class="caption">
FIGURE 19.4: Distribution of Eps after conditioning.
</p>
</div>
<p></p>
<p>To prevent this issue, uniformization is required and is verified in Figure <a href="solutions-to-exercises.html#fig:ex51c">19.5</a>. </p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_cond</span> <span class="op">&lt;-</span> <span class="va">data_cond</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                   <span class="co"># From new dataset</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                       <span class="co"># Group by date and...</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="va">names_cred_spread</span>, <span class="va">norm_unif</span><span class="op">)</span>  <span class="co"># Uniformize the new features</span>
<span class="va">data_cond</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Eps_cred_spread</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># Verification</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex51c"></span>
<img src="ML_factor_files/figure-html/ex51c-1.png" alt="Distribution of uniformized conditioned feature values." width="400px" height="150px"><p class="caption">
FIGURE 19.5: Distribution of uniformized conditioned feature values.
</p>
</div>
<p></p>
<p>The second question naturally requires the downloading of VIX series first and the joining with the original data.</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.FRED.html">getSymbols.FRED</a></span><span class="op">(</span><span class="st">"VIXCLS"</span>,                           <span class="co"># Extract data</span>
                env <span class="op">=</span> <span class="st">".GlobalEnv"</span>, 
                return.class <span class="op">=</span> <span class="st">"xts"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "VIXCLS"</code></pre>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/fortify.html">fortify</a></span><span class="op">(</span><span class="va">VIXCLS</span><span class="op">)</span>                              <span class="co"># Transform to dataframe</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"vix"</span><span class="op">)</span>                   <span class="co"># Change column name</span>
<span class="va">vix</span> <span class="op">&lt;-</span> <span class="va">vix</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                      <span class="co"># Take extraction and...</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>    <span class="co"># Join! </span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>vix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/na.locf.html">na.locf</a></span><span class="op">(</span><span class="va">vix</span><span class="op">)</span><span class="op">)</span>                      <span class="co"># Replace NA by previous</span>
<span class="va">vix</span> <span class="op">&lt;-</span> <span class="va">vix</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">vix</span><span class="op">)</span>,<span class="op">]</span>                       <span class="co"># Remove duplicates</span>
<span class="va">vix</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                  <span class="co"># Keep original data format</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                         <span class="co"># ...</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">vix</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span>                     <span class="co"># Via left_join()</span></code></pre></div>
<p></p>
<p>We can then proceed with the categorization. We create the vector label in a new (smaller) dataset but not attached to the large data_ml variable. Also, we check the balance of labels and its evolution through time (see Figure <a href="solutions-to-exercises.html#fig:ex52b">19.6</a>).</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>                                       <span class="co"># Magnitude of vix correction</span>
<span class="va">vix_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">vix</span><span class="op">$</span><span class="va">vix</span><span class="op">)</span>                         <span class="co"># Median of vix</span>
<span class="va">data_vix</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                            <span class="co"># Smaller dataset</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">stock_id</span>, <span class="va">date</span>, <span class="va">R1M_Usd</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>r_minus <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">0.02</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">delta</span><span class="op">*</span><span class="op">(</span><span class="va">vix</span><span class="op">$</span><span class="va">vix</span><span class="op">-</span><span class="va">vix_bar</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># r_-</span>
           r_plus <span class="op">=</span> <span class="fl">0.02</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">delta</span><span class="op">*</span><span class="op">(</span><span class="va">vix</span><span class="op">$</span><span class="va">vix</span><span class="op">-</span><span class="va">vix_bar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>       <span class="co"># r_+</span>
<span class="va">data_vix</span> <span class="op">&lt;-</span> <span class="va">data_vix</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>R1M_Usd_Cvix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/if_else.html">if_else</a></span><span class="op">(</span><span class="va">R1M_Usd</span> <span class="op">&lt;</span> <span class="va">r_minus</span>, <span class="op">-</span><span class="fl">1</span>,       <span class="co"># New label!</span>
                                  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/if_else.html">if_else</a></span><span class="op">(</span><span class="va">R1M_Usd</span> <span class="op">&gt;</span> <span class="va">r_plus</span>, <span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
           R1M_Usd_Cvix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">R1M_Usd_Cvix</span><span class="op">)</span><span class="op">)</span>
<span class="va">data_vix</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">R1M_Usd_Cvix</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarize</a></span><span class="op">(</span>nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">nb</span>, fill <span class="op">=</span> <span class="va">R1M_Usd_Cvix</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex52b"></span>
<img src="ML_factor_files/figure-html/ex52b-1.png" alt="Evolution of categories through time." width="400px" height="150px"><p class="caption">
FIGURE 19.6: Evolution of categories through time.
</p>
</div>
<p></p>
<p>Finally, we switch to the outliers (Figure <a href="solutions-to-exercises.html#fig:ex53a">19.7</a>). </p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">R12M_Usd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex53a"></span>
<img src="ML_factor_files/figure-html/ex53a-1.png" alt="Outliers in the dependent variable." width="400px" height="150px"><p class="caption">
FIGURE 19.7: Outliers in the dependent variable.
</p>
</div>
<p></p>
<p>Returns above 50 should indeed be rare.</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">R12M_Usd</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">stock_id</span>, <span class="va">date</span>, <span class="va">R12M_Usd</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   stock_id date       R12M_Usd
##      &lt;int&gt; &lt;date&gt;        &lt;dbl&gt;
## 1      212 2000-12-31     53.0
## 2      221 2008-12-31     53.5
## 3      221 2009-01-31     55.2
## 4      221 2009-02-28     54.8
## 5      296 2002-06-30     72.2
## 6      683 2009-02-28     96.0
## 7      683 2009-03-31     64.8
## 8      862 2009-02-28     58.0</code></pre>
<p></p>
<p>The largest return comes from stock #683. Let’s have a look at the stream of monthly returns in 2009.</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">stock_id</span> <span class="op">==</span> <span class="fl">683</span>, <span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2009</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">R1M_Usd</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 2
##    date       R1M_Usd
##    &lt;date&gt;       &lt;dbl&gt;
##  1 2009-01-31  -0.625
##  2 2009-02-28   0.472
##  3 2009-03-31   1.44 
##  4 2009-04-30   0.139
##  5 2009-05-31   0.086
##  6 2009-06-30   0.185
##  7 2009-07-31   0.363
##  8 2009-08-31   0.103
##  9 2009-09-30   9.91 
## 10 2009-10-31   0.101
## 11 2009-11-30   0.202
## 12 2009-12-31  -0.251</code></pre>
<p></p>
<p>The returns are all very high. The annual value is plausible. In addition, a quick glance at the Vol1Y values shows that the stock is the most volatile of the dataset.</p>
</div>
<div id="chapter-5" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Chapter 5<a class="anchor" aria-label="anchor" href="#chapter-5"><i class="fas fa-link"></i></a>
</h2>
<p>We recycle the training and testing data variables created in the chapter (coding section notably). In addition, we create a dedicated function and resort to the <em>map2</em>() function from the <em>purrr</em> package.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha_seq</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>                     <span class="co"># Sequence of alpha values</span>
<span class="va">lambda_seq</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>                    <span class="co"># Sequence of lambda values</span>
<span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">alpha_seq</span>, <span class="va">lambda_seq</span><span class="op">)</span> <span class="co"># Exploring all combinations!</span>
<span class="va">alpha_seq</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">lambda_seq</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>
<span class="va">lasso_sens</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">lambda</span>, <span class="va">x_train</span>, <span class="va">y_train</span>, <span class="va">x_test</span>, <span class="va">y_test</span><span class="op">)</span><span class="op">{</span> <span class="co"># Function</span>
    <span class="va">fit_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x_train</span>, <span class="va">y_train</span>,                                 <span class="co"># Model</span>
                       alpha <span class="op">=</span> <span class="va">alpha</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_temp</span>, <span class="va">x_test</span><span class="op">)</span> <span class="op">-</span> <span class="va">y_test</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>           <span class="co"># Output</span>
<span class="op">}</span>
<span class="va">rmse_elas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map2.html">map2</a></span><span class="op">(</span><span class="va">alpha_seq</span>, <span class="va">lambda_seq</span>, <span class="va">lasso_sens</span>,                     <span class="co"># Automation</span>
                  x_train <span class="op">=</span> <span class="va">x_penalized_train</span>, y_train <span class="op">=</span> <span class="va">y_penalized_train</span>,
                  x_test <span class="op">=</span> <span class="va">x_penalized_test</span>, y_test <span class="op">=</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">alpha_seq</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lambda_seq</span><span class="op">)</span>, rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">rmse_elas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">rmse</span>, fill <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">~</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.19</span>,<span class="fl">0.193</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ex61"></span>
<img src="ML_factor_files/figure-html/ex61-1.png" alt="Performance of elasticnet across parameter values." width="432"><p class="caption">
FIGURE 19.8: Performance of elasticnet across parameter values.
</p>
</div>
<p></p>
<p>As is outlined in Figure <a href="solutions-to-exercises.html#fig:ex61">19.8</a>, the parameters have a very marginal impact. Maybe the model is not a good fit for the task.</p>
</div>
<div id="chapter-6" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> Chapter 6<a class="anchor" aria-label="anchor" href="#chapter-6"><i class="fas fa-link"></i></a>
</h2>
<p>
</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">formula</span>, 
              data <span class="op">=</span> <span class="va">training_sample</span>,     <span class="co"># Data source: full sample</span>
              cp <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>                 <span class="co"># Precision: smaller = more leaves</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">testing_sample</span><span class="op">)</span> <span class="op">-</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> </code></pre></div>
<pre><code>## [1] 0.04018973</code></pre>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">formula</span>,
              data <span class="op">=</span> <span class="va">training_sample</span>,     <span class="co"># Data source: full sample</span>
              cp <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>                  <span class="co"># Precision: smaller = more leaves</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">testing_sample</span><span class="op">)</span> <span class="op">-</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># Test!</span></code></pre></div>
<pre><code>## [1] 0.03699696</code></pre>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span>                         <span class="co"># Plot the first tree</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex71"></span>
<img src="ML_factor_files/figure-html/ex71-1.png" alt="Sample (complex) tree." width="480"><p class="caption">
FIGURE 19.9: Sample (complex) tree.
</p>
</div>
<p></p>
<p>The first model (Figure <a href="solutions-to-exercises.html#fig:ex71">19.9</a>) is <strong>too</strong> precise: going into the details of the training sample does not translate to good performance out-of-sample. The second, simpler model, yields better results.</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">80</span>, <span class="fl">160</span><span class="op">)</span>
<span class="va">mse_RF</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n_trees</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>       <span class="co"># No need for functional programming here...</span>
    <span class="va">fit_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"R1M_Usd ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">features_short</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># New formula!</span>
        data <span class="op">=</span> <span class="va">training_sample</span>,    <span class="co"># Data source: training sample</span>
        sampsize <span class="op">=</span> <span class="fl">30000</span>,          <span class="co"># Size of (random) sample for each tree</span>
        replace <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co"># Is the sampling done with replacement?</span>
        ntree <span class="op">=</span> <span class="va">n_trees</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,        <span class="co"># Nb of random trees</span>
        mtry <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>                  <span class="co"># Nb of predictors for each tree</span>
    <span class="va">mse_RF</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_temp</span>, <span class="va">testing_sample</span><span class="op">)</span> <span class="op">-</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">mse_RF</span></code></pre></div>
<pre><code>## [1] 0.03967754 0.03885924 0.03766900 0.03696370 0.03699772</code></pre>
<p></p>
<p>Trees are by definition random so results can vary from test to test. Overall, large numbers of trees are preferable and the reason is that each new tree tells a new story and diversifies the risk of the whole forest. Some more technical details of why that may be the case are outlined in the original paper by <span class="citation"><a href="solutions-to-exercises.html#ref-breiman2001random" role="doc-biblioref">Breiman</a> (<a href="solutions-to-exercises.html#ref-breiman2001random" role="doc-biblioref">2001</a>)</span>.</p>
<p>For the last exercises, we recycle the <em>formula</em> used in Chapter <a href="trees.html#trees">6</a>. </p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree_2008</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">formula</span>,
                   data <span class="op">=</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2008</span><span class="op">)</span>, <span class="co"># Data source: 2008</span>
                   cp <span class="op">=</span> <span class="fl">0.001</span>,
                   maxdepth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">tree_2008</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex73a"></span>
<img src="ML_factor_files/figure-html/ex73a-1.png" alt="Tree for 2008." width="384"><p class="caption">
FIGURE 19.10: Tree for 2008.
</p>
</div>
<p></p>
<p>The first splitting criterion in Figure <a href="solutions-to-exercises.html#fig:ex73a">19.10</a> is enterprise value (EV). EV is an indicator that adjusts market capitalization by substracting debt and adding cash. It is a more faithful account of the true value of a company. In 2008, the companies that fared the least poorly were those with the highest EV (i.e., large, robust firms).</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree_2009</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">formula</span>,
                   data <span class="op">=</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2009</span><span class="op">)</span>, <span class="co"># Data source: 2009</span>
                   cp <span class="op">=</span> <span class="fl">0.001</span>,
                   maxdepth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">tree_2009</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex73b"></span>
<img src="ML_factor_files/figure-html/ex73b-1.png" alt="Tree for 2009." width="384"><p class="caption">
FIGURE 19.11: Tree for 2009.
</p>
</div>
<p></p>
<p>In 2009 (Figure <a href="solutions-to-exercises.html#fig:ex73b">19.11</a>), the firms that recovered the fastest were those that experienced high volatility in the past (likely, downwards volatility). Momentum is also very important: the firms with the lowest past returns are those that rebound the fastest. This is a typical example of the momentum crash phenomenon studied in <span class="citation"><a href="solutions-to-exercises.html#ref-barroso2015momentum" role="doc-biblioref">Barroso and Santa-Clara</a> (<a href="solutions-to-exercises.html#ref-barroso2015momentum" role="doc-biblioref">2015</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-daniel2016momentum" role="doc-biblioref">K. Daniel and Moskowitz</a> (<a href="solutions-to-exercises.html#ref-daniel2016momentum" role="doc-biblioref">2016</a>)</span>. The rationale is the following: after a market downturn, the stocks with the most potential for growth are those that have suffered the largest losses. Consequently, the negative (short) leg of the momentum factor performs very well, often better than the long leg. And indeed, being long in the momentum factor in 2009 would have generated negative profits.</p>
</div>
<div id="chapter-7-the-autoencoder-model-universal-approximation" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> Chapter 7: the autoencoder model &amp; universal approximation<a class="anchor" aria-label="anchor" href="#chapter-7-the-autoencoder-model-universal-approximation"><i class="fas fa-link"></i></a>
</h2>
<p>
First, it is imperative to format the inputs properly. To avoid any issues, we work with perfectly rectangular data and hence restrict the investment set to the stocks with no missing points. Dimensions must also be in the correct order.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_short</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>         <span class="co"># Shorter dataset</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">stock_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">stock_ids_short</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"stock_id"</span>, <span class="st">"date"</span>,<span class="va">features_short</span>, <span class="st">"R1M_Usd"</span><span class="op">)</span><span class="op">)</span>
<span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data_short</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>  <span class="co"># Vector of dates</span>

<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">stock_ids_short</span><span class="op">)</span>      <span class="co"># Dimension for assets</span>
<span class="va">Tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dates</span><span class="op">)</span>               <span class="co"># Dimension for dates</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">features_short</span><span class="op">)</span>       <span class="co"># Dimension for features</span>

<span class="va">factor_data</span> <span class="op">&lt;-</span> <span class="va">data_short</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>  <span class="co"># Factor side date</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">stock_id</span>, <span class="va">R1M_Usd</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/spread.html">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">stock_id</span>, value <span class="op">=</span> <span class="va">R1M_Usd</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">beta_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">data_short</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>  <span class="co"># Beta side data: beware the permutation below!</span>
                              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">stock_id</span>, <span class="op">-</span><span class="va">date</span>, <span class="op">-</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">)</span>, 
                   dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">Tt</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span>
<span class="va">beta_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/aperm.html">aperm</a></span><span class="op">(</span><span class="va">beta_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Permutation</span></code></pre></div>
<p></p>
<p>Next, we turn to the specification of the network, using a functional API form.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">main_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"main_input"</span><span class="op">)</span>  <span class="co"># Main input: returns      </span>
<span class="va">factor_network</span> <span class="op">&lt;-</span> <span class="va">main_input</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                              <span class="co"># Def of factor side network</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">8</span>, activation <span class="op">=</span> <span class="st">"relu"</span>, name <span class="op">=</span> <span class="st">"layer_1_r"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">4</span>, activation <span class="op">=</span> <span class="st">"tanh"</span>, name <span class="op">=</span> <span class="st">"layer_2_r"</span><span class="op">)</span> 

<span class="va">aux_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">K</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"aux_input"</span><span class="op">)</span>  <span class="co"># Aux input: characteristics</span>
<span class="va">beta_network</span> <span class="op">&lt;-</span> <span class="va">aux_input</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                 <span class="co"># Def of beta side network</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">8</span>, activation <span class="op">=</span> <span class="st">"relu"</span>, name <span class="op">=</span> <span class="st">"layer_1_l"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">4</span>, activation <span class="op">=</span> <span class="st">"tanh"</span>, name <span class="op">=</span> <span class="st">"layer_2_l"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_permute.html">layer_permute</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"layer_3_l"</span><span class="op">)</span>          <span class="co"># Permutation!</span>

<span class="va">main_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dot.html">layer_dot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta_network</span>, <span class="va">factor_network</span><span class="op">)</span>,     <span class="co"># Product of 2 networks</span>
                         axes <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"main_output"</span><span class="op">)</span> 

<span class="va">model_ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model.html">keras_model</a></span><span class="op">(</span>                                      <span class="co"># AE Model specs</span>
    inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">main_input</span>, <span class="va">aux_input</span><span class="op">)</span>,
    outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">main_output</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p></p>
<p>Finally, we ask for the structure of the model, and train it.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_ae</span><span class="op">)</span>                      <span class="co"># See model details / architecture</span></code></pre></div>
<pre><code>## Model: "model_1"
## __________________________________________________________________________________________
## Layer (type)                 Output Shape        Param #    Connected to                  
## ==========================================================================================
## aux_input (InputLayer)       [(None, 793, 7)]    0                                        
## __________________________________________________________________________________________
## layer_1_l (Dense)            (None, 793, 8)      64         aux_input[0][0]               
## __________________________________________________________________________________________
## main_input (InputLayer)      [(None, 793)]       0                                        
## __________________________________________________________________________________________
## layer_2_l (Dense)            (None, 793, 4)      36         layer_1_l[0][0]               
## __________________________________________________________________________________________
## layer_1_r (Dense)            (None, 8)           6352       main_input[0][0]              
## __________________________________________________________________________________________
## layer_3_l (Permute)          (None, 4, 793)      0          layer_2_l[0][0]               
## __________________________________________________________________________________________
## layer_2_r (Dense)            (None, 4)           36         layer_1_r[0][0]               
## __________________________________________________________________________________________
## main_output (Dot)            (None, 793)         0          layer_3_l[0][0]               
##                                                             layer_2_r[0][0]               
## ==========================================================================================
## Total params: 6,488
## Trainable params: 6,488
## Non-trainable params: 0
## __________________________________________________________________________________________</code></pre>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_ae</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/compile.html">compile</a></span><span class="op">(</span>           <span class="co"># Learning parameters</span>
    optimizer <span class="op">=</span> <span class="st">"rmsprop"</span>,
    loss <span class="op">=</span> <span class="st">"mean_squared_error"</span>
<span class="op">)</span>

<span class="va">model_ae</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/generics/man/fit.html">fit</a></span><span class="op">(</span>                      <span class="co"># Learning function</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>main_input <span class="op">=</span> <span class="va">factor_data</span>, aux_input <span class="op">=</span> <span class="va">beta_data</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>main_output <span class="op">=</span> <span class="va">factor_data</span><span class="op">)</span>,
    epochs <span class="op">=</span> <span class="fl">20</span>,                      <span class="co"># Nb rounds</span>
    batch_size <span class="op">=</span> <span class="fl">49</span>                   <span class="co"># Nb obs. per round</span>
<span class="op">)</span></code></pre></div>
<p></p>
<p>For the second exercise, we use a simple architecture. The activation function, number of epochs and batch size may matter…</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_ua</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model_sequential.html">keras_model_sequential</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">model_ua</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>   <span class="co"># This defines the structure of the network, i.e. how layers are organized</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">16</span>, activation <span class="op">=</span> <span class="st">'sigmoid'</span>, input_shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># </span>
<span class="va">model_ua</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/compile.html">compile</a></span><span class="op">(</span>                      <span class="co"># Model specification</span>
    loss <span class="op">=</span> <span class="st">'mean_squared_error'</span>,                  <span class="co"># Loss function</span>
    optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/optimizer_rmsprop.html">optimizer_rmsprop</a></span><span class="op">(</span><span class="op">)</span>,              <span class="co"># Optimisation method (weight updating)</span>
    metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mean_absolute_error'</span><span class="op">)</span>            <span class="co"># Output metric</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_ua</span><span class="op">)</span>                                 <span class="co"># A simple model!</span></code></pre></div>
<pre><code>## Model: "sequential_7"
## __________________________________________________________________________________________
## Layer (type)                            Output Shape                        Param #       
## ==========================================================================================
## dense_22 (Dense)                        (None, 16)                          32            
## __________________________________________________________________________________________
## dense_21 (Dense)                        (None, 1)                           17            
## ==========================================================================================
## Total params: 49
## Trainable params: 49
## Non-trainable params: 0
## __________________________________________________________________________________________</code></pre>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_ua</span> <span class="op">&lt;-</span> <span class="va">model_ua</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/generics/man/fit.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,              <span class="co"># Training data = x</span>
        <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,         <span class="co"># Training label = y</span>
        epochs <span class="op">=</span> <span class="fl">30</span>, batch_size <span class="op">=</span> <span class="fl">64</span>                             <span class="co"># Training parameters</span>
<span class="op">)</span> </code></pre></div>
<p></p>
<p>In full disclosure, to improve the fit, we also increase the sample size. We show the improvement in the figure below.</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">model_ua2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model_sequential.html">keras_model_sequential</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">model_ua2</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>   <span class="co"># This defines the structure of the network, i.e. how layers are organized</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">128</span>, activation <span class="op">=</span> <span class="st">'sigmoid'</span>, input_shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># </span>
<span class="va">model_ua2</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/compile.html">compile</a></span><span class="op">(</span>                     <span class="co"># Model specification</span>
    loss <span class="op">=</span> <span class="st">'mean_squared_error'</span>,                  <span class="co"># Loss function</span>
    optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/optimizer_rmsprop.html">optimizer_rmsprop</a></span><span class="op">(</span><span class="op">)</span>,              <span class="co"># Optimisation method (weight updating)</span>
    metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mean_absolute_error'</span><span class="op">)</span>            <span class="co"># Output metric</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_ua2</span><span class="op">)</span>                                 <span class="co"># A simple model!</span></code></pre></div>
<pre><code>## Model: "sequential_8"
## __________________________________________________________________________________________
## Layer (type)                            Output Shape                        Param #       
## ==========================================================================================
## dense_24 (Dense)                        (None, 128)                         256           
## __________________________________________________________________________________________
## dense_23 (Dense)                        (None, 1)                           129           
## ==========================================================================================
## Total params: 385
## Trainable params: 385
## Non-trainable params: 0
## __________________________________________________________________________________________</code></pre>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_ua2</span> <span class="op">&lt;-</span> <span class="va">model_ua2</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/generics/man/fit.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.0002</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,            <span class="co"># Training data = x</span>
        <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.0002</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,       <span class="co"># Training label = y</span>
        epochs <span class="op">=</span> <span class="fl">60</span>, batch_size <span class="op">=</span> <span class="fl">64</span>                            <span class="co"># Training parameters</span>
<span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/tibble/man/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model_ua</span>, <span class="va">x</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Small model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model_ua2</span>, <span class="va">x</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Large model"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">sin</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"sin(x) function"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#EEAA33"</span>, <span class="st">"#3366CC"</span>, <span class="st">"#000000"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex82b"></span>
<img src="ML_factor_files/figure-html/ex82b-1.png" alt="Case with 128 units. The sine function in light blue and approximation in black." width="400px"><p class="caption">
FIGURE 19.12: Case with 128 units. The sine function in light blue and approximation in black.
</p>
</div>
<p></p>
</div>
<div id="chapter-8" class="section level2" number="19.6">
<h2>
<span class="header-section-number">19.6</span> Chapter 8<a class="anchor" aria-label="anchor" href="#chapter-8"><i class="fas fa-link"></i></a>
</h2>
<p>Since we are going to reproduce a similar analysis several times, let’s simplify the task with 2 tips. First, by using default parameter values that will be passed as common arguments to the <em>svm</em> function. Second, by creating a custom function that computes the MSE. Third, by resorting to functional calculus via the <em>map</em> function from the <em>purrr</em> package. Below, we recycle datasets created in Chapter <a href="trees.html#trees">6</a>. </p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span>, <span class="va">features</span>, <span class="va">label</span><span class="op">)</span><span class="op">{</span>             <span class="co"># MSE function</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">features</span><span class="op">)</span><span class="op">-</span><span class="va">label</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">par_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">train_label_xgb</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">]</span>,     <span class="co"># From Tree chapter</span>
                 x <span class="op">=</span> <span class="va">train_features_xgb</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>,<span class="op">]</span>,
                 type <span class="op">=</span> <span class="st">"eps-regression"</span>,
                 epsilon <span class="op">=</span> <span class="fl">0.1</span>,                    <span class="co"># Width of strip for errors</span>
                 gamma <span class="op">=</span> <span class="fl">0.5</span>,                      <span class="co"># Constant in the radial kernel </span>
                 cost <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">svm_par</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kernel</span>, <span class="va">par_list</span><span class="op">)</span><span class="op">{</span>             <span class="co"># Function for SVM fit automation</span>
    <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">svm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>kernel <span class="op">=</span> <span class="va">kernel</span>, <span class="va">par_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span>
<span class="va">kernels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"radial"</span>, <span class="st">"polynomial"</span>, <span class="st">"sigmoid"</span><span class="op">)</span> <span class="co"># Kernels</span>
<span class="va">fit_svm_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map</a></span><span class="op">(</span><span class="va">kernels</span>, <span class="va">svm_par</span>, par_list <span class="op">=</span> <span class="va">par_list</span><span class="op">)</span> <span class="co"># SVM models</span>
<span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map</a></span><span class="op">(</span><span class="va">fit_svm_par</span>, <span class="va">mse</span>,                                     <span class="co"># MSEs</span>
    features <span class="op">=</span> <span class="va">test_feat_short</span>,                           <span class="co"># From SVM chapter </span>
    label <span class="op">=</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span><span class="op">)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.03849786
## 
## [[2]]
## [1] 0.03924576
## 
## [[3]]
## [1] 0.03951328
## 
## [[4]]
## [1] 334.8173</code></pre>
<p></p>
<p>The first two kernels yield the best fit, while the last one should be avoided. Note that apart from the linear kernel, all other options require parameters. We have used the default ones, which may explain the poor performance of some nonlinear kernels.</p>
<p>Below, we train an SVM model on a training sample with all observations but that is limited to the 7 major predictors. Even with a smaller number of features, the training is time consuming.</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">svm_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">train_label_xgb</span>,      <span class="co"># Train label</span>
                x <span class="op">=</span> <span class="va">train_features_xgb</span>,   <span class="co"># Training features</span>
                type <span class="op">=</span> <span class="st">"eps-regression"</span>,  <span class="co"># SVM task type (see LIBSVM documentation)</span>
                kernel <span class="op">=</span> <span class="st">"linear"</span>,        <span class="co"># SVM kernel </span>
                epsilon <span class="op">=</span> <span class="fl">0.1</span>,            <span class="co"># Width of strip for errors</span>
                cost <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>               <span class="co"># Slack variable penalisation</span>
<span class="va">test_feat_short</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">testing_sample</span>,<span class="va">features_short</span><span class="op">)</span>       <span class="co"># Test set</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_full</span>, <span class="va">test_feat_short</span><span class="op">)</span> <span class="op">*</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># Hit ratio</span></code></pre></div>
<pre><code>## [1] 0.490343</code></pre>
<p></p>
<p>This figure is very low. Below, we test a very simple form of boosted trees, for comparison purposes.</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xgb_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_matrix_xgb</span>,    <span class="co"># Data source </span>
                      eta <span class="op">=</span> <span class="fl">0.3</span>,                          <span class="co"># Learning rate</span>
                      objective <span class="op">=</span> <span class="st">"reg:linear"</span>,           <span class="co"># Objective function</span>
                      max_depth <span class="op">=</span> <span class="fl">4</span>,                      <span class="co"># Maximum depth of trees</span>
                      nrounds <span class="op">=</span> <span class="fl">60</span>                        <span class="co"># Number of trees used (bit low here)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## [14:44:45] WARNING: amalgamation/../src/objective/regression_obj.cu:188: reg:linear is now deprecated in favor of reg:squarederror.</code></pre>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">xgb_full</span>, <span class="va">xgb_test</span><span class="op">)</span> <span class="op">*</span> <span class="va">testing_sample</span><span class="op">$</span><span class="va">R1M_Usd</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># Hit ratio</span></code></pre></div>
<pre><code>## [1] 0.5017377</code></pre>
<p></p>
<p>The forecasts are slightly better, but the computation time is lower. Two reasons why the models perform poorly:</p>
<ol style="list-style-type: decimal">
<li>there are not enough predictors;<br>
</li>
<li>the models are static: they do not adjust dynamically to macro-conditions.</li>
</ol>
</div>
<div id="chapter-11-ensemble-neural-network" class="section level2" number="19.7">
<h2>
<span class="header-section-number">19.7</span> Chapter 11: ensemble neural network<a class="anchor" aria-label="anchor" href="#chapter-11-ensemble-neural-network"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>First, we create the three feature sets. The first one gets all multiples of 3 between 3 and 93. The second one gets the same indices, minus one, and the third one, the initial indices minus two.</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">feat_train_1</span> <span class="op">&lt;-</span> <span class="va">training_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features</span><span class="op">[</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>   <span class="co"># First set of feats</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> 
<span class="va">feat_train_2</span> <span class="op">&lt;-</span> <span class="va">training_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features</span><span class="op">[</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="co"># Second set of feats</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> 
<span class="va">feat_train_3</span> <span class="op">&lt;-</span> <span class="va">training_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features</span><span class="op">[</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="co"># Third set of feats</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> 
<span class="va">feat_test_1</span> <span class="op">&lt;-</span> <span class="va">testing_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features</span><span class="op">[</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>     <span class="co"># Test features 1</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> 
<span class="va">feat_test_2</span> <span class="op">&lt;-</span> <span class="va">testing_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features</span><span class="op">[</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>   <span class="co"># Test features 2</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> 
<span class="va">feat_test_3</span> <span class="op">&lt;-</span> <span class="va">testing_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features</span><span class="op">[</span><span class="fl">3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>   <span class="co"># Test features 3</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p></p>
<p>Then, we specify the network structure. First, the 3 independent networks, then the aggregation.</p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">first_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">31</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"first_input"</span><span class="op">)</span>   <span class="co"># First input      </span>
<span class="va">first_network</span> <span class="op">&lt;-</span> <span class="va">first_input</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                  <span class="co"># Def of 1st network</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">8</span>, activation <span class="op">=</span> <span class="st">"relu"</span>, name <span class="op">=</span> <span class="st">"layer_1"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">2</span>, activation <span class="op">=</span> <span class="st">'softmax'</span><span class="op">)</span>                <span class="co"># Softmax for categ. output</span>
<span class="va">second_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">31</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"second_input"</span><span class="op">)</span> <span class="co"># Second input      </span>
<span class="va">second_network</span> <span class="op">&lt;-</span> <span class="va">second_input</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                <span class="co"># Def of 2nd network</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">8</span>, activation <span class="op">=</span> <span class="st">"relu"</span>, name <span class="op">=</span> <span class="st">"layer_2"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">2</span>, activation <span class="op">=</span> <span class="st">'softmax'</span><span class="op">)</span>                <span class="co"># Softmax for categ. output</span>
<span class="va">third_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_input.html">layer_input</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">31</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"third_input"</span><span class="op">)</span>  <span class="co"># Third input      </span>
<span class="va">third_network</span> <span class="op">&lt;-</span> <span class="va">third_input</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                  <span class="co"># Def of 3rd network</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">8</span>, activation <span class="op">=</span> <span class="st">"relu"</span>, name <span class="op">=</span> <span class="st">"layer_3"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">2</span>, activation <span class="op">=</span> <span class="st">'softmax'</span><span class="op">)</span>                <span class="co"># Softmax for categ. output</span>

<span class="va">main_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_concatenate.html">layer_concatenate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">first_network</span>, 
                                   <span class="va">second_network</span>,
                                   <span class="va">third_network</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>            <span class="co"># Combination</span>
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/layer_dense.html">layer_dense</a></span><span class="op">(</span>units <span class="op">=</span> <span class="fl">2</span>, activation <span class="op">=</span> <span class="st">'softmax'</span>, name <span class="op">=</span> <span class="st">'main_output'</span><span class="op">)</span>

<span class="va">model_ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model.html">keras_model</a></span><span class="op">(</span>                                          <span class="co"># Agg. Model specs</span>
    inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">first_input</span>, <span class="va">second_input</span>, <span class="va">third_input</span><span class="op">)</span>,
    outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">main_output</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p></p>
<p>Lastly, we can train and evaluate (see Figure <a href="solutions-to-exercises.html#fig:ex12c">19.13</a>).</p>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_ens</span><span class="op">)</span>                      <span class="co"># See model details / architecture</span></code></pre></div>
<pre><code>## Model: "model_2"
## __________________________________________________________________________________________
## Layer (type)                 Output Shape        Param #    Connected to                  
## ==========================================================================================
## first_input (InputLayer)     [(None, 31)]        0                                        
## __________________________________________________________________________________________
## second_input (InputLayer)    [(None, 31)]        0                                        
## __________________________________________________________________________________________
## third_input (InputLayer)     [(None, 31)]        0                                        
## __________________________________________________________________________________________
## layer_1 (Dense)              (None, 8)           256        first_input[0][0]             
## __________________________________________________________________________________________
## layer_2 (Dense)              (None, 8)           256        second_input[0][0]            
## __________________________________________________________________________________________
## layer_3 (Dense)              (None, 8)           256        third_input[0][0]             
## __________________________________________________________________________________________
## dense_25 (Dense)             (None, 2)           18         layer_1[0][0]                 
## __________________________________________________________________________________________
## dense_26 (Dense)             (None, 2)           18         layer_2[0][0]                 
## __________________________________________________________________________________________
## dense_27 (Dense)             (None, 2)           18         layer_3[0][0]                 
## __________________________________________________________________________________________
## concatenate (Concatenate)    (None, 6)           0          dense_25[0][0]                
##                                                             dense_26[0][0]                
##                                                             dense_27[0][0]                
## __________________________________________________________________________________________
## main_output (Dense)          (None, 2)           14         concatenate[0][0]             
## ==========================================================================================
## Total params: 836
## Trainable params: 836
## Non-trainable params: 0
## __________________________________________________________________________________________</code></pre>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_ens</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/compile.html">compile</a></span><span class="op">(</span>                  <span class="co"># Learning parameters</span>
    optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/optimizer_adam.html">optimizer_adam</a></span><span class="op">(</span><span class="op">)</span>,
    loss <span class="op">=</span> <span class="st">"binary_crossentropy"</span>,
    metrics <span class="op">=</span> <span class="st">"categorical_accuracy"</span>
<span class="op">)</span>

<span class="va">fit_NN_ens</span> <span class="op">&lt;-</span> <span class="va">model_ens</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/generics/man/fit.html">fit</a></span><span class="op">(</span>               <span class="co"># Learning function</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>first_input <span class="op">=</span> <span class="va">feat_train_1</span>, 
             second_input <span class="op">=</span> <span class="va">feat_train_2</span>,
             third_input <span class="op">=</span> <span class="va">feat_train_3</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>main_output <span class="op">=</span> <span class="va">NN_train_labels_C</span><span class="op">)</span>, <span class="co"># Recycled from NN Chapter</span>
    epochs <span class="op">=</span> <span class="fl">12</span>,                               <span class="co"># Nb rounds</span>
    batch_size <span class="op">=</span> <span class="fl">512</span>,                          <span class="co"># Nb obs. per round</span>
    validation_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">feat_test_1</span>, <span class="va">feat_test_2</span>, <span class="va">feat_test_3</span><span class="op">)</span>,
                           <span class="va">NN_test_labels_C</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mboost/man/plot.html">plot</a></span><span class="op">(</span><span class="va">fit_NN_ens</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex12c"></span>
<img src="ML_factor_files/figure-html/ex12c-1.png" alt="Learning an integrated ensemble." width="432"><p class="caption">
FIGURE 19.13: Learning an integrated ensemble.
</p>
</div>
<p></p>
</div>
<div id="chapter-12" class="section level2" number="19.8">
<h2>
<span class="header-section-number">19.8</span> Chapter 12<a class="anchor" aria-label="anchor" href="#chapter-12"><i class="fas fa-link"></i></a>
</h2>
<div id="ew-portfolios-with-the-tidyverse" class="section level3" number="19.8.1">
<h3>
<span class="header-section-number">19.8.1</span> EW portfolios with the tidyverse<a class="anchor" aria-label="anchor" href="#ew-portfolios-with-the-tidyverse"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>This one is incredibly easy; it’s simpler and more compact but close in spirit to the code that generates Figure <a href="factor.html#fig:factportsort">3.1</a>. The returns are plotted in Figure <a href="solutions-to-exercises.html#fig:ex130a">19.14</a>.
</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                     <span class="co"># Group by date</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html">summarize</a></span><span class="op">(</span>return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">R1M_Usd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>  <span class="co"># Compute return</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">return</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Plot</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex130a"></span>
<img src="ML_factor_files/figure-html/ex130a-1.png" alt="Time series of returns." width="384"><p class="caption">
FIGURE 19.14: Time series of returns.
</p>
</div>
<p></p>
</div>
<div id="advanced-weighting-function" class="section level3" number="19.8.2">
<h3>
<span class="header-section-number">19.8.2</span> Advanced weighting function<a class="anchor" aria-label="anchor" href="#advanced-weighting-function"><i class="fas fa-link"></i></a>
</h3>
<p>First, we code the function with all inputs.</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weights</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Sigma</span>, <span class="va">mu</span>, <span class="va">Lambda</span>, <span class="va">lambda</span>, <span class="va">k_D</span>, <span class="va">k_R</span>, <span class="va">w_old</span><span class="op">)</span><span class="op">{</span>
    <span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span>
    <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">*</span><span class="va">Sigma</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">k_R</span><span class="op">*</span><span class="va">Lambda</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">k_D</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="co"># Inverse matrix</span>
    <span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">M</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="op">(</span><span class="va">mu</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">k_R</span><span class="op">*</span><span class="va">Lambda</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="va">w_old</span><span class="op">)</span><span class="op">)</span>       <span class="co"># eta numerator</span>
    <span class="va">den</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">M</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N</span><span class="op">)</span><span class="op">)</span>                              <span class="co"># eta denominator</span>
    <span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">num</span> <span class="op">/</span> <span class="va">den</span>                                        <span class="co"># eta</span>
    <span class="va">vec</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">eta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">k_R</span><span class="op">*</span><span class="va">Lambda</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="va">w_old</span>     <span class="co"># Vector in weight</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">M</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="va">vec</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Second, we test it on some random dataset. We use the returns created at the end of Chapter <a href="notdata.html#notdata">1</a> and used for the Lasso allocation in Section <a href="lasso.html#sparseex">5.2.2</a>. For <span class="math inline">\(\boldsymbol{\mu}\)</span>, we use the sample average, which is rarely a good idea in practice. It serves as illustration only.</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="va">returns</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Covariance matrix</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">returns</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>             <span class="co"># Vector of exp. returns</span>
<span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span>                                          <span class="co"># Trans. Cost matrix</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1</span>                                                          <span class="co"># Risk aversion</span>
<span class="va">k_D</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">k_R</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">w_old</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span>                           <span class="co"># Prev. weights: EW</span>
<span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">Sigma</span>, <span class="va">mu</span>, <span class="va">Lambda</span>, <span class="va">lambda</span>, <span class="va">k_D</span>, <span class="va">k_R</span>, <span class="va">w_old</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/Rgraphviz/man/AgEdge-class.html">head</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># First weights</span></code></pre></div>
<pre><code>##             [,1]
## 1   0.0031339308
## 3  -0.0003243527
## 4   0.0011944677
## 7   0.0014194215
## 9   0.0015086240
## 11 -0.0005015207</code></pre>
<p></p>
<p>Some weights can of course be negative. Finally, we use the map2() function to test some sensitivity. We examine 3 key indicators:<br>
- <strong>diversification</strong>, which we measure via the inverse of the sum of squared weights (inverse Hirschman-Herfindhal index);<br>
- <strong>leverage</strong>, which we assess via the absolute sum of negative weights;<br>
- <strong>in-sample volatility</strong>, which we compute as <span class="math inline">\(\textbf{w}' \boldsymbol{\Sigma} \textbf{x}\)</span></p>
<p>To do so, we create a dedicated function below.</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sensi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lambda</span>, <span class="va">k_D</span>, <span class="va">Sigma</span>, <span class="va">mu</span>, <span class="va">Lambda</span>, <span class="va">k_R</span>, <span class="va">w_old</span><span class="op">)</span><span class="op">{</span>
    <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weights.html">weights</a></span><span class="op">(</span><span class="va">Sigma</span>, <span class="va">mu</span>, <span class="va">Lambda</span>, <span class="va">lambda</span>, <span class="va">k_D</span>, <span class="va">k_R</span>, <span class="va">w_old</span><span class="op">)</span>
    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
    <span class="va">out</span><span class="op">$</span><span class="va">div</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>             <span class="co"># Diversification</span>
    <span class="va">out</span><span class="op">$</span><span class="va">lev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="va">w</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Leverage</span>
    <span class="va">out</span><span class="op">$</span><span class="va">vol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="va">Sigma</span> <span class="op"><a href="https://rdrr.io/pkg/Matrix/man/matrix-products.html">%*%</a></span> <span class="va">w</span>   <span class="co"># In-sample vol</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Instead of using the baseline <em>map2</em> function, we rely on a version thereof that concatenates results into a dataframe directly.</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>              <span class="co"># parameter values</span>
<span class="va">k_D</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>               <span class="co"># parameter values</span>
<span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/expand_grid.html">expand_grid</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">k_D</span><span class="op">)</span> <span class="co"># parameter grid</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">lambda</span>
<span class="va">k_D</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">k_D</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map2.html">map2_dfr</a></span><span class="op">(</span><span class="va">lambda</span>, <span class="va">k_D</span>, <span class="va">sensi</span>, 
                Sigma <span class="op">=</span> <span class="va">Sigma</span>, mu <span class="op">=</span> <span class="va">mu</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>, k_R <span class="op">=</span> <span class="va">k_R</span>, w_old <span class="op">=</span> <span class="va">w_old</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>, k_D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">k_D</span><span class="op">)</span>, <span class="va">res</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">indicator</span>, value <span class="op">=</span> <span class="va">value</span>, <span class="op">-</span><span class="va">lambda</span>, <span class="op">-</span><span class="va">k_D</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lambda</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">k_D</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">indicator</span> <span class="op">~</span><span class="va">.</span> , scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ex131d"></span>
<img src="ML_factor_files/figure-html/ex131d-1.png" alt="Indicators related to portfolio weights." width="432"><p class="caption">
FIGURE 19.15: Indicators related to portfolio weights.
</p>
</div>
<p></p>
<p>In Figure <a href="solutions-to-exercises.html#fig:ex131d">19.15</a>, each panel displays an indicator. In the first panel, we see that diversification increases with <span class="math inline">\(k_D\)</span>: indeed, as this number increases, the portfolio converges to uniform (EW) values. The parameter <span class="math inline">\(\lambda\)</span> has a minor impact. The second panel naturally shows the inverse effect for leverage: as diversification increases with <span class="math inline">\(k_D\)</span>, leverage (i.e., total negative positions - shortsales) decreases. Finally, the last panel shows that in-sample volatility is however largely driven by the risk aversion parameter. As <span class="math inline">\(\lambda\)</span> increases, volatility logically decreases. For small values of <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(k_D\)</span> is negatively related to volatility but the pattern reverses for large values of <span class="math inline">\(\lambda\)</span>. This is because the equally weighted portfolio is less risky than very leveraged mean-variance policies, but more risky than the minimum-variance portfolio.</p>
</div>
<div id="functional-programming-in-the-backtest" class="section level3" number="19.8.3">
<h3>
<span class="header-section-number">19.8.3</span> Functional programming in the backtest<a class="anchor" aria-label="anchor" href="#functional-programming-in-the-backtest"><i class="fas fa-link"></i></a>
</h3>
<p>
Often, programmers prefer to avoid loops. In order to avoid a loop in the backtest, we need to code what happens for one given date. This is encapsulated in the following function. For simplicity, we code it for only one strategy. Also, the function will assume the structure of the data is known, but the columns (features &amp; labels) could also be passed as arguments. We recycle the function <strong>weights_xgb</strong> from Chapter <a href="backtest.html#backtest">12</a>.</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">portf_map</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">data_ml</span>, <span class="va">ticks</span>, <span class="va">t_oos</span>, <span class="va">m_offset</span>, <span class="va">train_size</span>, <span class="va">weight_func</span><span class="op">)</span><span class="op">{</span>
    <span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&lt;</span> <span class="va">t_oos</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">m_offset</span> <span class="op">*</span> <span class="fl">30</span>,   <span class="co"># Roll. window w. buffer</span>
                                     <span class="va">date</span> <span class="op">&gt;</span> <span class="va">t_oos</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">m_offset</span> <span class="op">*</span> <span class="fl">30</span> <span class="op">-</span> <span class="fl">365</span> <span class="op">*</span> <span class="va">train_size</span><span class="op">)</span>
    <span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">data_ml</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">t_oos</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span>                   <span class="co"># Test set  </span>
    <span class="va">realized_returns</span> <span class="op">&lt;-</span> <span class="va">test_data</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>                                   <span class="co"># Computing returns via:</span>
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">R1M_Usd</span><span class="op">)</span>                                          <span class="co"># 1M holding period!</span>
    <span class="va">temp_weights</span> <span class="op">&lt;-</span> <span class="fu">weight_func</span><span class="op">(</span><span class="va">train_data</span>, <span class="va">test_data</span>, <span class="va">features</span><span class="op">)</span>        <span class="co"># Weights = &gt; recycled!</span>
    <span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">temp_weights</span><span class="op">$</span><span class="va">names</span>, <span class="va">ticks</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span>               <span class="co"># Index of test assets</span>
    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span> 
    <span class="va">x</span><span class="op">$</span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ticks</span><span class="op">)</span><span class="op">)</span>                           <span class="co"># Empty weights</span>
    <span class="va">x</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">temp_weights</span><span class="op">$</span><span class="va">weights</span>                       <span class="co"># Locate weights correctly</span>
    <span class="va">x</span><span class="op">$</span><span class="va">returns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">temp_weights</span><span class="op">$</span><span class="va">weights</span> <span class="op">*</span> <span class="va">realized_returns</span><span class="op">)</span>    <span class="co"># Compute returns</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Next, we combine this function to <strong>map</strong>(). We only test the first 6 dates: this reduces the computation times.</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">back_test</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>             <span class="co"># Test on the first 100 out-of-sample dates</span>
    <span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map</a></span><span class="op">(</span><span class="va">portf_map</span>, data_ml <span class="op">=</span> <span class="va">data_ml</span>, ticks <span class="op">=</span> <span class="va">ticks</span>, t_oos <span class="op">=</span> <span class="va">t_oos</span>,
        m_offset <span class="op">=</span> <span class="fl">1</span>, train_size <span class="op">=</span> <span class="fl">5</span>, weight_func <span class="op">=</span> <span class="va">weights_xgb</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Rgraphviz/man/AgEdge-class.html">head</a></span><span class="op">(</span><span class="va">back_test</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span>     <span class="co"># Sample weights</span></code></pre></div>
<pre><code>## [1] 0.001675042 0.000000000 0.000000000 0.001675042 0.000000000 0.001675042</code></pre>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">back_test</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">returns</span>           <span class="co"># Return of first period</span></code></pre></div>
<pre><code>## [1] 0.0189129</code></pre>
<p></p>
<p>Each element of backtest is a list with two components: the portfolio weights and the returns. To access the data easily, functions like <em>melt</em> from the package <em>reshape2</em> are useful.</p>
</div>
</div>
<div id="chapter-15" class="section level2" number="19.9">
<h2>
<span class="header-section-number">19.9</span> Chapter 15<a class="anchor" aria-label="anchor" href="#chapter-15"><i class="fas fa-link"></i></a>
</h2>
<p>We recycle the AE model trained in Chapter <a href="unsup.html#unsup">15</a>. Strangely, building smaller models (encoder) from larger ones (AE) requires to save and then reload the weights. This creates an external file, which we call “ae_weights.” We can check that the output does have 4 columns (compressed) instead of 7 (original data).
</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/keras/man/save_model_weights_hdf5.html">save_model_weights_hdf5</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ae_model</span>,filepath <span class="op">=</span><span class="st">"ae_weights.hdf5"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">encoder_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/keras/man/keras_model.html">keras_model</a></span><span class="op">(</span>inputs <span class="op">=</span> <span class="va">input_layer</span>, outputs <span class="op">=</span> <span class="va">encoder</span><span class="op">)</span>
<span class="va">encoder_model</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/pkg/keras/man/save_model_weights_hdf5.html">load_model_weights_hdf5</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="st">"ae_weights.hdf5"</span>,skip_mismatch <span class="op">=</span> <span class="cn">TRUE</span>,by_name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">encoder_model</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/generics/man/compile.html">compile</a></span><span class="op">(</span>
    loss <span class="op">=</span> <span class="st">'mean_squared_error'</span>,
    optimizer <span class="op">=</span> <span class="st">'adam'</span>,
    metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mean_absolute_error'</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">encoder_model</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/keras/man/predict_on_batch.html">predict_on_batch</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">training_sample</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
                              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">features_short</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
                              <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/Rgraphviz/man/AgEdge-class.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>##           [,1]      [,2]       [,3]      [,4]
## [1,] 0.6790795 0.2659355 -0.1122203 -1.217317
## [2,] 0.7173761 0.2665033 -0.1226677 -1.198467
## [3,] 0.6761458 0.2580954 -0.1292358 -1.228019
## [4,] 0.6663372 0.2561628 -0.1343219 -1.233885
## [5,] 0.6427090 0.2598515 -0.1446657 -1.240109</code></pre>
<p></p>
<p></p>
</div>
<div id="chapter-16" class="section level2" number="19.10">
<h2>
<span class="header-section-number">19.10</span> Chapter 16<a class="anchor" aria-label="anchor" href="#chapter-16"><i class="fas fa-link"></i></a>
</h2>
<p>All we need to do is change the rho coefficient in the code of Chapter <a href="RL.html#RL">16</a>. </p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>                                                 <span class="co"># Fixing the random seed</span>
<span class="va">n_sample</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">5</span>                                             <span class="co"># Number of samples generated</span>
<span class="va">rho</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">0.8</span><span class="op">)</span>                                                <span class="co"># Autoregressive parameter</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">0.4</span>                                                    <span class="co"># Std. dev. of noise</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">0.06</span> <span class="op">*</span> <span class="va">rho</span>                                              <span class="co"># Scaled mean of returns</span>
<span class="va">data_RL3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tibble/man/tibble.html">tibble</a></span><span class="op">(</span>returns <span class="op">=</span> <span class="va">a</span><span class="op">/</span><span class="va">rho</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_sample</span>, <span class="co"># Returns via AR(1) simulation</span>
                                               <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="va">rho</span><span class="op">)</span>,       
                                               sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>,
                   action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_sample</span><span class="op">)</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>   <span class="co"># Random action (portfolio)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>new_state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/if_else.html">if_else</a></span><span class="op">(</span><span class="va">returns</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="st">"neg"</span>, <span class="st">"pos"</span><span class="op">)</span>,   <span class="co"># Coding of state</span>
           reward <span class="op">=</span> <span class="va">returns</span> <span class="op">*</span> <span class="va">action</span>,                        <span class="co"># Reward = portfolio return</span>
           state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">new_state</span><span class="op">)</span>,                           <span class="co"># Next state</span>
           action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">action</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span>                                                <span class="co"># Remove one missing state</span></code></pre></div>
<p></p>
<p>The learning can then proceed.</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span>,                        <span class="co"># Learning rate</span>
                gamma <span class="op">=</span> <span class="fl">0.7</span>,                        <span class="co"># Discount factor for rewards</span>
                epsilon <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>                      <span class="co"># Exploration rate</span>
<span class="va">fit_RL3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ReinforcementLearning/man/ReinforcementLearning.html">ReinforcementLearning</a></span><span class="op">(</span><span class="va">data_RL3</span>,          <span class="co"># Main RL function</span>
                                 s <span class="op">=</span> <span class="st">"state"</span>, 
                                 a <span class="op">=</span> <span class="st">"action"</span>, 
                                 r <span class="op">=</span> <span class="st">"reward"</span>, 
                                 s_new <span class="op">=</span> <span class="st">"new_state"</span>, 
                                 control <span class="op">=</span> <span class="va">control</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fit_RL3</span><span class="op">)</span>   <span class="co"># Show the output</span></code></pre></div>
<pre><code>## State-Action function Q
##          0.25         0         1      0.75       0.5
## neg 0.7107268 0.5971710 1.4662416 0.9535698 0.8069591
## pos 0.7730842 0.7869229 0.4734467 0.4258593 0.6257039
## 
## Policy
## neg pos 
## "1" "0" 
## 
## Reward (last iteration)
## [1] 3013.162</code></pre>
<p></p>
<p>In this case, the constantly switching feature of the return process changes the outcome. The negative state is associated with large profits when the portfolio is fully invested, while the positive state has the best average reward when the agent refrains from investing.</p>
<p>For the second exercise, the trick is to define all possible actions, that is all combinations (+1,0-1) for the two assets on all dates. We recycle the data from Chapter <a href="RL.html#RL">16</a>.</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pos_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>                              <span class="co"># Possible alloc. to asset 1</span>
<span class="va">pos_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>                              <span class="co"># Possible alloc. to asset 3</span>
<span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/expand_grid.html">expand_grid</a></span><span class="op">(</span><span class="va">pos_3</span>, <span class="va">pos_4</span><span class="op">)</span>                <span class="co"># All combinations</span>
<span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">pos</span>, id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span><span class="op">)</span>         <span class="co"># Adding combination id</span>

<span class="va">ret_pb_RL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span>r3 <span class="op">=</span> <span class="va">return_3</span>, r4 <span class="op">=</span> <span class="va">return_4</span>, <span class="co"># Returns &amp; P/B dataframe</span>
                       pb3 <span class="op">=</span> <span class="va">pb_3</span>, pb4 <span class="op">=</span> <span class="va">pb_4</span><span class="op">)</span> 
<span class="va">data_RL4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">ret_pb_RL</span>,                        <span class="co"># Combining return &amp; positions</span>
                   <span class="va">rep.int</span>, 
                   times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span>, <span class="fl">1</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">return_3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">pos_3</span>, <span class="va">pos_4</span><span class="op">)</span>,            <span class="co"># Uniting actions</span>
           pb3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="va">pb3</span><span class="op">)</span>,                    <span class="co"># Simplifying states</span>
           pb4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="va">pb4</span><span class="op">)</span>,                    <span class="co"># Simplifying states</span>
           state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">pb3</span>, <span class="va">pb4</span><span class="op">)</span>,                 <span class="co"># Uniting states</span>
           reward <span class="op">=</span> <span class="va">pos_3</span><span class="op">*</span><span class="va">r3</span> <span class="op">+</span> <span class="va">pos_4</span><span class="op">*</span><span class="va">r4</span>,            <span class="co"># Computing rewards</span>
           new_state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lead</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>             <span class="co"># Infer new state</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">pb3</span>, <span class="op">-</span><span class="va">pb4</span>, <span class="op">-</span><span class="va">pos_3</span>,          <span class="co"># Remove superfluous vars.</span>
                  <span class="op">-</span><span class="va">pos_4</span>, <span class="op">-</span><span class="va">r3</span>, <span class="op">-</span><span class="va">r4</span><span class="op">)</span> </code></pre></div>
<p></p>
<p>We can the plug this data into the RL function.</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_RL4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ReinforcementLearning/man/ReinforcementLearning.html">ReinforcementLearning</a></span><span class="op">(</span><span class="va">data_RL4</span>,           <span class="co"># Main RL function</span>
                                 s <span class="op">=</span> <span class="st">"state"</span>, 
                                 a <span class="op">=</span> <span class="st">"action"</span>, 
                                 r <span class="op">=</span> <span class="st">"reward"</span>, 
                                 s_new <span class="op">=</span> <span class="st">"new_state"</span>, 
                                 control <span class="op">=</span> <span class="va">control</span><span class="op">)</span>
<span class="va">fit_RL4</span><span class="op">$</span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">fit_RL4</span><span class="op">$</span><span class="va">Q</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># Round the Q-matrix</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fit_RL4</span><span class="op">)</span>                   <span class="co"># Show the output </span></code></pre></div>
<pre><code>## State-Action function Q
##       0 0    0 1  0 -1  -1 -1   -1 0   -1 1   1 -1    1 0    1 1
## 0 2 0.000  0.000 0.002 -0.017 -0.018 -0.020  0.023  0.025  0.024
## 0 3 0.001 -0.005 0.007 -0.013 -0.019 -0.026  0.031  0.027  0.021
## 3 1 0.003  0.003 0.003  0.002  0.002  0.003  0.002  0.002  0.003
## 2 1 0.027  0.038 0.020  0.004  0.015  0.039  0.013  0.021  0.041
## 2 2 0.021  0.014 0.027  0.038  0.047  0.045 -0.004 -0.011 -0.016
## 2 3 0.007  0.006 0.008  0.054  0.057  0.056 -0.041 -0.041 -0.041
## 1 1 0.027  0.054 0.005 -0.031 -0.005  0.041  0.025  0.046  0.072
## 1 2 0.019  0.020 0.020  0.015  0.023  0.029  0.012  0.014  0.023
## 1 3 0.008  0.019 0.000 -0.036 -0.027 -0.016  0.042  0.053  0.060
## 
## Policy
##    0 2    0 3    3 1    2 1    2 2    2 3    1 1    1 2    1 3 
##  "1 0" "1 -1" "0 -1"  "1 1" "-1 0" "-1 0"  "1 1" "-1 1"  "1 1" 
## 
## Reward (last iteration)
## [1] 0</code></pre>
<p></p>
<p>The matrix is less sparse compared to the one of Chapter <a href="RL.html#RL">16</a>; we have covered much more ground! Some policy recommendations have not changed compared to the smaller sample, but some have! The change occurs for the states for which only a few points were available in the first trial. With more data, the decision is altered.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-abbasi2012metafraud" class="csl-entry">
Abbasi, Ahmed, Conan Albrecht, Anthony Vance, and James Hansen. 2012. <span>“Metafraud: A Meta-Learning Framework for Detecting Financial Fraud.”</span> <em><span>MIS</span> Quarterly</em>, 1293–1327.
</div>
<div id="ref-aboussalah2020continuous" class="csl-entry">
Aboussalah, Amine Mohamed, and Chi-Guhn Lee. 2020. <span>“Continuous Control with Stacked Deep Dynamic Recurrent Reinforcement Learning for Portfolio Optimization.”</span> <em>Expert Systems with Applications</em> 140: 112891.
</div>
<div id="ref-adler2008cost" class="csl-entry">
Adler, Timothy, and Mark Kritzman. 2008. <span>“The Cost of Socially Responsible Investing.”</span> <em>Journal of Portfolio Management</em> 35 (1): 52–56.
</div>
<div id="ref-agarwal2006algorithms" class="csl-entry">
Agarwal, Amit, Elad Hazan, Satyen Kale, and Robert E Schapire. 2006. <span>“Algorithms for Portfolio Management Based on the Newton Method.”</span> In <em>Proceedings of the 23rd International Conference on Machine Learning</em>, 9–16. ACM.
</div>
<div id="ref-aggarwal2013outlier" class="csl-entry">
Aggarwal, Charu C. 2013. <em>Outlier Analysis</em>. Springer.
</div>
<div id="ref-akey2021noisy" class="csl-entry">
Akey, Pat, Adriana Robertson, and Mikhail Simutin. 2021. <span>“Noisy Factors.”</span> <em>SSRN Working Paper</em> 3930228.
</div>
<div id="ref-aldridge2019neural" class="csl-entry">
Aldridge, Irene, and Marco Avellaneda. 2019. <span>“Neural Networks in Finance: Design and Performance.”</span> <em>Journal of Financial Data Science</em> 1 (4): 39–62.
</div>
<div id="ref-alessandrini2020optimal" class="csl-entry">
Alessandrini, Fabio, and Eric Jondeau. 2020. <span>“Optimal Strategies for <span>ESG</span> Portfolios.”</span> <em>SSRN Working Paper</em> 3578830.
</div>
<div id="ref-allison2001missing" class="csl-entry">
Allison, Paul D. 2001. <em>Missing Data</em>. Vol. 136. Sage publications.
</div>
<div id="ref-almahdi2017adaptive" class="csl-entry">
Almahdi, Saud, and Steve Y Yang. 2017. <span>“An Adaptive Portfolio Trading System: A Risk-Return Portfolio Optimization Using Recurrent Reinforcement Learning with Expected Maximum Drawdown.”</span> <em>Expert Systems with Applications</em> 87: 267–79.
</div>
<div id="ref-almahdi2019constrained" class="csl-entry">
———. 2019. <span>“A Constrained Portfolio Trading System Using Particle Swarm Algorithm and Recurrent Reinforcement Learning.”</span> <em>Expert Systems with Applications</em> 130: 145–56.
</div>
<div id="ref-alti2019dynamic" class="csl-entry">
Alti, Aydoğan, and Sheridan Titman. 2019. <span>“A Dynamic Model of Characteristic-Based Return Predictability.”</span> <em>Journal of Finance</em> 74 (6): 3187–3216.
</div>
<div id="ref-ammann2016characteristics" class="csl-entry">
Ammann, Manuel, Guillaume Coqueret, and Jan-Philip Schade. 2016. <span>“Characteristics-Based Portfolio Choice with Leverage Constraints.”</span> <em>Journal of Banking &amp; Finance</em> 70: 23–37.
</div>
<div id="ref-amrhein2019scientists" class="csl-entry">
Amrhein, Valentin, Sander Greenland, and Blake McShane. 2019. <span>“Scientists Rise up Against Statistical Significance.”</span> <em>Nature</em> 567: 305–7.
</div>
<div id="ref-anderson2000talking" class="csl-entry">
Anderson, James A, and Edward Rosenfeld. 2000. <em>Talking Nets: An Oral History of Neural Networks</em>. MIT Press.
</div>
<div id="ref-andersson2020deep" class="csl-entry">
Andersson, Kristoffer, and Cornelis Oosterlee. 2020. <span>“A Deep Learning Approach for Computations of Exposure Profiles for High-Dimensional Bermudan Options.”</span> <em>arXiv Preprint</em>, no. 2003.01977.
</div>
<div id="ref-andre2020dirichlet" class="csl-entry">
André, Eric, and Guillaume Coqueret. 2020. <span>“Dirichlet Policies for Reinforced Factor Portfolios.”</span> <em>SSRN Working Paper</em> 3726714.
</div>
<div id="ref-ang2014asset" class="csl-entry">
Ang, Andrew. 2014. <em>Asset Management: A Systematic Approach to Factor Investing</em>. Oxford University Press.
</div>
<div id="ref-ang2006cross" class="csl-entry">
Ang, Andrew, Robert J Hodrick, Yuhang Xing, and Xiaoyan Zhang. 2006. <span>“The Cross-Section of Volatility and Expected Returns.”</span> <em>Journal of Finance</em> 61 (1): 259–99.
</div>
<div id="ref-ang2012testing" class="csl-entry">
Ang, Andrew, and Dennis Kristensen. 2012. <span>“Testing Conditional Factor Models.”</span> <em>Journal of Financial Economics</em> 106 (1): 132–56.
</div>
<div id="ref-ang2018using" class="csl-entry">
Ang, Andrew, Jun Liu, and Krista Schwarz. 2018. <span>“Using Individual Stocks or Portfolios in Tests of Factor Models.”</span> <em>SSRN Working Paper</em> 1106463.
</div>
<div id="ref-arik2019tabnet" class="csl-entry">
Arik, Sercan O, and Tomas Pfister. 2020. <span>“TabNet: Attentive Interpretable Tabular Learning.”</span> <em>arXiv Preprint</em>, no. 1908.07442.
</div>
<div id="ref-arjovsky2019invariant" class="csl-entry">
Arjovsky, Martin, Léon Bottou, Ishaan Gulrajani, and David Lopez-Paz. 2019. <span>“Invariant Risk Minimization.”</span> <em>arXiv Preprint</em>, no. 1907.02893.
</div>
<div id="ref-arnott2019factor" class="csl-entry">
Arnott, Robert D, Mark Clements, Vitali Kalesnik, and Juhani T Linnainmaa. 2021. <span>“Factor Momentum.”</span> <em>SSRN Working Paper</em> 3116974.
</div>
<div id="ref-arnott2014can" class="csl-entry">
Arnott, Robert D, Jason C Hsu, Jun Liu, and Harry Markowitz. 2014. <span>“Can Noise Create the Size and Value Effects?”</span> <em>Management Science</em> 61 (11): 2569–79.
</div>
<div id="ref-arnott2019alice" class="csl-entry">
Arnott, Rob, Campbell R Harvey, Vitali Kalesnik, and Juhani Linnainmaa. 2019. <span>“Alice’s Adventures in Factorland: Three Blunders That Plague Factor Investing.”</span> <em>Journal of Portfolio Management</em> 45 (4): 18–36.
</div>
<div id="ref-arnott2019backtesting" class="csl-entry">
Arnott, Rob, Campbell R Harvey, and Harry Markowitz. 2019. <span>“A Backtesting Protocol in the Era of Machine Learning.”</span> <em>Journal of Financial Data Science</em> 1 (1): 64–74.
</div>
<div id="ref-aronow2020book" class="csl-entry">
Aronow, Peter M., and Fredrik Sävje. 2019. <span>“Book Review. <span>T</span>he Book of <span>W</span>hy: The New Science of Cause and Effect.”</span> <em>Journal of the American Statistical Association</em> 115 (529): 482–85.
</div>
<div id="ref-asness2020betting" class="csl-entry">
Asness, Cliff, Andrea Frazzini, Niels Joachim Gormsen, and Lasse Heje Pedersen. 2020. <span>“Betting Against Correlation: Testing Theories of the Low-Risk Effect.”</span> <em>Journal of Financial Economics</em> 135 (3): 629–52.
</div>
<div id="ref-asness2013value" class="csl-entry">
Asness, Clifford S, Tobias J Moskowitz, and Lasse Heje Pedersen. 2013. <span>“Value and Momentum Everywhere.”</span> <em>Journal of Finance</em> 68 (3): 929–85.
</div>
<div id="ref-asness2017contrarian" class="csl-entry">
Asness, Clifford, Swati Chandra, Antti Ilmanen, and Ronen Israel. 2017. <span>“Contrarian Factor Timing Is Deceptively Difficult.”</span> <em>Journal of Portfolio Management</em> 43 (5): 72–87.
</div>
<div id="ref-asness2013devil" class="csl-entry">
Asness, Clifford, and Andrea Frazzini. 2013. <span>“The Devil in HML’s Details.”</span> <em>Journal of Portfolio Management</em> 39 (4): 49–68.
</div>
<div id="ref-asness2018size" class="csl-entry">
Asness, Clifford, Andrea Frazzini, Ronen Israel, Tobias J Moskowitz, and Lasse H Pedersen. 2018. <span>“Size Matters, If You Control Your Junk.”</span> <em>Journal of Financial Economics</em> 129 (3): 479–509.
</div>
<div id="ref-asness2015investing" class="csl-entry">
Asness, Clifford, Antti Ilmanen, Ronen Israel, and Tobias Moskowitz. 2015. <span>“Investing with Style.”</span> <em>Journal of Investment Management</em> 13 (1): 27–63.
</div>
<div id="ref-astakhov2019firm" class="csl-entry">
Astakhov, Anton, Tomas Havranek, and Jiri Novak. 2019. <span>“Firm Size and Stock Returns: A Quantitative Survey.”</span> <em>Journal of Economic Surveys</em> 33 (5): 1463–92.
</div>
<div id="ref-atta2020strategies" class="csl-entry">
Atta-Darkua, Vaska, David Chambers, Elroy Dimson, Zhenkai Ran, and Ting Yu. 2020. <span>“Strategies for Responsible Investing: Emerging Academic Evidence.”</span> <em>Journal of Portfolio Management</em> 46 (3): 26–35.
</div>
<div id="ref-babiak2020deep" class="csl-entry">
Babiak, Mykola, and Jozef Barunik. 2020. <span>“Deep Learning, Predictability, and Optimal Portfolio Returns.”</span> <em>arXiv Preprint</em>, no. 2009.03394.
</div>
<div id="ref-bache2014magrittr" class="csl-entry">
Bache, Stefan Milton, and Hadley Wickham. 2014. <span>“Magrittr: A Forward-Pipe Operator for r.”</span> <em>R Package Version</em> 1 (1).
</div>
<div id="ref-back2010asset" class="csl-entry">
Back, Kerry. 2010. <em>Asset Pricing and Portfolio Choice Theory</em>. Oxford University Press.
</div>
<div id="ref-baesens2015fraud" class="csl-entry">
Baesens, Bart, Veronique Van Vlasselaer, and Wouter Verbeke. 2015. <em>Fraud Analytics Using Descriptive, Predictive, and Social Network Techniques: A Guide to Data Science for Fraud Detection</em>. John Wiley &amp; Sons.
</div>
<div id="ref-bai2002determining" class="csl-entry">
Bai, Jushan, and Serena Ng. 2002. <span>“Determining the Number of Factors in Approximate Factor Models.”</span> <em>Econometrica</em> 70 (1): 191–221.
</div>
<div id="ref-bailey2021finance" class="csl-entry">
Bailey, David H, and Marcos Lopez de Prado. 2021. <span>“Finance Is Not Excused: <span>W</span>hy Finance Should Not Flout Basic Principles of Statistics.”</span> <em>Significance (Royal Statistical Society)</em> Forthcoming.
</div>
<div id="ref-bailey2014deflated" class="csl-entry">
Bailey, David H, and Marcos López de Prado. 2014. <span>“The Deflated Sharpe Ratio: Correcting for Selection Bias, Backtest Overfitting, and Non-Normality.”</span> <em>Journal of Portfolio Management</em> 40 (5): 39–59.
</div>
<div id="ref-bailey1978note" class="csl-entry">
Bailey, T, and A. K. Jain. 1978. <span>“A Note on Distance-Weighted k-Nearest Neighbor Rules.”</span> <em>IEEE Trans. On Systems, Man, Cybernetics</em> 8 (4): 311–13.
</div>
<div id="ref-bajgrowicz2012technical" class="csl-entry">
Bajgrowicz, Pierre, and Olivier Scaillet. 2012. <span>“Technical Trading Revisited: <span>F</span>alse Discoveries, Persistence Tests, and Transaction Costs.”</span> <em>Journal of Financial Economics</em> 106 (3): 473–91.
</div>
<div id="ref-baker2011benchmarks" class="csl-entry">
Baker, Malcolm, Brendan Bradley, and Jeffrey Wurgler. 2011. <span>“Benchmarks as Limits to Arbitrage: Understanding the Low-Volatility Anomaly.”</span> <em>Financial Analysts Journal</em> 67 (1): 40–54.
</div>
<div id="ref-baker2019leverage" class="csl-entry">
Baker, Malcolm, Mathias F Hoeyer, and Jeffrey Wurgler. 2020. <span>“Leverage and the Beta Anomaly.”</span> <em>Journal of Financial and Quantitative Analysis</em> Forthcoming: 1–24.
</div>
<div id="ref-baker2017detecting" class="csl-entry">
Baker, Malcolm, Patrick Luo, and Ryan Taliaferro. 2017. <span>“Detecting Anomalies: The Relevance and Power of Standard Asset Pricing Tests.”</span>
</div>
<div id="ref-bali2016empirical" class="csl-entry">
Bali, Turan G, Robert F Engle, and Scott Murray. 2016. <em>Empirical Asset Pricing: The Cross Section of Stock Returns</em>. John Wiley &amp; Sons.
</div>
<div id="ref-bali2020cross" class="csl-entry">
Bali, Turan G, Amit Goyal, Dashan Huang, Fuwei Jiang, and Quan Wen. 2020. <span>“Different Strokes: <span>R</span>eturn Predictability Across Stocks and Bonds with Machine Learning and Big Data.”</span> <em>SSRN Working Paper</em> 3686164.
</div>
<div id="ref-ballings2015evaluating" class="csl-entry">
Ballings, Michel, Dirk Van den Poel, Nathalie Hespeels, and Ruben Gryp. 2015. <span>“Evaluating Multiple Classifiers for Stock Price Direction Prediction.”</span> <em>Expert Systems with Applications</em> 42 (20): 7046–56.
</div>
<div id="ref-ban2016machine" class="csl-entry">
Ban, Gah-Yi, Noureddine El Karoui, and Andrew EB Lim. 2016. <span>“Machine Learning and Portfolio Optimization.”</span> <em>Management Science</em> 64 (3): 1136–54.
</div>
<div id="ref-bansal1993new" class="csl-entry">
Bansal, Ravi, David A Hsieh, and S Viswanathan. 1993. <span>“A New Approach to International Arbitrage Pricing.”</span> <em>Journal of Finance</em> 48 (5): 1719–47.
</div>
<div id="ref-bansal1993no" class="csl-entry">
Bansal, Ravi, and Salim Viswanathan. 1993. <span>“No Arbitrage and Arbitrage Pricing: A New Approach.”</span> <em>Journal of Finance</em> 48 (4): 1231–62.
</div>
<div id="ref-banz1981relationship" class="csl-entry">
Banz, Rolf W. 1981. <span>“The Relationship Between Return and Market Value of Common Stocks.”</span> <em>Journal of Financial Economics</em> 9 (1): 3–18.
</div>
<div id="ref-barberis2018psychology" class="csl-entry">
Barberis, Nicholas. 2018. <span>“Psychology-Based Models of Asset Prices and Trading Volume.”</span> In <em>Handbook of Behavioral Economics-Foundations and Applications</em>.
</div>
<div id="ref-barberis2015x" class="csl-entry">
Barberis, Nicholas, Robin Greenwood, Lawrence Jin, and Andrei Shleifer. 2015. <span>“<span>X</span>-<span>CAPM</span>: An Extrapolative Capital Asset Pricing Model.”</span> <em>Journal of Financial Economics</em> 115 (1): 1–24.
</div>
<div id="ref-barberis2019prospect" class="csl-entry">
Barberis, Nicholas, Lawrence J Jin, and Baolian Wang. 2020. <span>“Prospect Theory and Stock Market Anomalies.”</span> <em>SSRN Working Paper</em> 3477463.
</div>
<div id="ref-barberis2016prospect" class="csl-entry">
Barberis, Nicholas, Abhiroop Mukherjee, and Baolian Wang. 2016. <span>“Prospect Theory and Stock Returns: An Empirical Test.”</span> <em>Review of Financial Studies</em> 29 (11): 3068–3107.
</div>
<div id="ref-barberis2003style" class="csl-entry">
Barberis, Nicholas, and Andrei Shleifer. 2003. <span>“Style Investing.”</span> <em>Journal of Financial Economics</em> 68 (2): 161–99.
</div>
<div id="ref-barillas2018comparing" class="csl-entry">
Barillas, Francisco, and Jay Shanken. 2018. <span>“Comparing Asset Pricing Models.”</span> <em>Journal of Finance</em> 73 (2): 715–54.
</div>
<div id="ref-barron1993universal" class="csl-entry">
Barron, Andrew R. 1993. <span>“Universal Approximation Bounds for Superpositions of a Sigmoidal Function.”</span> <em>IEEE Transactions on Information Theory</em> 39 (3): 930–45.
</div>
<div id="ref-barron1994approximation" class="csl-entry">
———. 1994. <span>“Approximation and Estimation Bounds for Artificial Neural Networks.”</span> <em>Machine Learning</em> 14 (1): 115–33.
</div>
<div id="ref-barroso2015momentum" class="csl-entry">
Barroso, Pedro, and Pedro Santa-Clara. 2015. <span>“Momentum Has Its Moments.”</span> <em>Journal of Financial Economics</em> 116 (1): 111–20.
</div>
<div id="ref-basak2004online" class="csl-entry">
Basak, Jayanta. 2004. <span>“Online Adaptive Decision Trees.”</span> <em>Neural Computation</em> 16 (9): 1959–81.
</div>
<div id="ref-bates1969combination" class="csl-entry">
Bates, John M, and Clive WJ Granger. 1969. <span>“The Combination of Forecasts.”</span> <em>Journal of the Operational Research Society</em> 20 (4): 451–68.
</div>
<div id="ref-bauder2020bayesian" class="csl-entry">
Bauder, David, Taras Bodnar, Nestor Parolya, and Wolfgang Schmid. 2020. <span>“Bayesian Inference of the Multi-Period Optimal Portfolio for an Exponential Utility.”</span> <em>Journal of Multivariate Analysis</em> 175: 104544.
</div>
<div id="ref-baz2015dissecting" class="csl-entry">
Baz, Jamil, Nicolas Granger, Campbell R Harvey, Nicolas Le Roux, and Sandy Rattray. 2015. <span>“Dissecting Investment Strategies in the Cross Section and Time Series.”</span> <em>SSRN Working Paper</em> 2695101.
</div>
<div id="ref-beery2018recognition" class="csl-entry">
Beery, Sara, Grant Van Horn, and Pietro Perona. 2018. <span>“Recognition in Terra Incognita.”</span> In <em>Proceedings of the European Conference on Computer Vision (ECCV)</em>, 456–73.
</div>
<div id="ref-belle2020principles" class="csl-entry">
Belle, Vaishak, and Ioannis Papantonis. 2020. <span>“Principles and Practice of Explainable Machine Learning.”</span> <em>arXiv Preprint</em>, no. 2009.11698.
</div>
<div id="ref-bellone2020equity" class="csl-entry">
Bellone, Benoit, Thomas Heckel, François Soupé, and Raul Leote de Carvalho. 2020. <span>“Equity Factor Investing: Historical Perspective of Recent Performance.”</span> <em>SSRN Working Paper</em> 3732113.
</div>
<div id="ref-belsley2005regression" class="csl-entry">
Belsley, David A, Edwin Kuh, and Roy E Welsch. 2005. <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>. Vol. 571. John Wiley &amp; Sons.
</div>
<div id="ref-benard2021sirus" class="csl-entry">
Bénard, Clément, Gérard Biau, Sébastien Da Veiga, and Erwan Scornet. 2021. <span>“Sirus: <span>S</span>table and Interpretable Rule Set for Classification.”</span> <em>Electronic Journal of Statistics</em> 15 (1): 427–505.
</div>
<div id="ref-ben2010theory" class="csl-entry">
Ben-David, Shai, John Blitzer, Koby Crammer, Alex Kulesza, Fernando Pereira, and Jennifer Wortman Vaughan. 2010. <span>“A Theory of Learning from Different Domains.”</span> <em>Machine Learning</em> 79 (1-2): 151–75.
</div>
<div id="ref-bengio2012practical" class="csl-entry">
Bengio, Yoshua. 2012. <span>“Practical Recommendations for Gradient-Based Training of Deep Architectures.”</span> In <em>Neural Networks: Tricks of the Trade</em>, 437–78. Springer.
</div>
<div id="ref-berg2019aggregate" class="csl-entry">
Berg, Florian, Julian F Koelbel, and Roberto Rigobon. 2020. <span>“Aggregate Confusion: The Divergence of <span>ESG</span> Ratings.”</span> <em>SSRN Working Paper</em> 3438533.
</div>
<div id="ref-bergstra2012random" class="csl-entry">
Bergstra, James, and Yoshua Bengio. 2012. <span>“Random Search for Hyper-Parameter Optimization.”</span> <em>Journal of Machine Learning Research</em> 13 (Feb): 281–305.
</div>
<div id="ref-berk1999optimal" class="csl-entry">
Berk, Jonathan B, Richard C Green, and Vasant Naik. 1999. <span>“Optimal Investment, Growth Options, and Security Returns.”</span> <em>Journal of Finance</em> 54 (5): 1553–1607.
</div>
<div id="ref-bernstein2019disaster" class="csl-entry">
Bernstein, Asaf, Matthew T Gustafson, and Ryan Lewis. 2019. <span>“Disaster on the Horizon: The Price Effect of Sea Level Rise.”</span> <em>Journal of Financial Economics</em> 134 (2): 253–72.
</div>
<div id="ref-bertoluzzo2012testing" class="csl-entry">
Bertoluzzo, Francesco, and Marco Corazza. 2012. <span>“Testing Different Reinforcement Learning Configurations for Financial Trading: Introduction and Applications.”</span> <em>Procedia Economics and Finance</em> 3: 68–77.
</div>
<div id="ref-bertsekas2017dynamic" class="csl-entry">
Bertsekas, Dimitri P. 2017. <em>Dynamic Programming and Optimal Control - Volume II, Fourth Edition</em>. Athena Scientific.
</div>
<div id="ref-betermier2019supply" class="csl-entry">
Betermier, Sebastien, Laurent E Calvet, and Evan Jo. 2019. <span>“A Supply and Demand Approach to Equity Pricing.”</span> <em>SSRN Working Paper</em> 3440147.
</div>
<div id="ref-betermier2017value" class="csl-entry">
Betermier, Sebastien, Laurent E Calvet, and Paolo Sodini. 2017. <span>“Who Are the Value and Growth Investors?”</span> <em>Journal of Finance</em> 72 (1): 5–46.
</div>
<div id="ref-bhamra2019does" class="csl-entry">
Bhamra, Harjoat S, and Raman Uppal. 2019. <span>“Does Household Finance Matter? Small Financial Errors with Large Social Costs.”</span> <em>American Economic Review</em> 109 (3): 1116–54.
</div>
<div id="ref-bhatia2010survey" class="csl-entry">
Bhatia, Nitin et al. 2010. <span>“Survey of Nearest Neighbor Techniques.”</span> <em>arXiv Preprint</em>, no. 1007.0085.
</div>
<div id="ref-bhattacharyya2011data" class="csl-entry">
Bhattacharyya, Siddhartha, Sanjeev Jha, Kurian Tharakunnel, and J Christopher Westland. 2011. <span>“Data Mining for Credit Card Fraud: A Comparative Study.”</span> <em>Decision Support Systems</em> 50 (3): 602–13.
</div>
<div id="ref-biau2012analysis" class="csl-entry">
Biau, Gérard. 2012. <span>“Analysis of a Random Forests Model.”</span> <em>Journal of Machine Learning Research</em> 13 (Apr): 1063–95.
</div>
<div id="ref-biau2008consistency" class="csl-entry">
Biau, Gérard, Luc Devroye, and GAbor Lugosi. 2008. <span>“Consistency of Random Forests and Other Averaging Classifiers.”</span> <em>Journal of Machine Learning Research</em> 9 (Sep): 2015–33.
</div>
<div id="ref-biecek2021explanatory" class="csl-entry">
Biecek, Przemyslaw, and Tomasz Burzykowski. 2021. <em>Explanatory Model Analysis: Explore, Explain, and Examine Predictive Models</em>. CRC Press.
</div>
<div id="ref-binz2020can" class="csl-entry">
Binz, Oliver, Katherine Schipper, and Kevin Standridge. 2020. <span>“What Can Analysts Learn from Artificial Intelligence about Fundamental Analysis?”</span> <em>SSRN Working Paper</em> 3745078.
</div>
<div id="ref-black1992global" class="csl-entry">
Black, Fischer, and Robert Litterman. 1992. <span>“Global Portfolio Optimization.”</span> <em>Financial Analysts Journal</em> 48 (5): 28–43.
</div>
<div id="ref-blank2019using" class="csl-entry">
Blank, Herbert, Richard Davis, and Shannon Greene. 2019. <span>“Using Alternative Research Data in Real-World Portfolios.”</span> <em>Journal of Investing</em> 28 (4): 95–103.
</div>
<div id="ref-blitz2020exclusion" class="csl-entry">
Blitz, David, and Laurens Swinkels. 2020. <span>“Is Exclusion Effective?”</span> <em>Journal of Portfolio Management</em> 46 (3): 42–48.
</div>
<div id="ref-blum1999universal" class="csl-entry">
Blum, Avrim, and Adam Kalai. 1999. <span>“Universal Portfolios with and Without Transaction Costs.”</span> <em>Machine Learning</em> 35 (3): 193–205.
</div>
<div id="ref-bodnar2013equivalence" class="csl-entry">
Bodnar, Taras, Nestor Parolya, and Wolfgang Schmid. 2013. <span>“On the Equivalence of Quadratic Optimization Problems Commonly Used in Portfolio Theory.”</span> <em>European Journal of Operational Research</em> 229 (3): 637–44.
</div>
<div id="ref-boehmke2019hands" class="csl-entry">
Boehmke, Brad, and Brandon Greenwell. 2019. <em>Hands-on Machine Learning with r</em>. Chapman &amp; Hall / CRC.
</div>
<div id="ref-boloorforoosh2019beta" class="csl-entry">
Boloorforoosh, Ali, Peter Christoffersen, Christian Gourieroux, and Mathieu Fournier. 2020. <span>“Beta Risk in the Cross-Section of Equities.”</span> <em>Review of Financial Studies</em> Forthcoming.
</div>
<div id="ref-bonaccolto2019developing" class="csl-entry">
Bonaccolto, Giovanni, and Sandra Paterlini. 2019. <span>“Developing New Portfolio Strategies by Aggregation.”</span> <em>Annals of Operations Research</em>, 1–39.
</div>
<div id="ref-boriah2008similarity" class="csl-entry">
Boriah, Shyam, Varun Chandola, and Vipin Kumar. 2008. <span>“Similarity Measures for Categorical Data: A Comparative Evaluation.”</span> In <em>Proceedings of the 2008 SIAM International Conference on Data Mining</em>, 243–54.
</div>
<div id="ref-borisov2021deep" class="csl-entry">
Borisov, Vadim, Tobias Leemann, Kathrin Seßler, Johannes Haug, Martin Pawelczyk, and Gjergji Kasneci. 2021. <span>“Deep Neural Networks and Tabular Data: <span>A</span> Survey.”</span> <em>arXiv Preprint</em>, no. 2110.01889.
</div>
<div id="ref-boser1992training" class="csl-entry">
Boser, Bernhard E, Isabelle M Guyon, and Vladimir N Vapnik. 1992. <span>“A Training Algorithm for Optimal Margin Classifiers.”</span> In <em>Proceedings of the Fifth Annual Workshop on Computational Learning Theory</em>, 144–52. ACM.
</div>
<div id="ref-bouchaud2019sticky" class="csl-entry">
Bouchaud, Jean-philippe, Philipp Krueger, Augustin Landier, and David Thesmar. 2019. <span>“Sticky Expectations and the Profitability Anomaly.”</span> <em>Journal of Finance</em> 74 (2): 639–74.
</div>
<div id="ref-bouthillier2020survey" class="csl-entry">
Bouthillier, Xavier, and Gaël Varoquaux. 2020. <span>“Survey of Machine-Learning Experimental Methods at NeurIPS2019 and Iclr2020.”</span> Research Report. Inria Saclay Ile de France.
</div>
<div id="ref-boyd2004convex" class="csl-entry">
Boyd, Stephen, and Lieven Vandenberghe. 2004. <em>Convex Optimization</em>. Cambridge University Press.
</div>
<div id="ref-branch2012socially" class="csl-entry">
Branch, Ben, and Li Cai. 2012. <span>“Do Socially Responsible Index Investors Incur an Opportunity Cost?”</span> <em>Financial Review</em> 47 (3): 617–30.
</div>
<div id="ref-brandt2009parametric" class="csl-entry">
Brandt, Michael W, Pedro Santa-Clara, and Rossen Valkanov. 2009. <span>“Parametric Portfolio Policies: Exploiting Characteristics in the Cross-Section of Equity Returns.”</span> <em>Review of Financial Studies</em> 22 (9): 3411–47.
</div>
<div id="ref-braun1987predicting" class="csl-entry">
Braun, Helmut, and John S Chandler. 1987. <span>“Predicting Stock Market Behavior Through Rule Induction: An Application of the Learning-from-Example Approach.”</span> <em>Decision Sciences</em> 18 (3): 415–29.
</div>
<div id="ref-breiman1996stacked" class="csl-entry">
Breiman, Leo. 1996. <span>“Stacked Regressions.”</span> <em>Machine Learning</em> 24 (1): 49–64.
</div>
<div id="ref-breiman2001random" class="csl-entry">
———. 2001. <span>“Random Forests.”</span> <em>Machine Learning</em> 45 (1): 5–32.
</div>
<div id="ref-breiman2004population" class="csl-entry">
Breiman, Leo et al. 2004. <span>“Population Theory for Boosting Ensembles.”</span> <em>Annals of Statistics</em> 32 (1): 1–11.
</div>
<div id="ref-breiman1984classification" class="csl-entry">
Breiman, Leo, Jerome Friedman, Charles J. Stone, and R. A. Olshen. 1984. <em>Classification and Regression Trees</em>. Chapman &amp; Hall.
</div>
<div id="ref-briere2021rains" class="csl-entry">
Briere, Marie, and Ariane Szafarz. 2021. <span>“When It Rains, It Pours: <span>M</span>ultifactor Asset Management in Good and Bad Times.”</span> <em>Journal of Financial Research</em> Forthcoming.
</div>
<div id="ref-brightman2015chasing" class="csl-entry">
Brightman, Chris, Feifei Li, and Xi Liu. 2015. <span>“Chasing Performance with <span>ETF</span>s.”</span> <em>Research Affiliates (November)</em>.
</div>
<div id="ref-brodersen2015inferring" class="csl-entry">
Brodersen, Kay H, Fabian Gallusser, Jim Koehler, Nicolas Remy, Steven L Scott, et al. 2015. <span>“Inferring Causal Impact Using Bayesian Structural Time-Series Models.”</span> <em>Annals of Applied Statistics</em> 9 (1): 247–74.
</div>
<div id="ref-brodie2009sparse" class="csl-entry">
Brodie, Joshua, Ingrid Daubechies, Christine De Mol, Domenico Giannone, and Ignace Loris. 2009. <span>“Sparse and Stable Markowitz Portfolios.”</span> <em>Proceedings of the National Academy of Sciences</em> 106 (30): 12267–72.
</div>
<div id="ref-brown2012experimental" class="csl-entry">
Brown, Iain, and Christophe Mues. 2012. <span>“An Experimental Comparison of Classification Algorithms for Imbalanced Credit Scoring Data Sets.”</span> <em>Expert Systems with Applications</em> 39 (3): 3446–53.
</div>
<div id="ref-bruder2019integration" class="csl-entry">
Bruder, Benjamin, Yazid Cheikh, Florent Deixonne, and Ban Zheng. 2019. <span>“Integration of <span>ESG</span> in Asset Allocation.”</span> <em>SSRN Working Paper</em> 3473874.
</div>
<div id="ref-bryzgalova2019spurious" class="csl-entry">
Bryzgalova, Svetlana. 2019. <span>“Spurious Factors in Linear Asset Pricing Models.”</span>
</div>
<div id="ref-bryzgalova2019bayesian" class="csl-entry">
Bryzgalova, Svetlana, Jiantao Huang, and Christian Julliard. 2019. <span>“Bayesian Solutions for the Factor Zoo: We Just Ran Two Quadrillion Models.”</span> <em>SSRN Working Paper</em> 3481736.
</div>
<div id="ref-bryzgalova2019forest" class="csl-entry">
Bryzgalova, Svetlana, Markus Pelger, and Jason Zhu. 2019. <span>“Forest Through the Trees: Building Cross-Sections of Stock Returns.”</span> <em>SSRN Working Paper</em> 3493458.
</div>
<div id="ref-buehler2019deep" class="csl-entry">
Buehler, Hans, Lukas Gonon, Josef Teichmann, and Ben Wood. 2019. <span>“Deep Hedging.”</span> <em>Quantitative Finance</em> 19 (8): 1271–91.
</div>
<div id="ref-buehler2020generating" class="csl-entry">
Buehler, Hans, Blanka Horvath, Terry Lyons, Imanol Perez Arribas, and Ben Wood. 2020. <span>“Generating Financial Markets with Signatures.”</span> <em>SSRN Working Paper</em> 3657366.
</div>
<div id="ref-buhlmann2014cam" class="csl-entry">
Bühlmann, Peter, Jonas Peters, Jan Ernest, et al. 2014. <span>“CAM: Causal Additive Models, High-Dimensional Order Search and Penalized Regression.”</span> <em>Annals of Statistics</em> 42 (6): 2526–56.
</div>
<div id="ref-burrell1997impact" class="csl-entry">
Burrell, Phillip R., and Bukola Otulayo Folarin. 1997. <span>“The Impact of Neural Networks in Finance.”</span> <em>Neural Computing &amp; Applications</em> 6 (4): 193–200.
</div>
<div id="ref-bustos2020stock" class="csl-entry">
Bustos, O, and A Pomares-Quimbaya. 2020. <span>“Stock Market Movement Forecast: A Systematic Review.”</span> <em>Expert Systems with Applications</em> Forthcoming.
</div>
<div id="ref-cakici2021size" class="csl-entry">
Cakici, Nusret, and Adam Zaremba. 2021. <span>“Size, Value, Profitability, and Investment Effects in International Stock Returns: <span>A</span>re They Really There?”</span> <em>Journal of Investing</em> Forthcoming.
</div>
<div id="ref-camilleri2020market" class="csl-entry">
Camilleri, Mark Anthony. 2020. <span>“The Market for Socially Responsible Investing: A Review of the Developments.”</span> <em>Social Responsibility Journal</em> Forthcoming.
</div>
<div id="ref-campbell2006efficient" class="csl-entry">
Campbell, John Y, and Motohiro Yogo. 2006. <span>“Efficient Tests of Stock Return Predictability.”</span> <em>Journal of Financial Economics</em> 81 (1): 27–60.
</div>
<div id="ref-cao2020fundamental" class="csl-entry">
Cao, Kai, and Haifeng You. 2020. <span>“Fundamental Analysis via Machine Learning.”</span> <em>SSRN Working Paper</em> 3706532.
</div>
<div id="ref-cao2003support" class="csl-entry">
Cao, Li-Juan, and Francis Eng Hock Tay. 2003. <span>“Support Vector Machine with Adaptive Parameters in Financial Time Series Forecasting.”</span> <em>IEEE Transactions on Neural Networks</em> 14 (6): 1506–18.
</div>
<div id="ref-carhart1997persistence" class="csl-entry">
Carhart, Mark M. 1997. <span>“On Persistence in Mutual Fund Performance.”</span> <em>Journal of Finance</em> 52 (1): 57–82.
</div>
<div id="ref-carlson2004corporate" class="csl-entry">
Carlson, Murray, Adlai Fisher, and Ron Giammarino. 2004. <span>“Corporate Investment and Asset Price Dynamics: Implications for the Cross-Section of Returns.”</span> <em>Journal of Finance</em> 59 (6): 2577–2603.
</div>
<div id="ref-castaneda2019microfounding" class="csl-entry">
Castaneda, Pablo, and Jorge Sabat. 2019. <span>“Microfounding the Fama-MacBeth Regression.”</span> <em>SSRN Working Paper</em> 3435141.
</div>
<div id="ref-cattaneo2019characteristic" class="csl-entry">
Cattaneo, Matias D, Richard K Crump, Max Farrell, and Ernst Schaumburg. 2020. <span>“Characteristic-Sorted Portfolios: Estimation and Inference”</span> Forthcoming: 1–47.
</div>
<div id="ref-cazalet2014facts" class="csl-entry">
Cazalet, Zélia, and Thierry Roncalli. 2014. <span>“Facts and Fantasies about Factor Investing.”</span> <em>SSRN Working Paper</em> 2524547.
</div>
<div id="ref-chakrabarti2020time" class="csl-entry">
Chakrabarti, Gagari, and Chitrakalpa Sen. 2020. <span>“Time Series Momentum Trading in Green Stocks.”</span> <em>Studies in Economics and Finance</em>.
</div>
<div id="ref-chandola2009anomaly" class="csl-entry">
Chandola, Varun, Arindam Banerjee, and Vipin Kumar. 2009. <span>“Anomaly Detection: A Survey.”</span> <em>ACM Computing Surveys (CSUR)</em> 41 (3): 15.
</div>
<div id="ref-chang2011libsvm" class="csl-entry">
Chang, Chih-Chung, and Chih-Jen Lin. 2011. <span>“<span>LIBSVM</span>: <span>A</span> Library for Support Vector Machines.”</span> <em>ACM Transactions on Intelligent Systems and Technology (TIST)</em> 2 (3): 27.
</div>
<div id="ref-chaouki2020deep" class="csl-entry">
Chaouki, Ayman, Stephen Hardiman, Christian Schmidt, Joachim de Lataillade, et al. 2020. <span>“Deep Deterministic Portfolio Optimization.”</span> <em>arXiv Preprint</em>, no. 2003.06497.
</div>
<div id="ref-charpentier2020reinforcement" class="csl-entry">
Charpentier, Arthur, Romuald Elie, and Carl Remlinger. 2020. <span>“Reinforcement Learning in Economics and Finance.”</span> <em>arXiv Preprint</em>, no. 2003.10014.
</div>
<div id="ref-che2018recurrent" class="csl-entry">
Che, Zhengping, Sanjay Purushotham, Kyunghyun Cho, David Sontag, and Yan Liu. 2018. <span>“Recurrent Neural Networks for Multivariate Time Series with Missing Values.”</span> <em>Scientific Reports</em> 8 (1): 6085.
</div>
<div id="ref-cheema2020decarbonization" class="csl-entry">
Cheema-Fox, Alexander, Bridget Realmuto LaPerla, George Serafeim, David Turkington, and Hui Stacie Wang. 2020. <span>“Decarbonization Factors.”</span> <em>SSRN Working Paper</em> 3448637.
</div>
<div id="ref-chen2019limits" class="csl-entry">
Chen, Andrew Y. 2019. <span>“The Limits of p-Hacking: A Thought Experiment.”</span> <em>SSRN Working Paper</em> 3272572.
</div>
<div id="ref-chen2020t" class="csl-entry">
———. 2020a. <span>“Do t-Stat Hurdles Need to Be Raised?”</span> <em>SSRN Working Paper</em> 3254995.
</div>
<div id="ref-chen2020limits" class="csl-entry">
———. 2020b. <span>“The Limits of p-Hacking: Some Thought Experiments.”</span> <em>Journal of Finance</em> Forthcoming.
</div>
<div id="ref-chen2020zeroing" class="csl-entry">
Chen, Andrew Y, and Mihail Velikov. 2020. <span>“Zeroing in on the Expected Returns of Anomalies.”</span> <em>SSRN Working Paper</em> 3073681.
</div>
<div id="ref-chen2020publication" class="csl-entry">
Chen, Andrew Y, and Tom Zimmermann. 2020. <span>“Publication Bias and the Cross-Section of Stock Returns.”</span> <em>Review of Asset Pricing Studies</em> Forthcoming.
</div>
<div id="ref-chen2021open" class="csl-entry">
———. 2021. <span>“Open Source Cross-Sectional Asset Pricing.”</span> <em>Critical Finance Review</em> Forthcoming.
</div>
<div id="ref-chen2001initialization" class="csl-entry">
Chen, Huifen. 2001. <span>“Initialization for <span>NORTA</span>: <span>G</span>eneration of Random Vectors with Specified Marginals and Correlations.”</span> <em>INFORMS Journal on Computing</em> 13 (4): 312–31.
</div>
<div id="ref-chen2018shapley" class="csl-entry">
Chen, Jianbo, Le Song, Martin J Wainwright, and Michael I Jordan. 2018. <span>“L-Shapley and c-Shapley: Efficient Model Interpretation for Structured Data.”</span> <em>arXiv Preprint</em>, no. 1808.02610.
</div>
<div id="ref-chen2016financial" class="csl-entry">
Chen, Jou-Fan, Wei-Lun Chen, Chun-Ping Huang, Szu-Hao Huang, and An-Pin Chen. 2016. <span>“Financial Time-Series Data Analysis Using Deep Convolutional Neural Networks.”</span> In <em>2016 7th International Conference on Cloud Computing and Big Data (CCBD)</em>, 87–92. IEEE.
</div>
<div id="ref-chen2012dividend" class="csl-entry">
Chen, Long, Zhi Da, and Richard Priestley. 2012. <span>“Dividend Smoothing and Predictability.”</span> <em>Management Science</em> 58 (10): 1834–53.
</div>
<div id="ref-chen2019deep" class="csl-entry">
Chen, Luyang, Markus Pelger, and Jason Zhu. 2020. <span>“Deep Learning in Asset Pricing.”</span> <em>SSRN Working Paper</em> 3350138.
</div>
<div id="ref-chen2016xgboost" class="csl-entry">
Chen, Tianqi, and Carlos Guestrin. 2016. <span>“Xgboost: A Scalable Tree Boosting System.”</span> In <em>Proceedings of the 22nd <span>ACM</span> <span>SIGKDD</span> <span>I</span>nternational Conference on Knowledge Discovery and Data Mining</em>, 785–94. ACM.
</div>
<div id="ref-chen2017feature" class="csl-entry">
Chen, Yingjun, and Yongtao Hao. 2017. <span>“A Feature Weighted Support Vector Machine and k-Nearest Neighbor Algorithm for Stock Market Indices Prediction.”</span> <em>Expert Systems with Applications</em> 80: 340–55.
</div>
<div id="ref-cheng2022stock" class="csl-entry">
Cheng, Tingting, and Albert Bo Zhao. 2022. <span>“Stock Return Prediction: <span>S</span>tacking a Variety of Models.”</span> <em>Journal of Empirical Finance</em> Forthcoming.
</div>
<div id="ref-chiang2021modeling" class="csl-entry">
Chiang, I-Hsuan Ethan, Yin Liao, and Qing Zhou. 2021. <span>“Modeling the Cross-Section of Stock Returns Using Sensible Models in a Model Pool.”</span> <em>Journal of Empirical Finance</em> 60: 56–73.
</div>
<div id="ref-chib2021winners" class="csl-entry">
Chib, Siddhartha, Dashan Huang, Lingxiao Zhao, and Guofu Zhou. 2020. <span>“Winners from Winners: <span>A</span> Tale of Risk Factors.”</span> <em>SSRN Working Paper</em> 3478223.
</div>
<div id="ref-chib2020factors" class="csl-entry">
Chib, Siddhartha, and Xiaming Zeng. 2020. <span>“Which Factors Are Risk Factors in Asset Pricing? <span>A</span> Model Scan Framework.”</span> <em>Journal of Business &amp; Economic Statistics</em> 38 (4): 771–83.
</div>
<div id="ref-chib2019comparing" class="csl-entry">
Chib, Siddhartha, Xiaming Zeng, and Lingxiao Zhao. 2020. <span>“On Comparing Asset Pricing Models.”</span> <em>Journal of Finance</em> 75 (1): 551–77.
</div>
<div id="ref-chib2021finding" class="csl-entry">
Chib, Siddhartha, Lingxiao Zhao, and Guofu Zhou. 2021. <span>“Finding Risk-Factors ... Without Using Old Data.”</span> <em>SSRN Working Paper</em> 3478223.
</div>
<div id="ref-chinco2019sparse" class="csl-entry">
Chinco, Alexander, Adam D Clark-Joseph, and Mao Ye. 2019. <span>“Sparse Signals in the Cross-Section of Returns.”</span> <em>Journal of Finance</em> 74 (1): 449–92.
</div>
<div id="ref-chinco2019estimating" class="csl-entry">
Chinco, Alexander, Andreas Neuhierl, and Michael Weber. 2020. <span>“Estimating the Anomaly Baserate.”</span> <em>Journal of Financial Economics</em> Forthcoming.
</div>
<div id="ref-chinco2019risk" class="csl-entry">
Chinco, Alex, Samuel M Hartzmark, and Abigail B Sussman. 2019. <span>“Necessary Evidence for a Risk Factor’s Relevance.”</span> <em>SSRN Working Paper</em> 3487624.
</div>
<div id="ref-chipman2010bart" class="csl-entry">
Chipman, Hugh A, Edward I George, and Robert E McCulloch. 2010. <span>“<span>BART</span>: <span>B</span>ayesian Additive Regression Trees.”</span> <em>Annals of Applied Statistics</em> 4 (1): 266–98.
</div>
<div id="ref-choi2014momentum" class="csl-entry">
Choi, Seung Mo, and Hwagyun Kim. 2014. <span>“Momentum Effect as Part of a Market Equilibrium.”</span> <em>Journal of Financial and Quantitative Analysis</em> 49 (1): 107–30.
</div>
<div id="ref-chollet2017deep" class="csl-entry">
Chollet, François. 2017. <em>Deep Learning with Python</em>. Manning Publications Company.
</div>
<div id="ref-chordia2020anomalies" class="csl-entry">
Chordia, Tarun, Amit Goyal, and Alessio Saretto. 2020. <span>“Anomalies and False Rejections.”</span> <em>Review of Financial Studies</em> 33 (5): 2134–79.
</div>
<div id="ref-chordia2015cross" class="csl-entry">
Chordia, Tarun, Amit Goyal, and Jay Shanken. 2019. <span>“Cross-Sectional Asset Pricing with Individual Stocks: Betas Versus Characteristics.”</span> <em>SSRN Working Paper</em> 2549578.
</div>
<div id="ref-chow2002multivariate" class="csl-entry">
Chow, Ying-Foon, John A Cotsomitis, and Andy CC Kwan. 2002. <span>“Multivariate Cointegration and Causality Tests of Wagner’s Hypothesis: Evidence from the <span>UK</span>.”</span> <em>Applied Economics</em> 34 (13): 1671–77.
</div>
<div id="ref-chung2015gated" class="csl-entry">
Chung, Junyoung, Caglar Gulcehre, Kyunghyun Cho, and Yoshua Bengio. 2015. <span>“Gated Feedback Recurrent Neural Networks.”</span> In <em>International Conference on Machine Learning</em>, 2067–75.
</div>
<div id="ref-claeskens2008model" class="csl-entry">
Claeskens, Gerda, and Nils Lid Hjort. 2008. <em>Model Selection and Model Averaging</em>. Cambridge University Press.
</div>
<div id="ref-clark2009improving" class="csl-entry">
Clark, Todd E, and Michael W McCracken. 2009. <span>“Improving Forecast Accuracy by Combining Recursive and Rolling Forecasts.”</span> <em>International Economic Review</em> 50 (2): 363–95.
</div>
<div id="ref-cocco2019evidence" class="csl-entry">
Cocco, Joao F, Francisco Gomes, and Paula Lopes. 2020. <span>“Evidence on Expectations of Household Finances.”</span> <em>SSRN Working Paper</em> 3362495.
</div>
<div id="ref-cochrane2009asset" class="csl-entry">
Cochrane, John H. 2009. <em>Asset Pricing: Revised Edition</em>. Princeton University Press.
</div>
<div id="ref-cochrane2011presidential" class="csl-entry">
———. 2011. <span>“Presidential Address: Discount Rates.”</span> <em>Journal of Finance</em> 66 (4): 1047–1108.
</div>
<div id="ref-cong2019analyzing" class="csl-entry">
Cong, Lin William, Tengyuan Liang, and Xiao Zhang. 2019a. <span>“Analyzing Textual Information at Scale.”</span> <em>SSRN Working Paper</em> 3449822.
</div>
<div id="ref-cong2019textual" class="csl-entry">
———. 2019b. <span>“Textual Factors: A Scalable, Interpretable, and Data-Driven Approach to Analyzing Unstructured Information.”</span> <em>SSRN Working Paper</em> 3307057.
</div>
<div id="ref-cong2019rise" class="csl-entry">
Cong, Lin William, and Douglas Xu. 2019. <span>“Rise of Factor Investing: Asset Prices, Informational Efficiency, and Security Design.”</span> <em>SSRN Working Paper</em> 2800590.
</div>
<div id="ref-connor1988risk" class="csl-entry">
Connor, Gregory, and Robert A Korajczyk. 1988. <span>“Risk and Return in an Equilibrium APT: Application of a New Test Methodology.”</span> <em>Journal of Financial Economics</em> 21 (2): 255–89.
</div>
<div id="ref-connor1993test" class="csl-entry">
———. 1993. <span>“A Test for the Number of Factors in an Approximate Factor Model.”</span> <em>The Journal of Finance</em> 48 (4): 1263–91.
</div>
<div id="ref-cont2007volatility" class="csl-entry">
Cont, Rama. 2007. <span>“Volatility Clustering in Financial Markets: Empirical Facts and Agent-Based Models.”</span> In <em>Long Memory in Economics</em>, 289–309. Springer.
</div>
<div id="ref-cooper2018new" class="csl-entry">
Cooper, Ilan, and Paulo F Maio. 2019. <span>“New Evidence on Conditional Factor Models.”</span> <em>Journal of Financial and Quantitative Analysis</em> 54 (5): 1975–2016.
</div>
<div id="ref-coqueret2015diversified" class="csl-entry">
Coqueret, Guillaume. 2015. <span>“Diversified Minimum-Variance Portfolios.”</span> <em>Annals of Finance</em> 11 (2): 221–41.
</div>
<div id="ref-coqueret2017approximate" class="csl-entry">
———. 2017. <span>“Approximate<span> NORTA</span> Simulations for Virtual Sample Generation.”</span> <em>Expert Systems with Applications</em> 73: 69–81.
</div>
<div id="ref-coqueret2018economic" class="csl-entry">
———. 2020. <span>“Stock Specific Sentiment and Return Predictability.”</span> <em>Quantitative Finance</em> Forthcoming.
</div>
<div id="ref-coqueret2019training" class="csl-entry">
Coqueret, Guillaume, and Tony Guida. 2020. <span>“Training Trees on Tails with Applications to Portfolio Choice.”</span> <em>Annals of Operations Research</em> 288: 181–221.
</div>
<div id="ref-cornell2020stock" class="csl-entry">
Cornell, Bradford. 2020. <span>“Stock Characteristics and Stock Returns: A Skeptic’s Look at the Cross Section of Expected Returns.”</span> <em>Journal of Portfolio Management</em>.
</div>
<div id="ref-cornell2021value" class="csl-entry">
Cornell, Bradford, and Aswath Damodaran. 2021. <span>“Value Investing: Requiem, Rebirth or Reincarnation?”</span> <em>SSRN Working Paper</em> 3779481.
</div>
<div id="ref-cornuejols2011apprentissage" class="csl-entry">
Cornuejols, Antoine, Laurent Miclet, and Vincent Barra. 2018. <em>Apprentissage Artificiel: Deep Learning, Concepts Et Algorithmes</em>. Eyrolles.
</div>
<div id="ref-cortes1995support" class="csl-entry">
Cortes, Corinna, and Vladimir Vapnik. 1995. <span>“Support-Vector Networks.”</span> <em>Machine Learning</em> 20 (3): 273–97.
</div>
<div id="ref-costarelli2016survey" class="csl-entry">
Costarelli, Danilo, Renato Spigler, and Gianluca Vinti. 2016. <span>“A Survey on Approximation by Means of Neural Network Operators.”</span> <em>Journal of NeuroTechnology</em> 1 (1).
</div>
<div id="ref-cover1991universal" class="csl-entry">
Cover, Thomas M. 1991. <span>“Universal Portfolios.”</span> <em>Mathematical Finance</em> 1 (1): 1–29.
</div>
<div id="ref-cover1996universal" class="csl-entry">
Cover, Thomas M, and Erik Ordentlich. 1996. <span>“Universal Portfolios with Side Information.”</span> <em>IEEE Transactions on Information Theory</em> 42 (2): 348–63.
</div>
<div id="ref-crammer2006online" class="csl-entry">
Crammer, Koby, Ofer Dekel, Joseph Keshet, Shai Shalev-Shwartz, and Yoram Singer. 2006. <span>“Online Passive-Aggressive Algorithms.”</span> <em>Journal of Machine Learning Research</em> 7 (Mar): 551–85.
</div>
<div id="ref-cronqvist2015fetal" class="csl-entry">
Cronqvist, Henrik, Alessandro Previtero, Stephan Siegel, and Roderick E White. 2015. <span>“The Fetal Origins Hypothesis in Finance: Prenatal Environment, the Gender Gap, and Investor Behavior.”</span> <em>Review of Financial Studies</em> 29 (3): 739–86.
</div>
<div id="ref-cronqvist2015value" class="csl-entry">
Cronqvist, Henrik, Stephan Siegel, and Frank Yu. 2015. <span>“Value Versus Growth Investing: Why Do Different Investors Have Different Styles?”</span> <em>Journal of Financial Economics</em> 117 (2): 333–49.
</div>
<div id="ref-cuchiero2016new" class="csl-entry">
Cuchiero, Christa, Irene Klein, and Josef Teichmann. 2016. <span>“A New Perspective on the Fundamental Theorem of Asset Pricing for Large Financial Markets.”</span> <em>Theory of Probability &amp; Its Applications</em> 60 (4): 561–79.
</div>
<div id="ref-cybenko1989approximation" class="csl-entry">
Cybenko, George. 1989. <span>“Approximation by Superpositions of a Sigmoidal Function.”</span> <em>Mathematics of Control, Signals and Systems</em> 2 (4): 303–14.
</div>
<div id="ref-d2011identifying" class="csl-entry">
d’Aspremont, Alexandre. 2011. <span>“Identifying Small Mean-Reverting Portfolios.”</span> <em>Quantitative Finance</em> 11 (3): 351–64.
</div>
<div id="ref-dacunto2021evolving" class="csl-entry">
D’Acunto, Gabriele, Paolo Bajardi, Francesco Bonchi, and Gianmarco De Francisci Morales. 2021. <span>“The Evolving Causal Structure of Equity Risk Factors.”</span> <em>arXiv Preprint</em>, no. 2111.05072.
</div>
<div id="ref-dangl2012predictive" class="csl-entry">
Dangl, Thomas, and Michael Halling. 2012. <span>“Predictive Regressions with Time-Varying Coefficients.”</span> <em>Journal of Financial Economics</em> 106 (1): 157–81.
</div>
<div id="ref-dangl2020optimal" class="csl-entry">
Dangl, Thomas, and Alex Weissensteiner. 2020. <span>“Optimal Portfolios Under Time-Varying Investment Opportunities, Parameter Uncertainty, and Ambiguity Aversion.”</span> <em>Journal of Financial and Quantitative Analysis</em> 55 (4): 1163–98.
</div>
<div id="ref-daniel2001overconfidence" class="csl-entry">
Daniel, Kent D, David Hirshleifer, and Avanidhar Subrahmanyam. 2001. <span>“Overconfidence, Arbitrage, and Equilibrium Asset Pricing.”</span> <em>Journal of Finance</em> 56 (3): 921–65.
</div>
<div id="ref-daniel2019short" class="csl-entry">
Daniel, Kent, David Hirshleifer, and Lin Sun. 2020. <span>“Short and Long Horizon Behavioral Factors.”</span> <em>Review of Financial Studies</em> 33 (4): 1673–1736.
</div>
<div id="ref-daniel2016momentum" class="csl-entry">
Daniel, Kent, and Tobias J Moskowitz. 2016. <span>“Momentum Crashes.”</span> <em>Journal of Financial Economics</em> 122 (2): 221–47.
</div>
<div id="ref-daniel2020cross" class="csl-entry">
Daniel, Kent, Lira Mota, Simon Rottke, and Tano Santos. 2020. <span>“The Cross-Section of Risk and Return.”</span> <em>Review of Financial Studies</em> 33 (5): 1927–79.
</div>
<div id="ref-daniel1997evidence" class="csl-entry">
Daniel, Kent, and Sheridan Titman. 1997. <span>“Evidence on the Characteristics of Cross Sectional Variation in Stock Returns.”</span> <em>Journal of Finance</em> 52 (1): 1–33.
</div>
<div id="ref-daniel2012testing" class="csl-entry">
———. 2012. <span>“Testing Factor-Model Explanations of Market Anomalies.”</span> <em>Critical Finance Review</em> 1 (1): 103–39.
</div>
<div id="ref-daniel2001explaining" class="csl-entry">
Daniel, Kent, Sheridan Titman, and KC John Wei. 2001. <span>“Explaining the Cross-Section of Stock Returns in <span>J</span>apan: Factors or Characteristics?”</span> <em>Journal of Finance</em> 56 (2): 743–66.
</div>
<div id="ref-de2015comparing" class="csl-entry">
De Moor, Lieven, Geert Dhaene, and Piet Sercu. 2015. <span>“On Comparing Zero-Alpha Tests Across Multifactor Asset Pricing Models.”</span> <em>Journal of Banking &amp; Finance</em> 61: S235–40.
</div>
<div id="ref-de2020subsampled" class="csl-entry">
De Nard, Gianluca, Simon Hediger, and Markus Leippold. 2020. <span>“Subsampled Factor Models for Asset Pricing: The Rise of <span>V</span>asa.”</span> <em>SSRN Working Paper</em> 3557957.
</div>
<div id="ref-de2018advances" class="csl-entry">
De Prado, Marcos Lopez. 2018. <em>Advances in Financial Machine Learning</em>. John Wiley &amp; Sons.
</div>
<div id="ref-delbaen1994general" class="csl-entry">
Delbaen, Freddy, and Walter Schachermayer. 1994. <span>“A General Version of the Fundamental Theorem of Asset Pricing.”</span> <em>Mathematische Annalen</em> 300 (1): 463–520.
</div>
<div id="ref-demetrescu2020testing" class="csl-entry">
Demetrescu, Matei, Iliyan Georgiev, Paulo MM Rodrigues, and AM Taylor. 2020. <span>“Testing for Episodic Predictability in Stock Returns.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-demiguel2009generalized" class="csl-entry">
DeMiguel, Victor, Lorenzo Garlappi, Francisco J Nogales, and Raman Uppal. 2009. <span>“A Generalized Approach to Portfolio Optimization: Improving Performance by Constraining Portfolio Norms.”</span> <em>Management Science</em> 55 (5): 798–812.
</div>
<div id="ref-demiguel2007optimal" class="csl-entry">
DeMiguel, Victor, Lorenzo Garlappi, and Raman Uppal. 2009. <span>“Optimal Versus Naive Diversification: <span>H</span>ow Inefficient Is the 1/<span>N</span> Portfolio Strategy?”</span> <em>Review of Financial Studies</em> 22 (5): 1915–53.
</div>
<div id="ref-demiguel2019crowding" class="csl-entry">
DeMiguel, Victor, Alberto Martin Utrera, and Raman Uppal. 2019. <span>“What Alleviates Crowding in Factor Investing?”</span> <em>SSRN Working Paper</em> 3392875.
</div>
<div id="ref-martin2018transaction" class="csl-entry">
DeMiguel, Victor, Alberto Martin Utrera, Raman Uppal, and Francisco J Nogales. 2020. <span>“A Transaction-Cost Perspective on the Multitude of Firm Characteristics.”</span> <em>Review of Financial Studies</em> 33 (5): 2180–2222.
</div>
<div id="ref-demiguel2015parameter" class="csl-entry">
DeMiguel, Victor, Alberto Martı́n-Utrera, and Francisco J Nogales. 2015. <span>“Parameter Uncertainty in Multiperiod Portfolio Optimization with Transaction Costs.”</span> <em>Journal of Financial and Quantitative Analysis</em> 50 (6): 1443–71.
</div>
<div id="ref-denil2014narrowing" class="csl-entry">
Denil, Misha, David Matheson, and Nando De Freitas. 2014. <span>“Narrowing the Gap: Random Forests in Theory and in Practice.”</span> In <em>International Conference on Machine Learning</em>, 665–73.
</div>
<div id="ref-densmore2021growth" class="csl-entry">
Densmore, Michael. 2021. <span>“The Growth of Passive Indexing and Smart-Beta: <span>C</span>ompetitive Effects on Actively Managed Funds.”</span> <em>SSRN Working Paper</em> 3823328.
</div>
<div id="ref-dichtl2019optimal" class="csl-entry">
Dichtl, Hubert, Wolfgang Drobetz, Harald Lohre, Carsten Rother, and Patrick Vosskamp. 2019. <span>“Optimal Timing and Tilting of Equity Factors.”</span> <em>Financial Analysts Journal</em> 75 (4): 84–102.
</div>
<div id="ref-dichtl2019data" class="csl-entry">
Dichtl, Hubert, Wolfgang Drobetz, Andreas Neuhierl, and Viktoria-Sophie Wendt. 2020. <span>“Data Snooping in Equity Premium Prediction.”</span> <em>Journal of Forecasting</em> Forthcoming.
</div>
<div id="ref-dichtl2020build" class="csl-entry">
Dichtl, Hubert, Wolfgang Drobetz, and Viktoria-Sophie Wendt. 2020. <span>“How to Build a Factor Portfolio: Does the Allocation Strategy Matter?”</span> <em>European Financial Management</em> Forthcoming.
</div>
<div id="ref-dingli2017financial" class="csl-entry">
Dingli, Alexiei, and Karl Sant Fournier. 2017. <span>“Financial Time Series Forecasting–a Deep Learning Approach.”</span> <em>International Journal of Machine Learning and Computing</em> 7 (5): 118–22.
</div>
<div id="ref-dixon2020industrial" class="csl-entry">
Dixon, Matthew F. 2020. <span>“Industrial Forecasting with Exponentially Smoothed Recurrent Neural Networks.”</span> <em>SSRN Working Paper</em>, no. 3572181.
</div>
<div id="ref-dixon2020machine" class="csl-entry">
Dixon, Matthew F., Igor Halperin, and Paul Bilokon. 2020. <em>Machine Learning in Finance: From Theory to Practice</em>. Springer.
</div>
<div id="ref-donaldson1996forecast" class="csl-entry">
Donaldson, R Glen, and Mark Kamstra. 1996. <span>“Forecast Combining with Neural Networks.”</span> <em>Journal of Forecasting</em> 15 (1): 49–61.
</div>
<div id="ref-drucker1997improving" class="csl-entry">
Drucker, Harris. 1997. <span>“Improving Regressors Using Boosting Techniques.”</span> In <em>International Conference on Machine Learning</em>, 97:107–15.
</div>
<div id="ref-drucker1997support" class="csl-entry">
Drucker, Harris, Christopher JC Burges, Linda Kaufman, Alex J Smola, and Vladimir Vapnik. 1997. <span>“Support Vector Regression Machines.”</span> In <em>Advances in Neural Information Processing Systems</em>, 155–61.
</div>
<div id="ref-du2020deep" class="csl-entry">
Du, Jiayi, Muyang Jin, Petter N Kolm, Gordon Ritter, Yixuan Wang, and Bofei Zhang. 2020. <span>“Deep Reinforcement Learning for Option Replication and Hedging.”</span> <em>Journal of Financial Data Science</em> Forthcoming.
</div>
<div id="ref-du2013neural" class="csl-entry">
Du, Ke-Lin, and Madisetti NS Swamy. 2013. <em>Neural Networks and Statistical Learning</em>. Springer Science &amp; Business Media.
</div>
<div id="ref-dubey2022comprehensive" class="csl-entry">
Dubey, Shiv Ram, Satish Kumar Singh, and Bidyut Baran Chaudhuri. 2022. <span>“A Comprehensive Survey and Performance Analysis of Activation Functions in Deep Learning.”</span> <em>arXiv Preprint</em> 2109.14545.
</div>
<div id="ref-duchi2011adaptive" class="csl-entry">
Duchi, John, Elad Hazan, and Yoram Singer. 2011. <span>“Adaptive Subgradient Methods for Online Learning and Stochastic Optimization.”</span> <em>Journal of Machine Learning Research</em> 12 (Jul): 2121–59.
</div>
<div id="ref-dunis2013hybrid" class="csl-entry">
Dunis, Christian L, Spiros D Likothanassis, Andreas S Karathanasopoulos, Georgios S Sermpinis, and Konstantinos A Theofilatos. 2013. <span>“A Hybrid Genetic Algorithm–Support Vector Machine Approach in the Task of Forecasting and Trading.”</span> <em>Journal of Asset Management</em> 14 (1): 52–71.
</div>
<div id="ref-eakins1998analyzing" class="csl-entry">
Eakins, Stanley G, Stanley R Stansell, and James F Buck. 1998. <span>“Analyzing the Nature of Institutional Demand for Common Stocks.”</span> <em>Quarterly Journal of Business and Economics</em>, 33–48.
</div>
<div id="ref-efimov2019using" class="csl-entry">
Efimov, Dmitry, and Di Xu. 2019. <span>“Using Generative Adversarial Networks to Synthesize Artificial Financial Datasets.”</span> <em>Proceedings of the Conference on Neural Information Processing Systems</em>.
</div>
<div id="ref-ehsani2019factor" class="csl-entry">
Ehsani, Sina, and Juhani T Linnainmaa. 2022. <span>“Factor Momentum and the Momentum Factor.”</span> <em>Journal of Finance</em> Forthcoming.
</div>
<div id="ref-elliott2019detecting" class="csl-entry">
Elliott, Graham, Nikolay Kudrin, and Kaspar Wuthrich. 2019. <span>“Detecting p-Hacking.”</span> <em>arXiv Preprint</em>, no. 1906.06711.
</div>
<div id="ref-elman1990finding" class="csl-entry">
Elman, Jeffrey L. 1990. <span>“Finding Structure in Time.”</span> <em>Cognitive Science</em> 14 (2): 179–211.
</div>
<div id="ref-enders2001primer" class="csl-entry">
Enders, Craig K. 2001. <span>“A Primer on Maximum Likelihood Algorithms Available for Use with Missing Data.”</span> <em>Structural Equation Modeling</em> 8 (1): 128–41.
</div>
<div id="ref-enders2010applied" class="csl-entry">
———. 2010. <em>Applied Missing Data Analysis</em>. Guilford Press.
</div>
<div id="ref-engelberg2018anomalies" class="csl-entry">
Engelberg, Joseph, R David McLean, and Jeffrey Pontiff. 2018. <span>“Anomalies and News.”</span> <em>Journal of Finance</em> 73 (5): 1971–2001.
</div>
<div id="ref-engilberge2019sodeep" class="csl-entry">
Engilberge, Martin, Louis Chevallier, Patrick Pérez, and Matthieu Cord. 2019. <span>“SoDeep: A Sorting Deep Net to Learn Ranking Loss Surrogates.”</span> In <em>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, 10792–801.
</div>
<div id="ref-engle1982autoregressive" class="csl-entry">
Engle, Robert F. 1982. <span>“Autoregressive Conditional Heteroscedasticity with Estimates of the Variance of United Kingdom Inflation.”</span> <em>Econometrica</em>, 987–1007.
</div>
<div id="ref-enke2005use" class="csl-entry">
Enke, David, and Suraphan Thawornwong. 2005. <span>“The Use of Data Mining and Neural Networks for Forecasting Stock Market Returns.”</span> <em>Expert Systems with Applications</em> 29 (4): 927–40.
</div>
<div id="ref-fabozzi2020introduction" class="csl-entry">
Fabozzi, Frank J. 2020. <span>“Introduction: Special Issue on Ethical Investing.”</span> <em>Journal of Portfolio Management</em> 46 (3): 1–4.
</div>
<div id="ref-fabozzi2018being" class="csl-entry">
Fabozzi, Frank J, and Marcos López de Prado. 2018. <span>“Being Honest in Backtest Reporting: A Template for Disclosing Multiple Tests.”</span> <em>Journal of Portfolio Management</em> 45 (1): 141–47.
</div>
<div id="ref-falck2020factor" class="csl-entry">
Falck, Antoine, Adam Rej, and David Thesmar. 2020. <span>“Is Factor Momentum More Than Stock Momentum?”</span> <em>arXiv Preprint</em>, no. 2009.04824.
</div>
<div id="ref-falck2021and" class="csl-entry">
———. 2021. <span>“When Systematic Strategies Decay.”</span> <em>SSRN Working Paper</em> 3845928.
</div>
<div id="ref-fama1992cross" class="csl-entry">
Fama, Eugene F, and Kenneth R French. 1992. <span>“The Cross-Section of Expected Stock Returns.”</span> <em>Journal of Finance</em> 47 (2): 427–65.
</div>
<div id="ref-fama1993common" class="csl-entry">
———. 1993. <span>“Common Risk Factors in the Returns on Stocks and Bonds.”</span> <em>Journal of Financial Economics</em> 33 (1): 3–56.
</div>
<div id="ref-fama2015five" class="csl-entry">
———. 2015. <span>“A Five-Factor Asset Pricing Model.”</span> <em>Journal of Financial Economics</em> 116 (1): 1–22.
</div>
<div id="ref-fama2018choosing" class="csl-entry">
———. 2018. <span>“Choosing Factors.”</span> <em>Journal of Financial Economics</em> 128 (2): 234–52.
</div>
<div id="ref-fama1973risk" class="csl-entry">
Fama, Eugene F, and James D MacBeth. 1973. <span>“Risk, Return, and Equilibrium: Empirical Tests.”</span> <em>Journal of Political Economy</em> 81 (3): 607–36.
</div>
<div id="ref-fan2021reexamination" class="csl-entry">
Fan, Minyou, Youwei Li, Ming Liao, and Jiadong Liu. 2021. <span>“A Reexamination of Factor Momentum: <span>H</span>ow Strong Is It?”</span> <em>SSRN Working Paper</em> 3844484.
</div>
<div id="ref-farmer2019pockets" class="csl-entry">
Farmer, Leland, Lawrence Schmidt, and Allan Timmermann. 2019. <span>“Pockets of Predictability.”</span> <em>SSRN Working Paper</em> 3152386.
</div>
<div id="ref-fastrich2015constructing" class="csl-entry">
Fastrich, Björn, Sandra Paterlini, and Peter Winker. 2015. <span>“Constructing Optimal Sparse Portfolios Using Regularization Methods.”</span> <em>Computational Management Science</em> 12 (3): 417–34.
</div>
<div id="ref-feng2019taming" class="csl-entry">
Feng, Guanhao, Stefano Giglio, and Dacheng Xiu. 2020. <span>“Taming the Factor Zoo: A Test of New Factors.”</span> <em>Journal of Finance</em> 75 (3): 1327–70.
</div>
<div id="ref-feng2021factor" class="csl-entry">
Feng, Guanhao, and Jingyu He. 2021. <span>“Factor Investing: <span>A</span> <span>B</span>ayesian Hierarchical Approach.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-feng2019deep" class="csl-entry">
Feng, Guanhao, Nicholas G Polson, and Jianeng Xu. 2019. <span>“Deep Learning in Characteristics-Sorted Factor Models.”</span> <em>SSRN Working Paper</em> 3243683.
</div>
<div id="ref-ferreira2020reinforced" class="csl-entry">
Ferreira, Tadeu A. 2020. <span>“Reinforced Deep Markov Models with Applications in Automatic Trading.”</span> <em>arXiv Preprint</em>, no. 2011.04391.
</div>
<div id="ref-fischer2018deep" class="csl-entry">
Fischer, Thomas, and Christopher Krauss. 2018. <span>“Deep Learning with Long Short-Term Memory Networks for Financial Market Predictions.”</span> <em>European Journal of Operational Research</em> 270 (2): 654–69.
</div>
<div id="ref-fisher2018all" class="csl-entry">
Fisher, Aaron, Cynthia Rudin, and Francesca Dominici. 2019. <span>“All Models Are Wrong, but Many Are Useful: Learning a Variable’s Importance by Studying an Entire Class of Prediction Models Simultaneously.”</span> <em>Journal of Machine Learning Research</em> 20 (177): 1–81.
</div>
<div id="ref-fister2021two" class="csl-entry">
Fister, Dušan, Matjaž Perc, and Timotej Jagrič. 2021. <span>“Two Robust Long Short-Term Memory Frameworks for Trading Stocks.”</span> <em>Applied Intelligence</em>, 1–19.
</div>
<div id="ref-de2020esg" class="csl-entry">
Franco, Carmine de, Christophe Geissler, Vincent Margot, and Bruno Monnier. 2020. <span>“<span>ESG</span> Investments: Filtering Versus Machine Learning Approaches.”</span> <em>arXiv Preprint</em>, no. 2002.07477.
</div>
<div id="ref-frazier2018tutorial" class="csl-entry">
Frazier, Peter I. 2018. <span>“A Tutorial on <span>B</span>ayesian Optimization.”</span> <em>arXiv Preprint</em>, no. 1807.02811.
</div>
<div id="ref-frazzini2014betting" class="csl-entry">
Frazzini, Andrea, and Lasse Heje Pedersen. 2014. <span>“Betting Against Beta.”</span> <em>Journal of Financial Economics</em> 111 (1): 1–25.
</div>
<div id="ref-freeman1992nonlinear" class="csl-entry">
Freeman, Robert N, and Senyo Y Tse. 1992. <span>“A Nonlinear Model of Security Price Responses to Unexpected Earnings.”</span> <em>Journal of Accounting Research</em>, 185–209.
</div>
<div id="ref-freund1996experiments" class="csl-entry">
Freund, Yoav, and Robert E Schapire. 1996. <span>“Experiments with a New Boosting Algorithm.”</span> In <em>Machine Learning: Proceedings of the Thirteenth International Conference</em>, 96:148–56.
</div>
<div id="ref-freund1997decision" class="csl-entry">
———. 1997. <span>“A Decision-Theoretic Generalization of on-Line Learning and an Application to Boosting.”</span> <em>Journal of Computer and System Sciences</em> 55 (1): 119–39.
</div>
<div id="ref-freyberger2020dissecting" class="csl-entry">
Freyberger, Joachim, Andreas Neuhierl, and Michael Weber. 2020. <span>“Dissecting Characteristics Nonparametrically.”</span> <em>Review of Financial Studies</em> 33 (5): 2326–77.
</div>
<div id="ref-friede2015esg" class="csl-entry">
Friede, Gunnar, Timo Busch, and Alexander Bassen. 2015. <span>“<span>ESG</span> and Financial Performance: Aggregated Evidence from More Than 2000 Empirical Studies.”</span> <em>Journal of Sustainable Finance &amp; Investment</em> 5 (4): 210–33.
</div>
<div id="ref-friedman2001greedy" class="csl-entry">
Friedman, Jerome H. 2001. <span>“Greedy Function Approximation: A Gradient Boosting Machine.”</span> <em>Annals of Statistics</em>, 1189–1232.
</div>
<div id="ref-friedman2002stochastic" class="csl-entry">
———. 2002. <span>“Stochastic Gradient Boosting.”</span> <em>Computational Statistics &amp; Data Analysis</em> 38 (4): 367–78.
</div>
<div id="ref-friedman2008predictive" class="csl-entry">
Friedman, Jerome H, and Bogdan E Popescu. 2008. <span>“Predictive Learning via Rule Ensembles.”</span> <em>Annals of Applied Statistics</em> 2 (3): 916–54.
</div>
<div id="ref-friedman2000additive" class="csl-entry">
Friedman, Jerome, Trevor Hastie, Robert Tibshirani, et al. 2000. <span>“Additive Logistic Regression: A Statistical View of Boosting (with Discussion and a Rejoinder by the Authors).”</span> <em>Annals of Statistics</em> 28 (2): 337–407.
</div>
<div id="ref-friedman2008sparse" class="csl-entry">
Friedman, Jerome, Trevor Hastie, and Robert Tibshirani. 2008. <span>“Sparse Inverse Covariance Estimation with the Graphical Lasso.”</span> <em>Biostatistics</em> 9 (3): 432–41.
</div>
<div id="ref-friedman1997bayesian" class="csl-entry">
Friedman, Nir, Dan Geiger, and Moises Goldszmidt. 1997. <span>“Bayesian Network Classifiers.”</span> <em>Machine Learning</em> 29 (2-3): 131–63.
</div>
<div id="ref-frost1986empirical" class="csl-entry">
Frost, Peter A, and James E Savarino. 1986. <span>“An Empirical Bayes Approach to Efficient Portfolio Selection.”</span> <em>Journal of Financial and Quantitative Analysis</em> 21 (3): 293–305.
</div>
<div id="ref-fu2018machine" class="csl-entry">
Fu, XingYu, JinHong Du, YiFeng Guo, MingWen Liu, Tao Dong, and XiuWen Duan. 2018. <span>“A Machine Learning Framework for Stock Selection.”</span> <em>arXiv Preprint</em>, no. 1806.01743.
</div>
<div id="ref-gaba2017combining" class="csl-entry">
Gaba, Anil, Ilia Tsetlin, and Robert L Winkler. 2017. <span>“Combining Interval Forecasts.”</span> <em>Decision Analysis</em> 14 (1): 1–20.
</div>
<div id="ref-gagliardini2016time" class="csl-entry">
Gagliardini, Patrick, Elisa Ossola, and Olivier Scaillet. 2016. <span>“Time-Varying Risk Premium in Large Cross-Sectional Equity Data Sets.”</span> <em>Econometrica</em> 84 (3): 985–1046.
</div>
<div id="ref-gagliardini2019estimation" class="csl-entry">
———. 2019. <span>“Estimation of Large Dimensional Conditional Factor Models in Finance.”</span> <em>SSRN Working Paper</em> 3443426.
</div>
<div id="ref-galema2008stocks" class="csl-entry">
Galema, Rients, Auke Plantinga, and Bert Scholtens. 2008. <span>“The Stocks at Stake: Return and Risk in Socially Responsible Investment.”</span> <em>Journal of Banking &amp; Finance</em> 32 (12): 2646–54.
</div>
<div id="ref-galili2016splitting" class="csl-entry">
Galili, Tal, and Isaac Meilijson. 2016. <span>“Splitting Matters: How Monotone Transformation of Predictor Variables May Improve the Predictions of Decision Tree Models.”</span> <em>arXiv Preprint</em>, no. 1611.04561.
</div>
<div id="ref-garcia2021factor" class="csl-entry">
Garcia, Conrado, Marcelo C Medeiros, and Ruy M Ribeiro. 2021. <span>“Factor-Driven Lead-Lag Effects and Factor Momentum.”</span> <em>European Financial Management Association Conference Working Paper</em>.
</div>
<div id="ref-garcia2019continuous" class="csl-entry">
Garcı́a-Galicia, Mauricio, Alin A Carsteanu, and Julio B Clempner. 2019. <span>“Continuous-Time Reinforcement Learning Approach for Portfolio Management with Time Penalization.”</span> <em>Expert Systems with Applications</em> 129: 27–36.
</div>
<div id="ref-garcia2009k" class="csl-entry">
Garcı́a-Laencina, Pedro J, José-Luis Sancho-Gómez, Anı́bal R Figueiras-Vidal, and Michel Verleysen. 2009. <span>“K Nearest Neighbours with Mutual Information for Simultaneous Classification and Missing Data Imputation.”</span> <em>Neurocomputing</em> 72 (7-9): 1483–93.
</div>
<div id="ref-geertsema2020cross" class="csl-entry">
Geertsema, Paul, and Helen Lu. 2020. <span>“The Cross-Section of Long-Run Expected Stock Returns.”</span> <em>SSRN Working Paper</em> 3774548.
</div>
<div id="ref-gelman2013bayesian" class="csl-entry">
Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2013. <em>Bayesian Data Analysis, 3rd Edition</em>. Chapman &amp; Hall / CRC.
</div>
<div id="ref-geman1992neural" class="csl-entry">
Geman, Stuart, Elie Bienenstock, and René Doursat. 1992. <span>“Neural Networks and the Bias/Variance Dilemma.”</span> <em>Neural Computation</em> 4 (1): 1–58.
</div>
<div id="ref-genre2013combining" class="csl-entry">
Genre, Véronique, Geoff Kenny, Aidan Meyler, and Allan Timmermann. 2013. <span>“Combining Expert Forecasts: Can Anything Beat the Simple Average?”</span> <em>International Journal of Forecasting</em> 29 (1): 108–21.
</div>
<div id="ref-gentzkow2019text" class="csl-entry">
Gentzkow, Matthew, Bryan Kelly, and Matt Taddy. 2019. <span>“Text as Data.”</span> <em>Journal of Economic Literature</em> 57 (3): 535–74.
</div>
<div id="ref-ghosh2006optimum" class="csl-entry">
Ghosh, Anil K. 2006. <span>“On Optimum Choice of k in Nearest Neighbor Classification.”</span> <em>Computational Statistics &amp; Data Analysis</em> 50 (11): 3113–23.
</div>
<div id="ref-ghosh2021generalization" class="csl-entry">
Ghosh, Dibya, Jad Rahme, Aviral Kumar, Amy Zhang, Ryan P Adams, and Sergey Levine. 2021. <span>“Why Generalization in <span>RL</span> Is Difficult: <span>E</span>pistemic <span>POMDP</span>s and Implicit Partial Observability.”</span> <em>arXiv Preprint</em>, no. 2107.06277.
</div>
<div id="ref-gibson2020responsible" class="csl-entry">
Gibson, Rajna, Simon Glossner, Philipp Krueger, Pedro Matos, and Tom Steffen. 2020. <span>“Responsible Institutional Investing Around the World.”</span> <em>SSRN Working Paper</em> 3525530.
</div>
<div id="ref-giglio2018asset" class="csl-entry">
Giglio, Stefano, and Dacheng Xiu. 2019. <span>“Asset Pricing with Omitted Factors.”</span> <em>SSRN Working Paper</em> 2865922.
</div>
<div id="ref-gomes2003equilibrium" class="csl-entry">
Gomes, Joao, Leonid Kogan, and Lu Zhang. 2003. <span>“Equilibrium Cross Section of Returns.”</span> <em>Journal of Political Economy</em> 111 (4): 693–732.
</div>
<div id="ref-gong2015momentum" class="csl-entry">
Gong, Qiang, Ming Liu, and Qianqiu Liu. 2015. <span>“Momentum Is Really Short-Term Momentum.”</span> <em>Journal of Banking &amp; Finance</em> 50: 169–82.
</div>
<div id="ref-gonzalo2018predictive" class="csl-entry">
Gonzalo, Jesús, and Jean-Yves Pitarakis. 2018. <span>“Predictive Regressions.”</span> In <em>Oxford Research Encyclopedia of Economics and Finance</em>.
</div>
<div id="ref-goodfellow2016deep" class="csl-entry">
Goodfellow, Ian, Yoshua Bengio, Aaron Courville, and Yoshua Bengio. 2016. <em>Deep Learning</em>. MIT Press Cambridge.
</div>
<div id="ref-goodfellow2014generative" class="csl-entry">
Goodfellow, Ian, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio. 2014. <span>“Generative Adversarial Nets.”</span> In <em>Advances in Neural Information Processing Systems</em>, 2672–80.
</div>
<div id="ref-gorishniy2022embeddings" class="csl-entry">
Gorishniy, Yura, Ivan Rubachev, and Artem Babenko. 2022. <span>“On Embeddings for Numerical Features in Tabular Deep Learning.”</span> <em>arXiv Preprint</em>, no. 2203.05556.
</div>
<div id="ref-gospodinov2019too" class="csl-entry">
Gospodinov, Nikolay, Raymond Kan, and Cesare Robotti. 2019. <span>“Too Good to Be True? <span>F</span>allacies in Evaluating Risk Factor Models.”</span> <em>Journal of Financial Economics</em> 132 (2): 451–71.
</div>
<div id="ref-gospodinov2020generalized" class="csl-entry">
Gospodinov, Nikolay, and Esfandiar Maasoumi. 2020. <span>“Generalized Aggregation of Misspecified Models: With an Application to Asset Pricing.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-goto2015improving" class="csl-entry">
Goto, Shingo, and Yan Xu. 2015. <span>“Improving Mean Variance Optimization Through Sparse Hedging Restrictions.”</span> <em>Journal of Financial and Quantitative Analysis</em> 50 (6): 1415–41.
</div>
<div id="ref-gougler2020factor" class="csl-entry">
Gougler, Arnaud, and Sebastian Utz. 2020. <span>“Factor Exposures and Diversification: Are Sustainably-Screened Portfolios Any Different?”</span> <em>Financial Markets and Portfolio Management</em> Forthcoming.
</div>
<div id="ref-gower1971general" class="csl-entry">
Gower, John C. 1971. <span>“A General Coefficient of Similarity and Some of Its Properties.”</span> <em>Biometrics</em>, 857–71.
</div>
<div id="ref-goyal2012empirical" class="csl-entry">
Goyal, Amit. 2012. <span>“Empirical Cross-Sectional Asset Pricing: A Survey.”</span> <em>Financial Markets and Portfolio Management</em> 26 (1): 3–38.
</div>
<div id="ref-goyal2015momentum" class="csl-entry">
Goyal, Amit, and Sunil Wahal. 2015. <span>“Is Momentum an Echo?”</span> <em>Journal of Financial and Quantitative Analysis</em> 50 (6): 1237–67.
</div>
<div id="ref-granger1969investigating" class="csl-entry">
Granger, Clive WJ. 1969. <span>“Investigating Causal Relations by Econometric Models and Cross-Spectral Methods.”</span> <em>Econometrica</em>, 424–38.
</div>
<div id="ref-green2013supraview" class="csl-entry">
Green, Jeremiah, John RM Hand, and X Frank Zhang. 2013. <span>“The Supraview of Return Predictive Signals.”</span> <em>Review of Accounting Studies</em> 18 (3): 692–730.
</div>
<div id="ref-green2017characteristics" class="csl-entry">
———. 2017. <span>“The Characteristics That Provide Independent Information about Average Us Monthly Stock Returns.”</span> <em>Review of Financial Studies</em> 30 (12): 4389–4436.
</div>
<div id="ref-greene2018econometric" class="csl-entry">
Greene, William H. 2018. <em>Econometric Analysis, Eighth Edition</em>. Pearson Education.
</div>
<div id="ref-greenwell2017pdp" class="csl-entry">
Greenwell, Brandon M. 2017. <span>“Pdp: An r Package for Constructing Partial Dependence Plots.”</span> <em>R Journal</em> 9 (1): 421–36.
</div>
<div id="ref-greenwell2020variable" class="csl-entry">
Greenwell, Brandon M, and Bradley C Boehmke. Forthcoming. <span>“Variable Importance Plots: <span>A</span>n Introduction to the Vip Package.”</span> <em>R Journal</em>.
</div>
<div id="ref-greenwood2012share" class="csl-entry">
Greenwood, Robin, and Samuel G Hanson. 2012. <span>“Share Issuance and Factor Timing.”</span> <em>Journal of Finance</em> 67 (2): 761–98.
</div>
<div id="ref-grinblatt2005prospect" class="csl-entry">
Grinblatt, Mark, and Bing Han. 2005. <span>“Prospect Theory, Mental Accounting, and Momentum.”</span> <em>Journal of Financial Economics</em> 78 (2): 311–39.
</div>
<div id="ref-grushka2016ensembles" class="csl-entry">
Grushka-Cockayne, Yael, Victor Richmond R Jose, and Kenneth C Lichtendahl Jr. 2016. <span>“Ensembles of Overfit and Overconfident Forecasts.”</span> <em>Management Science</em> 63 (4): 1110–30.
</div>
<div id="ref-gu2019autoencoder" class="csl-entry">
Gu, Shihao, Bryan T Kelly, and Dacheng Xiu. 2020a. <span>“Autoencoder Asset Pricing Models.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-gu2018empirical" class="csl-entry">
———. 2020b. <span>“Empirical Asset Pricing via Machine Learning.”</span> <em>Review of Financial Studies</em> 33 (5): 2223–73.
</div>
<div id="ref-guida2019big" class="csl-entry">
Guida, Tony, and Guillaume Coqueret. 2018a. <span>“Ensemble Learning Applied to Quant Equity: Gradient Boosting in a Multifactor Framework.”</span> In <em>Big Data and Machine Learning in Quantitative Investment</em>, 129–48. Wiley.
</div>
<div id="ref-guida2018machine" class="csl-entry">
———. 2018b. <span>“Machine Learning in Systematic Equity Allocation: A Model Comparison.”</span> <em>Wilmott</em> 2018 (98): 24–33.
</div>
<div id="ref-guidolin2016ambiguity" class="csl-entry">
Guidolin, Massimo, and Hening Liu. 2016. <span>“Ambiguity Aversion and Underdiversification.”</span> <em>Journal of Financial and Quantitative Analysis</em> 51 (4): 1297–1323.
</div>
<div id="ref-guliyev2018approximation" class="csl-entry">
Guliyev, Namig J, and Vugar E Ismailov. 2018. <span>“On the Approximation by Single Hidden Layer Feedforward Neural Networks with Fixed Weights.”</span> <em>Neural Networks</em> 98: 296–304.
</div>
<div id="ref-guo2020sparse" class="csl-entry">
Guo, Li. 2020. <span>“Sparse Signals in Market Anomalies.”</span> <em>SSRN Working Paper</em> 3683288.
</div>
<div id="ref-gupta2014outlier" class="csl-entry">
Gupta, Manish, Jing Gao, Charu Aggarwal, and Jiawei Han. 2014. <span>“Outlier Detection for Temporal Data.”</span> <em>IEEE Transactions on Knowledge and Data Engineering</em> 26 (9): 2250–67.
</div>
<div id="ref-gupta2019factor" class="csl-entry">
Gupta, Tarun, and Bryan Kelly. 2019. <span>“Factor Momentum Everywhere.”</span> <em>Journal of Portfolio Management</em> 45 (3): 13–36.
</div>
<div id="ref-guresen2011using" class="csl-entry">
Guresen, Erkam, Gulgun Kayakutlu, and Tugrul U Daim. 2011. <span>“Using Artificial Neural Network Models in Stock Market Index Prediction.”</span> <em>Expert Systems with Applications</em> 38 (8): 10389–97.
</div>
<div id="ref-guyon2003introduction" class="csl-entry">
Guyon, Isabelle, and André Elisseeff. 2003. <span>“An Introduction to Variable and Feature Selection.”</span> <em>Journal of Machine Learning Research</em> 3 (Mar): 1157–82.
</div>
<div id="ref-haddad2020economics" class="csl-entry">
Haddad, Valentin, Serhiy Kozak, and Shrihari Santosh. 2020. <span>“Factor Timing.”</span> <em>Review of Financial Studies</em> 33 (5): 1980–2018.
</div>
<div id="ref-hahn2019bayesian" class="csl-entry">
Hahn, P Richard, Jared S Murray, and Carlos Carvalho. 2019. <span>“Bayesian Regression Tree Models for Causal Inference: Regularization, Confounding, and Heterogeneous Effects.”</span> <em>arXiv Preprint</em>, no. 1706.09523.
</div>
<div id="ref-hall2019introduction" class="csl-entry">
Hall, Patrick, and Navdeep Gill. 2019. <em>An Introduction to Machine Learning Interpretability - Second Edition</em>. O’Reilly.
</div>
<div id="ref-hall2008choice" class="csl-entry">
Hall, Peter, Byeong U Park, Richard J Samworth, et al. 2008. <span>“Choice of Neighbor Order in Nearest-Neighbor Classification.”</span> <em>Annals of Statistics</em> 36 (5): 2135–52.
</div>
<div id="ref-halperin2018market" class="csl-entry">
Halperin, Igor, and Ilya Feldshteyn. 2018. <span>“Market Self-Learning of Signals, Impact and Optimal Trading: Invisible Hand Inference with Free Energy.”</span> <em>arXiv Preprint</em>, no. 1805.06126.
</div>
<div id="ref-han2018firm" class="csl-entry">
Han, Yufeng, Ai He, D Rapach, and Guofu Zhou. 2019. <span>“Firm Characteristics and Expected Stock Returns.”</span> <em>SSRN Working Paper</em> 3185335.
</div>
<div id="ref-hanin2018start" class="csl-entry">
Hanin, Boris, and David Rolnick. 2018. <span>“How to Start Training: <span>T</span>he Effect of Initialization and Architecture.”</span> In <em>Advances in Neural Information Processing Systems</em>, 571–81.
</div>
<div id="ref-hansen1982large" class="csl-entry">
Hansen, Lars Peter. 1982. <span>“Large Sample Properties of Generalized Method of Moments Estimators.”</span> <em>Econometrica</em>, 1029–54.
</div>
<div id="ref-harrald1997evolving" class="csl-entry">
Harrald, Paul G, and Mark Kamstra. 1997. <span>“Evolving Artificial Neural Networks to Combine Financial Forecasts.”</span> <em>IEEE Transactions on Evolutionary Computation</em> 1 (1): 40–52.
</div>
<div id="ref-hartzmark2019dividend" class="csl-entry">
Hartzmark, Samuel M, and David H Solomon. 2019. <span>“The Dividend Disconnect.”</span> <em>Journal of Finance</em> 74 (5): 2153–99.
</div>
<div id="ref-harvey2017presidential" class="csl-entry">
Harvey, Campbell R. 2017. <span>“Presidential Address: The Scientific Outlook in Financial Economics.”</span> <em>Journal of Finance</em> 72 (4): 1399–1440.
</div>
<div id="ref-harvey2020replication" class="csl-entry">
———. 2020. <span>“Replication in Financial Economics.”</span> <em>Critical Finance Review</em>, 1–9.
</div>
<div id="ref-harvey2010portfolio" class="csl-entry">
Harvey, Campbell R, John C Liechty, Merrill W Liechty, and Peter Müller. 2010. <span>“Portfolio Selection with Higher Moments.”</span> <em>Quantitative Finance</em> 10 (5): 469–85.
</div>
<div id="ref-harvey2015backtesting" class="csl-entry">
Harvey, Campbell R, and Yan Liu. 2015. <span>“Backtesting.”</span> <em>Journal of Portfolio Management</em> 42 (1): 13–28.
</div>
<div id="ref-harvey2019census" class="csl-entry">
———. 2019. <span>“A Census of the Factor Zoo.”</span> <em>SSRN Working Paper</em> 3341728.
</div>
<div id="ref-harvey2019false" class="csl-entry">
———. 2020. <span>“False (and Missed) Discoveries in Financial Economics.”</span> <em>Journal of Finance</em> Forthcoming.
</div>
<div id="ref-harvey2021uncovering" class="csl-entry">
———. 2021. <span>“Uncovering the Iceberg from Its Tip: <span>A</span> Model of Publication Bias and p-Hacking.”</span> <em>SSRN Working Paper</em> 3865813.
</div>
<div id="ref-harvey2019evaluation" class="csl-entry">
Harvey, Campbell R, Yan Liu, and Alessio Saretto. 2020. <span>“An Evaluation of Alternative Multiple Testing Methods for Finance Applications.”</span> <em>Review of Asset Pricing Studies</em> 10 (2): 199–248.
</div>
<div id="ref-harvey2016and" class="csl-entry">
Harvey, Campbell R, Yan Liu, and Heqing Zhu. 2016. <span>“… and the Cross-Section of Expected Returns.”</span> <em>Review of Financial Studies</em> 29 (1): 5–68.
</div>
<div id="ref-harvey2017lucky" class="csl-entry">
Harvey, Campbell, and Yan Liu. 2019. <span>“Lucky Factors.”</span> <em>SSRN Working Paper</em> 2528780.
</div>
<div id="ref-hasler2019should" class="csl-entry">
Hasler, Michael, Mariana Khapko, and Roberto Marfe. 2019. <span>“Should Investors Learn about the Timing of Equity Risk?”</span> <em>Journal of Financial Economics</em> 132 (3): 182–204.
</div>
<div id="ref-hassan2007fusion" class="csl-entry">
Hassan, Md Rafiul, Baikunth Nath, and Michael Kirley. 2007. <span>“A Fusion Model of HMM, ANN and GA for Stock Market Forecasting.”</span> <em>Expert Systems with Applications</em> 33 (1): 171–80.
</div>
<div id="ref-hastie2020ridge" class="csl-entry">
Hastie, Trevor. 2020. <span>“Ridge Regression: An Essential Concept in Data Science.”</span> <em>arXiv Preprint</em>, no. 2006.00371.
</div>
<div id="ref-friedman2009elements" class="csl-entry">
Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning</em>. Springer.
</div>
<div id="ref-haugen1996commonality" class="csl-entry">
Haugen, Robert A, and Nardin L Baker. 1996. <span>“Commonality in the Determinants of Expected Stock Returns.”</span> <em>Journal of Financial Economics</em> 41 (3): 401–39.
</div>
<div id="ref-haykin2009neural" class="csl-entry">
Haykin, Simon S. 2009. <em>Neural Networks and Learning Machines</em>. Prentice Hall.
</div>
<div id="ref-hazan2016introduction" class="csl-entry">
Hazan, Elad et al. 2016. <span>“Introduction to Online Convex Optimization.”</span> <em>Foundations and Trends<span></span> in Optimization</em> 2 (3-4): 157–325.
</div>
<div id="ref-hazan2007logarithmic" class="csl-entry">
Hazan, Elad, Amit Agarwal, and Satyen Kale. 2007. <span>“Logarithmic Regret Algorithms for Online Convex Optimization.”</span> <em>Machine Learning</em> 69 (2-3): 169–92.
</div>
<div id="ref-he2019factors" class="csl-entry">
He, Ai, Dashan Huang, and Guofu Zhou. 2020. <span>“New Factors Wanted: Evidence from a Simple Specification Test.”</span> <em>SSRN Working Paper</em> 3143752.
</div>
<div id="ref-he2021panel" class="csl-entry">
He, Xin, Lin William Cong, Guanhao Feng, and Jingyu He. 2021. <span>“Asset Pricing with Panel Trees Under Global Split Criteria.”</span> <em>SSRN Working Paper</em> 3949463.
</div>
<div id="ref-head2015extent" class="csl-entry">
Head, Megan L, Luke Holman, Rob Lanfear, Andrew T Kahn, and Michael D Jennions. 2015. <span>“The Extent and Consequences of p-Hacking in Science.”</span> <em>PLoS Biology</em> 13 (3): e1002106.
</div>
<div id="ref-heinze2018invariant" class="csl-entry">
Heinze-Deml, Christina, Jonas Peters, and Nicolai Meinshausen. 2018. <span>“Invariant Causal Prediction for Nonlinear Models.”</span> <em>Journal of Causal Inference</em> 6 (2).
</div>
<div id="ref-henkel2011time" class="csl-entry">
Henkel, Sam James, J Spencer Martin, and Federico Nardari. 2011. <span>“Time-Varying Short-Horizon Predictability.”</span> <em>Journal of Financial Economics</em> 99 (3): 560–80.
</div>
<div id="ref-henrique2019literature" class="csl-entry">
Henrique, Bruno Miranda, Vinicius Amorim Sobreiro, and Herbert Kimura. 2019. <span>“Literature Review: Machine Learning Techniques Applied to Financial Market Prediction.”</span> <em>Expert Systems with Applications</em> 124: 226–51.
</div>
<div id="ref-hiemstra1994testing" class="csl-entry">
Hiemstra, Craig, and Jonathan D Jones. 1994. <span>“Testing for Linear and Nonlinear Granger Causality in the Stock Price-Volume Relation.”</span> <em>Journal of Finance</em> 49 (5): 1639–64.
</div>
<div id="ref-hill2007corporate" class="csl-entry">
Hill, Ronald Paul, Thomas Ainscough, Todd Shank, and Daryl Manullang. 2007. <span>“Corporate Social Responsibility and Socially Responsible Investing: A Global Perspective.”</span> <em>Journal of Business Ethics</em> 70 (2): 165–74.
</div>
<div id="ref-hjalmarsson2011new" class="csl-entry">
Hjalmarsson, Erik. 2011. <span>“New Methods for Inference in Long-Horizon Regressions.”</span> <em>Journal of Financial and Quantitative Analysis</em> 46 (3): 815–39.
</div>
<div id="ref-hjalmarsson2012characteristic" class="csl-entry">
Hjalmarsson, Erik, and Petar Manchev. 2012. <span>“Characteristic-Based Mean-Variance Portfolio Choice.”</span> <em>Journal of Banking &amp; Finance</em> 36 (5): 1392–1401.
</div>
<div id="ref-ho1995random" class="csl-entry">
Ho, Tin Kam. 1995. <span>“Random Decision Forests.”</span> In <em>Proceedings of 3rd International Conference on Document Analysis and Recognition</em>, 1:278–82. IEEE.
</div>
<div id="ref-ho2002simple" class="csl-entry">
Ho, Yu-Chi, and David L Pepyne. 2002. <span>“Simple Explanation of the No-Free-Lunch Theorem and Its Implications.”</span> <em>Journal of Optimization Theory and Applications</em> 115 (3): 549–70.
</div>
<div id="ref-hochreiter1997long" class="csl-entry">
Hochreiter, Sepp, and Jürgen Schmidhuber. 1997. <span>“Long Short-Term Memory.”</span> <em>Neural Computation</em> 9 (8): 1735–80.
</div>
<div id="ref-hodge2004survey" class="csl-entry">
Hodge, Victoria, and Jim Austin. 2004. <span>“A Survey of Outlier Detection Methodologies.”</span> <em>Artificial Intelligence Review</em> 22 (2): 85–126.
</div>
<div id="ref-hodges2017factor" class="csl-entry">
Hodges, Philip, Ked Hogan, Justin R Peterson, and Andrew Ang. 2017. <span>“Factor Timing with Cross-Sectional and Time-Series Predictors.”</span> <em>Journal of Portfolio Management</em> 44 (1): 30–43.
</div>
<div id="ref-hoechle2018correcting" class="csl-entry">
Hoechle, Daniel, Markus Schmid, and Heinz Zimmermann. 2018. <span>“Correcting Alpha Misattribution in Portfolio Sorts.”</span> <em>SSRN Working Paper</em> 3190310.
</div>
<div id="ref-hoi2018online" class="csl-entry">
Hoi, Steven CH, Doyen Sahoo, Jing Lu, and Peilin Zhao. 2018. <span>“Online Learning: A Comprehensive Survey.”</span> <em>arXiv Preprint</em>, no. 1802.02871.
</div>
<div id="ref-honaker2010missing" class="csl-entry">
Honaker, James, and Gary King. 2010. <span>“What to Do about Missing Values in Time-Series Cross-Section Data.”</span> <em>American Journal of Political Science</em> 54 (2): 561–81.
</div>
<div id="ref-hong2020climate" class="csl-entry">
Hong, Harrison, G Andrew Karolyi, and José A Scheinkman. 2020. <span>“Climate Finance.”</span> <em>Review of Financial Studies</em> 33 (3): 1011–23.
</div>
<div id="ref-hong2019climate" class="csl-entry">
Hong, Harrison, Frank Weikai Li, and Jiangmin Xu. 2019. <span>“Climate Risks and Market Efficiency.”</span> <em>Journal of Econometrics</em> 208 (1): 265–81.
</div>
<div id="ref-horel2019towards" class="csl-entry">
Horel, Enguerrand, and Kay Giesecke. 2019. <span>“Towards Explainable <span>AI</span>: <span>S</span>ignificance Tests for Neural Networks.”</span> <em>arXiv Preprint</em>, no. 1902.06021.
</div>
<div id="ref-horenstein2020unintended" class="csl-entry">
Horenstein, Alex R. 2020. <span>“The Unintended Impact of Academic Research on Asset Returns: <span>T</span>he Capital Asset Pricing Model Alpha.”</span> <em>Management Science</em>.
</div>
<div id="ref-hoseinzade2019cnnpred" class="csl-entry">
Hoseinzade, Ehsan, and Saman Haratizadeh. 2019. <span>“CNNpred: <span>CNN</span>-Based Stock Market Prediction Using a Diverse Set of Variables.”</span> <em>Expert Systems with Applications</em> 129: 273–85.
</div>
<div id="ref-hou2015digesting" class="csl-entry">
Hou, Kewei, Chen Xue, and Lu Zhang. 2015. <span>“Digesting Anomalies: An Investment Approach.”</span> <em>Review of Financial Studies</em> 28 (3): 650–705.
</div>
<div id="ref-hou2019replicating" class="csl-entry">
———. 2020. <span>“Replicating Anomalies.”</span> <em>Review of Financial Studies</em> 33 (5): 2019–2133.
</div>
<div id="ref-hsu2018asset" class="csl-entry">
Hsu, Po-Hsuan, Qiheng Han, Wensheng Wu, and Zhiguang Cao. 2018. <span>“Asset Allocation Strategies, Data Snooping, and the 1/n Rule.”</span> <em>Journal of Banking &amp; Finance</em> 97: 257–69.
</div>
<div id="ref-huang2020fundamental" class="csl-entry">
Huang, Dashan, Huacheng Zhang, Guofu Zhou, and Yingzi Zhu. 2020. <span>“Fundamental Extrapolation and Stock Returns.”</span> <em>SSRN Working Paper</em> 3678363.
</div>
<div id="ref-huang2020smart" class="csl-entry">
Huang, Shiyang, Yang Song, and Hong Xiang. 2020. <span>“The Smart Beta Mirage.”</span> <em>SSRN Working Paper</em> 3622753.
</div>
<div id="ref-huang2005forecasting" class="csl-entry">
Huang, Wei, Yoshiteru Nakamori, and Shou-Yang Wang. 2005. <span>“Forecasting Stock Market Movement Direction with Support Vector Machine.”</span> <em>Computers &amp; Operations Research</em> 32 (10): 2513–22.
</div>
<div id="ref-hubner2005generalized" class="csl-entry">
Hübner, Georges. 2005. <span>“The Generalized Treynor Ratio.”</span> <em>Review of Finance</em> 9 (3): 415–35.
</div>
<div id="ref-huck2019large" class="csl-entry">
Huck, Nicolas. 2019. <span>“Large Data Sets and Machine Learning: <span>A</span>pplications to Statistical Arbitrage.”</span> <em>European Journal of Operational Research</em> 278 (1): 330–42.
</div>
<div id="ref-hunermund2019causal" class="csl-entry">
Hünermund, Paul, and Elias Bareinboim. 2019. <span>“Causal Inference and Data-Fusion in Econometrics.”</span> <em>arXiv Preprint</em>, no. 1912.09104.
</div>
<div id="ref-hwang2021bayesian" class="csl-entry">
Hwang, Soosung, and Alexandre Rubesam. 2021. <span>“Bayesian Selection of Asset Pricing Factors Using Individual Stocks.”</span> <em>Journal of Financial Econometrics</em> Forthcoming.
</div>
<div id="ref-hyvarinen2010estimation" class="csl-entry">
Hyvärinen, Aapo, Kun Zhang, Shohei Shimizu, and Patrik O Hoyer. 2010. <span>“Estimation of a Structural Vector Autoregression Model Using Non-Gaussianity.”</span> <em>Journal of Machine Learning Research</em> 11 (5).
</div>
<div id="ref-ilmanen2011expected" class="csl-entry">
Ilmanen, Antti. 2011. <em>Expected Returns: An Investor’s Guide to Harvesting Market Rewards</em>. John Wiley &amp; Sons.
</div>
<div id="ref-ilmanen2019factor" class="csl-entry">
Ilmanen, Antti, Ronen Israel, Tobias J Moskowitz, Ashwin K Thapar, and Franklin Wang. 2019. <span>“Factor Premia and Factor Timing: A Century of Evidence.”</span> <em>SSRN Working Paper</em> 3400998.
</div>
<div id="ref-israel2020systematic" class="csl-entry">
Israel, Ronen, Kristoffer Laursen, and Scott Richardson. 2020. <span>“Is (Systematic) Value Investing Dead?”</span> <em>Journal of Portfolio Management</em> 47 (2): 38–62.
</div>
<div id="ref-jacobs2019anomalies" class="csl-entry">
Jacobs, Heiko, and Sebastian Müller. 2020. <span>“Anomalies Across the Globe: Once Public, No Longer Existent?”</span> <em>Journal of Financial Economics</em> 135 (1): 213–30.
</div>
<div id="ref-jacobs1991adaptive" class="csl-entry">
Jacobs, Robert A, Michael I Jordan, Steven J Nowlan, Geoffrey E Hinton, et al. 1991. <span>“Adaptive Mixtures of Local Experts.”</span> <em>Neural Computation</em> 3 (1): 79–87.
</div>
<div id="ref-jagannathan2003risk" class="csl-entry">
Jagannathan, Ravi, and Tongshu Ma. 2003. <span>“Risk Reduction in Large Portfolios: Why Imposing the Wrong Constraints Helps.”</span> <em>Journal of Finance</em> 58 (4): 1651–83.
</div>
<div id="ref-jagannathan1998asymptotic" class="csl-entry">
Jagannathan, Ravi, and Zhenyu Wang. 1998. <span>“An Asymptotic Theory for Estimating Beta-Pricing Models Using Cross-Sectional Regression.”</span> <em>Journal of Finance</em> 53 (4): 1285–1309.
</div>
<div id="ref-james2013introduction" class="csl-entry">
James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2013. <em>An Introduction to Statistical Learning</em>. Vol. 112. Springer.
</div>
<div id="ref-jegadeesh2019empirical" class="csl-entry">
Jegadeesh, Narasimhan, Joonki Noh, Kuntara Pukthuanthong, Richard Roll, and Junbo L Wang. 2019. <span>“Empirical Tests of Asset Pricing Models with Individual Assets: Resolving the Errors-in-Variables Bias in Risk Premium Estimation.”</span> <em>Journal of Financial Economics</em> 133 (2): 273–98.
</div>
<div id="ref-jegadeesh1993returns" class="csl-entry">
Jegadeesh, Narasimhan, and Sheridan Titman. 1993. <span>“Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency.”</span> <em>Journal of Finance</em> 48 (1): 65–91.
</div>
<div id="ref-jensen1968performance" class="csl-entry">
Jensen, Michael C. 1968. <span>“The Performance of Mutual Funds in the Period 1945–1964.”</span> <em>Journal of Finance</em> 23 (2): 389–416.
</div>
<div id="ref-jha2019implementing" class="csl-entry">
Jha, Vinesh. 2019. <span>“Implementing Alternative Data in an Investment Process.”</span> In <em>Big Data and Machine Learning in Quantitative Investment</em>, 51–74. Wiley.
</div>
<div id="ref-jiang2020re" class="csl-entry">
Jiang, Jingwen, Bryan Kelly, and Dacheng Xiu. 2020. <span>“(Re-)Imag(in)ing Price Trends.”</span> <em>SSRN Working Paper</em> 3756587.
</div>
<div id="ref-jiang2020applications" class="csl-entry">
Jiang, Weiwei. 2020. <span>“Applications of Deep Learning in Stock Market Prediction: Recent Progress.”</span> <em>arXiv Preprint</em>, no. 2003.01859.
</div>
<div id="ref-jiang2017deep" class="csl-entry">
Jiang, Zhengyao, Dixing Xu, and Jinjun Liang. 2017. <span>“A Deep Reinforcement Learning Framework for the Financial Portfolio Management Problem.”</span> <em>arXiv Preprint</em>, no. 1706.10059.
</div>
<div id="ref-jin2019drivers" class="csl-entry">
Jin, Dunhong. 2019. <span>“The Drivers and Inhibitors of Factor Investing.”</span> <em>SSRN Working Paper</em>, no. 3492142.
</div>
<div id="ref-johannesson2020explanatory" class="csl-entry">
Johannesson, Erik, James A Ohlson, and Weihuan Zhai. 2020. <span>“The Explanatory Power of Explanatory Variables.”</span> <em>SSRN Working Paper</em> 3622743.
</div>
<div id="ref-johnson2002rational" class="csl-entry">
Johnson, Timothy C. 2002. <span>“Rational Momentum Effects.”</span> <em>Journal of Finance</em> 57 (2): 585–608.
</div>
<div id="ref-johnson2019fresh" class="csl-entry">
Johnson, Travis L. 2019. <span>“A Fresh Look at Return Predictability Using a More Efficient Estimator.”</span> <em>Review of Asset Pricing Studies</em> 9 (1): 1–46.
</div>
<div id="ref-jordan1997serial" class="csl-entry">
Jordan, Michael I. 1997. <span>“Serial Order: A Parallel Distributed Processing Approach.”</span> In <em>Advances in Psychology</em>, 121:471–95.
</div>
<div id="ref-jorion1985international" class="csl-entry">
Jorion, Philippe. 1985. <span>“International Portfolio Diversification with Estimation Risk.”</span> <em>Journal of Business</em>, 259–78.
</div>
<div id="ref-jurczenko2017factor" class="csl-entry">
Jurczenko, Emmanuel. 2017. <em>Factor Investing: From Traditional to Alternative Risk Premia</em>. Elsevier.
</div>
<div id="ref-kagkadis2021factor" class="csl-entry">
Kagkadis, Anastasios, Ingmar Nolte, Nikolaos Vasilas, et al. 2021. <span>“Factor Timing with Portfolio Characteristics.”</span> <em>SSRN Working Paper</em> 3955838.
</div>
<div id="ref-kalisch2012causal" class="csl-entry">
Kalisch, Markus, Martin Mächler, Diego Colombo, Marloes H Maathuis, Peter Bühlmann, et al. 2012. <span>“Causal Inference Using Graphical Models with the r Package Pcalg.”</span> <em>Journal of Statistical Software</em> 47 (11): 1–26.
</div>
<div id="ref-kan2007optimal" class="csl-entry">
Kan, Raymond, and Guofu Zhou. 2007. <span>“Optimal Portfolio Choice with Parameter Uncertainty.”</span> <em>Journal of Financial and Quantitative Analysis</em> 42 (3): 621–56.
</div>
<div id="ref-kang2021crowding" class="csl-entry">
Kang, Wenjin, K Geert Rouwenhorst, and Ke Tang. 2021. <span>“Crowding and Factor Returns.”</span> <em>SSRN Working Paper</em> 3803954.
</div>
<div id="ref-karpe2020multi" class="csl-entry">
Karpe, Michaël, Jin Fang, Zhongyao Ma, and Chen Wang. 2020. <span>“Multi-Agent Reinforcement Learning in a Realistic Limit Order Book Market Simulation.”</span> <em>arXiv Preprint</em>, no. 2006.05574.
</div>
<div id="ref-ke2017lightgbm" class="csl-entry">
Ke, Guolin, Qi Meng, Thomas Finley, Taifeng Wang, Wei Chen, Weidong Ma, Qiwei Ye, and Tie-Yan Liu. 2017. <span>“Lightgbm: A Highly Efficient Gradient Boosting Decision Tree.”</span> In <em>Advances in Neural Information Processing Systems</em>, 3146–54.
</div>
<div id="ref-ke2019predicting" class="csl-entry">
Ke, Zheng Tracy, Bryan T Kelly, and Dacheng Xiu. 2019. <span>“Predicting Returns with Text Data.”</span> <em>SSRN Working Paper</em> 3388293.
</div>
<div id="ref-kearns2013machine" class="csl-entry">
Kearns, Michael, and Yuriy Nevmyvaka. 2013. <span>“Machine Learning for Market Microstructure and High Frequency Trading.”</span> <em>High Frequency Trading: New Realities for Traders, Markets, and Regulators</em>.
</div>
<div id="ref-kelly2019characteristics" class="csl-entry">
Kelly, Bryan T, Seth Pruitt, and Yinan Su. 2019. <span>“Characteristics Are Covariances: A Unified Model of Risk and Return.”</span> <em>Journal of Financial Economics</em> 134 (3): 501–24.
</div>
<div id="ref-kempf2007effect" class="csl-entry">
Kempf, Alexander, and Peer Osthoff. 2007. <span>“The Effect of Socially Responsible Investing on Portfolio Performance.”</span> <em>European Financial Management</em> 13 (5): 908–22.
</div>
<div id="ref-khedmati2020online" class="csl-entry">
Khedmati, Majid, and Pejman Azin. 2020. <span>“An Online Portfolio Selection Algorithm Using Clustering Approaches and Considering Transaction Costs.”</span> <em>Expert Systems with Applications</em> Forthcoming: 113546.
</div>
<div id="ref-kim2003financial" class="csl-entry">
Kim, Kyoung-jae. 2003. <span>“Financial Time Series Forecasting Using Support Vector Machines.”</span> <em>Neurocomputing</em> 55 (1-2): 307–19.
</div>
<div id="ref-kim2019arbitrage" class="csl-entry">
Kim, Soohun, Robert A Korajczyk, and Andreas Neuhierl. 2019. <span>“Arbitrage Portfolios.”</span> <em>SSRN Working Paper</em> 3263001.
</div>
<div id="ref-kim2014deciphering" class="csl-entry">
Kim, Woo Chang, Jang Ho Kim, and Frank J Fabozzi. 2014. <span>“Deciphering Robust Portfolios.”</span> <em>Journal of Banking &amp; Finance</em> 45: 1–8.
</div>
<div id="ref-kimoto1990stock" class="csl-entry">
Kimoto, Takashi, Kazuo Asakawa, Morio Yoda, and Masakazu Takeoka. 1990. <span>“Stock Market Prediction System with Modular Neural Networks.”</span> In <em>1990 IJCNN International Joint Conference on Neural Networks</em>, 1–6. IEEE.
</div>
<div id="ref-kingma2014adam" class="csl-entry">
Kingma, Diederik P, and Jimmy Ba. 2014. <span>“Adam: A Method for Stochastic Optimization.”</span> <em>arXiv Preprint</em>, no. 1412.6980.
</div>
<div id="ref-kirby2020firm" class="csl-entry">
Kirby, Chris. 2020. <span>“Firm Characteristics, Stock Market Regimes, and the Cross-Section of Expected Returns.”</span> <em>SSRN Working Paper</em> 3520131.
</div>
<div id="ref-koijen2019demand" class="csl-entry">
Koijen, Ralph S. J., and Motohiro Yogo. 2019. <span>“A Demand System Approach to Asset Pricing.”</span> <em>Journal of Political Economy</em> 127 (4): 1475–515.
</div>
<div id="ref-koijen2019investors" class="csl-entry">
Koijen, Ralph SJ, Robert J Richmond, and Motohiro Yogo. 2019. <span>“Which Investors Matter for Global Equity Valuations and Expected Returns?”</span> <em>SSRN Working Paper</em> 3378340.
</div>
<div id="ref-kolm2019dynamic" class="csl-entry">
Kolm, Petter N, and Gordon Ritter. 2019a. <span>“Dynamic Replication and Hedging: A Reinforcement Learning Approach.”</span> <em>Journal of Financial Data Science</em> 1 (1): 159–71.
</div>
<div id="ref-kolm2019modern" class="csl-entry">
———. 2019b. <span>“Modern Perspectives on Reinforcement Learning in Finance.”</span> <em>Journal of Machine Learning in Finance</em> 1 (1).
</div>
<div id="ref-kong2019new" class="csl-entry">
Kong, Weiwei, Christopher Liaw, Aranyak Mehta, and D Sivakumar. 2019. <span>“A New Dog Learns Old Tricks: RL Finds Classic Optimization Algorithms.”</span> <em>Proceedings of the ICLR Conference</em>, 1–25.
</div>
<div id="ref-koshiyama2020quantnet" class="csl-entry">
Koshiyama, Adriano, Sebastian Flennerhag, Stefano B Blumberg, Nick Firoozye, and Philip Treleaven. 2020. <span>“QuantNet: Transferring Learning Across Systematic Trading Strategies.”</span> <em>arXiv Preprint</em>, no. 2004.03445.
</div>
<div id="ref-kozak2018interpreting" class="csl-entry">
Kozak, Serhiy, Stefan Nagel, and Shrihari Santosh. 2018. <span>“Interpreting Factor Models.”</span> <em>Journal of Finance</em> 73 (3): 1183–223.
</div>
<div id="ref-kozak2019shrinking" class="csl-entry">
———. 2019. <span>“Shrinking the Cross-Section.”</span> <em>Journal of Financial Economics</em> 135: 271–92.
</div>
<div id="ref-krauss2017deep" class="csl-entry">
Krauss, Christopher, Xuan Anh Do, and Nicolas Huck. 2017. <span>“Deep Neural Networks, Gradient-Boosted Trees, Random Forests: Statistical Arbitrage on the s&amp;p 500.”</span> <em>European Journal of Operational Research</em> 259 (2): 689–702.
</div>
<div id="ref-kremer2019sparse" class="csl-entry">
Kremer, Philipp J, Sangkyun Lee, Małgorzata Bogdan, and Sandra Paterlini. 2019. <span>“Sparse Portfolio Selection via the Sorted L1-Norm.”</span> <em>Journal of Banking &amp; Finance</em>, 105687.
</div>
<div id="ref-krkoska2019herding" class="csl-entry">
Krkoska, Eduard, and Klaus Reiner Schenk-Hoppé. 2019. <span>“Herding in Smart-Beta Investment Products.”</span> <em>Journal of Risk and Financial Management</em> 12 (1): 47.
</div>
<div id="ref-kruschke2014doing" class="csl-entry">
Kruschke, John. 2014. <em>Doing Bayesian Data Analysis: A Tutorial with r, JAGS, and Stan (2nd Ed.)</em>. Academic Press.
</div>
<div id="ref-kuhn2019feature" class="csl-entry">
Kuhn, Max, and Kjell Johnson. 2019. <em>Feature Engineering and Selection: A Practical Approach for Predictive Models</em>. CRC Press.
</div>
<div id="ref-kurtz2020three" class="csl-entry">
Kurtz, Lloyd. 2020. <span>“Three Pillars of Modern Responsible Investment.”</span> <em>Journal of Investing</em> 29 (2): 21–32.
</div>
<div id="ref-lai2011mean" class="csl-entry">
Lai, Tze Leung, Haipeng Xing, Zehao Chen, et al. 2011. <span>“Mean–Variance Portfolio Optimization When Means and Covariances Are Unknown.”</span> <em>Annals of Applied Statistics</em> 5 (2A): 798–823.
</div>
<div id="ref-lakonishok1994contrarian" class="csl-entry">
Lakonishok, Josef, Andrei Shleifer, and Robert W Vishny. 1994. <span>“Contrarian Investment, Extrapolation, and Risk.”</span> <em>Journal of Finance</em> 49 (5): 1541–78.
</div>
<div id="ref-leary2011determinants" class="csl-entry">
Leary, Mark T, and Roni Michaely. 2011. <span>“Determinants of Dividend Smoothing: Empirical Evidence.”</span> <em>Review of Financial Studies</em> 24 (10): 3197–3249.
</div>
<div id="ref-ledoit2008robust" class="csl-entry">
Ledoit, Oliver, and Michael Wolf. 2008. <span>“Robust Performance Hypothesis Testing with the Sharpe Ratio.”</span> <em>Journal of Empirical Finance</em> 15 (5): 850–59.
</div>
<div id="ref-ledoit2004well" class="csl-entry">
Ledoit, Olivier, and Michael Wolf. 2004. <span>“A Well-Conditioned Estimator for Large-Dimensional Covariance Matrices.”</span> <em>Journal of Multivariate Analysis</em> 88 (2): 365–411.
</div>
<div id="ref-ledoit2017nonlinear" class="csl-entry">
———. 2017. <span>“Nonlinear Shrinkage of the Covariance Matrix for Portfolio Selection: Markowitz Meets Goldilocks.”</span> <em>Review of Financial Studies</em> 30 (12): 4349–88.
</div>
<div id="ref-ledoit2018efficient" class="csl-entry">
Ledoit, Olivier, Michael Wolf, and Zhao Zhao. 2020. <span>“Efficient Sorting: A More Powerful Test for Cross-Sectional Anomalies.”</span> <em>Journal of Financial Econometrics</em> 17 (4): 645–86.
</div>
<div id="ref-lee2022lasso" class="csl-entry">
Lee, Ji Hyung, Zhentao Shi, and Zhan Gao. 2022. <span>“On <span>LASSO</span> for Predictive Regression.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-lee2020hyperparameter" class="csl-entry">
Lee, Sang Il. 2020. <span>“Hyperparameter Optimization for Forecasting Stock Returns.”</span> <em>arXiv Preprint</em>, no. 2001.10278.
</div>
<div id="ref-legendre1805nouvelles" class="csl-entry">
Legendre, Adrien Marie. 1805. <em>Nouvelles m<span>é</span>thodes Pour La d<span>é</span>termination Des Orbites Des Com<span>è</span>tes</em>. F. Didot.
</div>
<div id="ref-leippold2020fama" class="csl-entry">
Leippold, Markus, and Roger Rüegg. 2020. <span>“Fama–French Factor Timing: The Long-Only Integrated Approach.”</span> <em>SSRN Working Paper</em> 3410972.
</div>
<div id="ref-leippold2021anatomy" class="csl-entry">
Leippold, Markus, and Hanlin Yang. 2021. <span>“The Anatomy of Factor Momentum.”</span> <em>SSRN Working Paper</em>.
</div>
<div id="ref-lemperiere2014two" class="csl-entry">
Lempérière, Yves, Cyril Deremble, Philip Seager, Marc Potters, and Jean-Philippe Bouchaud. 2014. <span>“Two Centuries of Trend Following.”</span> <em>arXiv Preprint</em>, no. 1404.3274.
</div>
<div id="ref-lettau2018estimating" class="csl-entry">
Lettau, Martin, and Markus Pelger. 2020a. <span>“Estimating Latent Asset-Pricing Factors.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-lettau2018factors" class="csl-entry">
———. 2020b. <span>“Factors That Fit the Time Series and Cross-Section of Stock Returns.”</span> <em>Review of Financial Studies</em> 33 (5): 2274–2325.
</div>
<div id="ref-leung2001using" class="csl-entry">
Leung, Mark T, Hazem Daouk, and An-Sing Chen. 2001. <span>“Using Investment Portfolio Return to Combine Forecasts: A Multiobjective Approach.”</span> <em>European Journal of Operational Research</em> 134 (1): 84–102.
</div>
<div id="ref-li2014online" class="csl-entry">
Li, Bin, and Steven CH Hoi. 2014. <span>“Online Portfolio Selection: A Survey.”</span> <em>ACM Computing Surveys (CSUR)</em> 46 (3): 35.
</div>
<div id="ref-li2018online" class="csl-entry">
Li, Bin, and Steven Chu Hong Hoi. 2018. <em>Online Portfolio Selection: Principles and Algorithms</em>. CRC Press.
</div>
<div id="ref-li2020conditional" class="csl-entry">
Li, Jia, Zhipeng Liao, and Rogier Quaedvlieg. 2020. <span>“Conditional Superior Predictive Ability.”</span> <em>SSRN Working Paper</em> 3536461.
</div>
<div id="ref-li2020factors" class="csl-entry">
Li, Sicong Allen, Victor DeMiguel, and Alberto Martin-Utrera. 2020. <span>“Which Factors with Price-Impact Costs?”</span> <em>SSRN Working Paper</em> 3688484.
</div>
<div id="ref-lim2020time" class="csl-entry">
Lim, Bryan, and Stefan Zohren. 2021. <span>“Time Series Forecasting with Deep Learning: A Survey.”</span> <em>Philosophical Transactions of the Royal Society A</em> 379 (2194): 20200209.
</div>
<div id="ref-linnainmaa2018history" class="csl-entry">
Linnainmaa, Juhani T, and Michael R Roberts. 2018. <span>“The History of the Cross-Section of Stock Returns.”</span> <em>Review of Financial Studies</em> 31 (7): 2606–49.
</div>
<div id="ref-lintner1965valuation" class="csl-entry">
Lintner, John. 1965. <span>“The Valuation of Risk Assets and the Selection of Risky Investments in Stock Portfolios and Capital Budgets.”</span> <em>Review of Economics and Statistics</em> 47 (1): 13–37.
</div>
<div id="ref-lioui2018esg" class="csl-entry">
Lioui, Abraham. 2018. <span>“<span>ESG</span> Factor Investing: Myth or Reality?”</span> <em>SSRN Working Paper</em> 3272090.
</div>
<div id="ref-lioui2020factor" class="csl-entry">
Lioui, Abraham, and Andrea Tarelli. 2020. <span>“Factor Investing for the Long Run.”</span> <em>SSRN Working Paper</em> 3531946.
</div>
<div id="ref-little2014statistical" class="csl-entry">
Little, Roderick JA, and Donald B Rubin. 2014. <em>Statistical Analysis with Missing Data</em>. Vol. 333. John Wiley &amp; Sons.
</div>
<div id="ref-liu2020can" class="csl-entry">
Liu, Li, Zhiyuan Pan, and Yudong Wang. 2020. <span>“What Can We Learn from the Return Predictability over Business Cycle?”</span> <em>Journal of Forecasting</em> Forthcoming.
</div>
<div id="ref-lo1990contrarian" class="csl-entry">
Lo, Andrew W, and A Craig MacKinlay. 1990. <span>“When Are Contrarian Profits Due to Stock Market Overreaction?”</span> <em>Review of Financial Studies</em> 3 (2): 175–205.
</div>
<div id="ref-lopez2020false" class="csl-entry">
Lopez de Prado, Marcos, and David H Bailey. 2020. <span>“The False Strategy Theorem: <span>A</span> Financial Application of Experimental Mathematics.”</span> <em>American Mathematical Monthly</em> Forthcoming.
</div>
<div id="ref-loreggia2016deep" class="csl-entry">
Loreggia, Andrea, Yuri Malitsky, Horst Samulowitz, and Vijay Saraswat. 2016. <span>“Deep Learning for Algorithm Portfolios.”</span> In <em>Proceedings of the Thirtieth AAAI Conference on Artificial Intelligence</em>, 1280–86. AAAI Press.
</div>
<div id="ref-loughran2016textual" class="csl-entry">
Loughran, Tim, and Bill McDonald. 2016. <span>“Textual Analysis in Accounting and Finance: A Survey.”</span> <em>Journal of Accounting Research</em> 54 (4): 1187–1230.
</div>
<div id="ref-lundberg2017unified" class="csl-entry">
Lundberg, Scott M, and Su-In Lee. 2017. <span>“A Unified Approach to Interpreting Model Predictions.”</span> In <em>Advances in Neural Information Processing Systems</em>, 4765–74.
</div>
<div id="ref-luo2020momentum" class="csl-entry">
Luo, Jiang, Avanidhar Subrahmanyam, and Sheridan Titman. 2020. <span>“Momentum and Reversals When Overconfident Investors Underestimate Their Competition.”</span> <em>Review of Financial Studies</em> Forthcoming.
</div>
<div id="ref-ma2018testing" class="csl-entry">
Ma, Shujie, Wei Lan, Liangjun Su, and Chih-Ling Tsai. 2020. <span>“Testing Alphas in Conditional Time-Varying Factor Models with High Dimensional Assets.”</span> <em>Journal of Business &amp; Economic Statistics</em> 38 (1): 214–27.
</div>
<div id="ref-ma2020portfolio" class="csl-entry">
Ma, Yilin, Ruizhu Han, and Weizhong Wang. 2020. <span>“Portfolio Optimization with Return Prediction Using Deep Learning and Machine Learning.”</span> <em>Expert Systems with Applications</em> Forthcoming: 113973.
</div>
<div id="ref-maathuis2018handbook" class="csl-entry">
Maathuis, Marloes, Mathias Drton, Steffen Lauritzen, and Martin Wainwright. 2018. <em>Handbook of Graphical Models</em>. CRC Press.
</div>
<div id="ref-maclaurin2015gradient" class="csl-entry">
Maclaurin, Dougal, David Duvenaud, and Ryan Adams. 2015. <span>“Gradient-Based Hyperparameter Optimization Through Reversible Learning.”</span> In <em>International Conference on Machine Learning</em>, 2113–22.
</div>
<div id="ref-maillard2010properties" class="csl-entry">
Maillard, Sébastien, Thierry Roncalli, and Jérôme Teiletche. 2010. <span>“The Properties of Equally Weighted Risk Contribution Portfolios.”</span> <em>Journal of Portfolio Management</em> 36 (4): 60–70.
</div>
<div id="ref-maillet2015global" class="csl-entry">
Maillet, Bertrand, Sessi Tokpavi, and Benoit Vaucher. 2015. <span>“Global Minimum Variance Portfolio Optimisation Under Some Model Risk: A Robust Regression-Based Approach.”</span> <em>European Journal of Operational Research</em> 244 (1): 289–99.
</div>
<div id="ref-mailund2019pipelines" class="csl-entry">
Mailund, Thomas. 2019. <span>“Pipelines: Magrittr.”</span> In <em>R Data Science Quick Reference</em>, 71–81. Springer.
</div>
<div id="ref-markowitz1952portfolio" class="csl-entry">
Markowitz, Harry. 1952. <span>“Portfolio Selection.”</span> <em>Journal of Finance</em> 7 (1): 77–91.
</div>
<div id="ref-marti2019corrgan" class="csl-entry">
Marti, Gautier. 2019. <span>“CorrGAN: Sampling Realistic Financial Correlation Matrices Using Generative Adversarial Networks.”</span> <em>arXiv Preprint</em>, no. 1910.09504.
</div>
<div id="ref-martin2019bayesian" class="csl-entry">
Martin, Evan A, and Audrey Qiuyan Fu. 2019. <span>“A Bayesian Approach to Directed Acyclic Graphs with a Candidate Graph.”</span> <em>arXiv Preprint</em>, no. 1909.10678.
</div>
<div id="ref-martin2019market" class="csl-entry">
Martin, Ian, and Stefan Nagel. 2019. <span>“Market Efficiency in the Age of Big Data.”</span> <em>SSRN Working Paper</em> 3511296.
</div>
<div id="ref-martins2016softmax" class="csl-entry">
Martins, Andre, and Ramon Astudillo. 2016. <span>“From Softmax to Sparsemax: <span>A</span> Sparse Model of Attention and Multi-Label Classification.”</span> In <em>International Conference on Machine Learning</em>, 1614–23.
</div>
<div id="ref-mascio2020market" class="csl-entry">
Mascio, David A, Frank J Fabozzi, and J Kenton Zumwalt. 2020. <span>“Market Timing Using Combined Forecasts and Machine Learning.”</span> <em>Journal of Forecasting</em> Forthcoming.
</div>
<div id="ref-mason2000boosting" class="csl-entry">
Mason, Llew, Jonathan Baxter, Peter L Bartlett, and Marcus R Frean. 2000. <span>“Boosting Algorithms as Gradient Descent.”</span> In <em>Advances in Neural Information Processing Systems</em>, 512–18.
</div>
<div id="ref-masters1993practical" class="csl-entry">
Masters, Timothy. 1993. <em>Practical Neural Network Recipes in <span>C</span>++</em>. Morgan Kaufmann.
</div>
<div id="ref-matias2012forecasting" class="csl-entry">
Matı́as, José M, and Juan C Reboredo. 2012. <span>“Forecasting Performance of Nonlinear Models for Intraday Stock Returns.”</span> <em>Journal of Forecasting</em> 31 (2): 172–88.
</div>
<div id="ref-mcgee2020optimal" class="csl-entry">
McGee, Richard, and Jose Olmo. 2020. <span>“Optimal Characteristic Portfolios.”</span> <em>SSRN Working Paper</em> 3638177.
</div>
<div id="ref-mclean2016does" class="csl-entry">
McLean, R David, and Jeffrey Pontiff. 2016. <span>“Does Academic Research Destroy Stock Return Predictability?”</span> <em>Journal of Finance</em> 71 (1): 5–32.
</div>
<div id="ref-meng2019reinforcement" class="csl-entry">
Meng, Terry Lingze, and Matloob Khushi. 2019. <span>“Reinforcement Learning in Financial Markets.”</span> <em>Data</em> 4 (3): 110.
</div>
<div id="ref-metropolis1949monte" class="csl-entry">
Metropolis, Nicholas, and Stanislaw Ulam. 1949. <span>“The <span>M</span>onte <span>C</span>arlo Method.”</span> <em>Journal of the American Statistical Association</em> 44 (247): 335–41.
</div>
<div id="ref-meyer2000matrix" class="csl-entry">
Meyer, Carl D. 2000. <em>Matrix Analysis and Applied Linear Algebra</em>. Vol. 71. SIAM.
</div>
<div id="ref-michaelides2020large" class="csl-entry">
Michaelides, Michael. 2020. <span>“Large Sample Size Bias in Empirical Finance.”</span> <em>Finance Research Letters</em> Forthcoming.
</div>
<div id="ref-moehle2021portfolio" class="csl-entry">
Moehle, Nicholas, Stephen Boyd, and Andrew Ang. 2021. <span>“Portfolio Performance Attribution via <span>S</span>hapley Value.”</span> <em>arXiv Preprint</em>, no. 2102.05799.
</div>
<div id="ref-mohri2018foundations" class="csl-entry">
Mohri, Mehryar, Afshin Rostamizadeh, and Ameet Talwalkar. 2018. <em>Foundations of Machine Learning</em>. MIT Press.
</div>
<div id="ref-molnar2019interpretable" class="csl-entry">
Molnar, Christoph. 2019. <em>Interpretable Machine Learning: A Guide for Making Black Box Models Explainable</em>. LeanPub / Lulu.
</div>
<div id="ref-molnar2018iml" class="csl-entry">
Molnar, Christoph, Giuseppe Casalicchio, and Bernd Bischl. 2018. <span>“Iml: An r Package for Interpretable Machine Learning.”</span> <em>Journal of Open Source Software</em> 3 (27): 786.
</div>
<div id="ref-moody1997optimization" class="csl-entry">
Moody, John, and Lizhong Wu. 1997. <span>“Optimization of Trading Systems and Portfolios.”</span> In <em>Proceedings of the IEEE/IAFE 1997 Computational Intelligence for Financial Engineering (CIFEr)</em>, 300–307. IEEE.
</div>
<div id="ref-moody1998performance" class="csl-entry">
Moody, John, Lizhong Wu, Yuansong Liao, and Matthew Saffell. 1998. <span>“Performance Functions and Reinforcement Learning for Trading Systems and Portfolios.”</span> <em>Journal of Forecasting</em> 17 (5-6): 441–70.
</div>
<div id="ref-moritz2016tree" class="csl-entry">
Moritz, Benjamin, and Tom Zimmermann. 2016. <span>“Tree-Based Conditional Portfolio Sorts: The Relation Between Past and Future Stock Returns.”</span> <em>SSRN Working Paper</em> 2740751.
</div>
<div id="ref-mosavi2020comprehensive" class="csl-entry">
Mosavi, Amir, Pedram Ghamisi, Yaser Faghan, Puhong Duan, and Shahab Shamshirband. 2020. <span>“Comprehensive Review of Deep Reinforcement Learning Methods and Applications in Economics.”</span> <em>arXiv Preprint</em>, no. 2004.01509.
</div>
<div id="ref-moskowitz1999industries" class="csl-entry">
Moskowitz, Tobias J, and Mark Grinblatt. 1999. <span>“Do Industries Explain Momentum?”</span> <em>Journal of Finance</em> 54 (4): 1249–90.
</div>
<div id="ref-moskowitz2012time" class="csl-entry">
Moskowitz, Tobias J, Yao Hua Ooi, and Lasse Heje Pedersen. 2012. <span>“Time Series Momentum.”</span> <em>Journal of Financial Economics</em> 104 (2): 228–50.
</div>
<div id="ref-mossin1966equilibrium" class="csl-entry">
Mossin, Jan. 1966. <span>“Equilibrium in a Capital Asset Market.”</span> <em>Econometrica: <span>J</span>ournal of the Econometric Society</em> 34 (4): 768–83.
</div>
<div id="ref-nagy2016can" class="csl-entry">
Nagy, Zoltán, Altaf Kassam, and Linda-Eling Lee. 2016. <span>“Can <span>ESG</span> Add Alpha? <span>A</span>n Analysis of <span>ESG</span> Tilt and Momentum Strategies.”</span> <em>The Journal of Investing</em> 25 (2): 113–24.
</div>
<div id="ref-nesterov1983method" class="csl-entry">
Nesterov, Yurii. 1983. <span>“A Method for Unconstrained Convex Minimization Problem with the Rate of Convergence o (1/k^ 2).”</span> In <em>Doklady AN USSR</em>, 269:543–47.
</div>
<div id="ref-neuneier1996optimal" class="csl-entry">
Neuneier, Ralph. 1996. <span>“Optimal Asset Allocation Using Adaptive Dynamic Programming.”</span> In <em>Advances in Neural Information Processing Systems</em>, 952–58.
</div>
<div id="ref-neuneier1998enhancing" class="csl-entry">
———. 1998. <span>“Enhancing q-Learning for Optimal Asset Allocation.”</span> In <em>Advances in Neural Information Processing Systems</em>, 936–42.
</div>
<div id="ref-ngai2011application" class="csl-entry">
Ngai, Eric WT, Yong Hu, YH Wong, Yijun Chen, and Xin Sun. 2011. <span>“The Application of Data Mining Techniques in Financial Fraud Detection: A Classification Framework and an Academic Review of Literature.”</span> <em>Decision Support Systems</em> 50 (3): 559–69.
</div>
<div id="ref-ni2020conditional" class="csl-entry">
Ni, Hao, Lukasz Szpruch, Magnus Wiese, Shujian Liao, and Baoren Xiao. 2020. <span>“Conditional Sig-Wasserstein <span>GAN</span>s for Time Series Generation.”</span> <em>arXiv Preprint</em>, no. 2006.05421.
</div>
<div id="ref-novy2012momentum" class="csl-entry">
Novy-Marx, Robert. 2012. <span>“Is Momentum Really Momentum?”</span> <em>Journal of Financial Economics</em> 103 (3): 429–53.
</div>
<div id="ref-novy2015taxonomy" class="csl-entry">
Novy-Marx, Robert, and Mihail Velikov. 2015. <span>“A Taxonomy of Anomalies and Their Trading Costs.”</span> <em>Review of Financial Studies</em> 29 (1): 104–47.
</div>
<div id="ref-nuti2019adaptive" class="csl-entry">
Nuti, Giuseppe, Lluı́s Antoni Jiménez Rugama, and Kaspar Thommen. 2019. <span>“Adaptive Reticulum.”</span> <em>arXiv Preprint</em>, no. 1912.05901.
</div>
<div id="ref-nystrup2020hyperparameter" class="csl-entry">
Nystrup, Peter, Erik Lindstrom, and Henrik Madsen. 2020. <span>“Hyperparameter Optimization for Portfolio Selection.”</span> <em>Journal of Financial Data Science</em> Forthcoming.
</div>
<div id="ref-ohlson1995earnings" class="csl-entry">
Ohlson, James A. 1995. <span>“Earnings, Book Values, and Dividends in Equity Valuation.”</span> <em>Contemporary Accounting Research</em> 11 (2): 661–87.
</div>
<div id="ref-okun2011ensembles" class="csl-entry">
Okun, Oleg, Giorgio Valentini, and Matteo Re. 2011. <em>Ensembles in Machine Learning Applications</em>. Vol. 373. Springer Science &amp; Business Media.
</div>
<div id="ref-olazaran1996sociological" class="csl-entry">
Olazaran, Mikel. 1996. <span>“A Sociological Study of the Official History of the Perceptrons Controversy.”</span> <em>Social Studies of Science</em> 26 (3): 611–59.
</div>
<div id="ref-olson2018data" class="csl-entry">
Olson, Randal S, William La Cava, Zairah Mustahsan, Akshay Varik, and Jason H Moore. 2018. <span>“Data-Driven Advice for Applying Machine Learning to Bioinformatics Problems.”</span> <em>arXiv Preprint</em>, no. 1708.05070.
</div>
<div id="ref-orimoloye2019comparing" class="csl-entry">
Orimoloye, Larry Olanrewaju, Ming-Chien Sung, Tiejun Ma, and Johnnie EV Johnson. 2019. <span>“Comparing the Effectiveness of Deep Feedforward Neural Networks and Shallow Architectures for Predicting Stock Price Indices.”</span> <em>Expert Systems with Applications</em>, 112828.
</div>
<div id="ref-packer2018assessing" class="csl-entry">
Packer, Charles, Katelyn Gao, Jernej Kos, Philipp Krähenbühl, Vladlen Koltun, and Dawn Song. 2018. <span>“Assessing Generalization in Deep Reinforcement Learning.”</span> <em>arXiv Preprint</em>, no. 1810.12282.
</div>
<div id="ref-pan2009survey" class="csl-entry">
Pan, Sinno Jialin, and Qiang Yang. 2009. <span>“A Survey on Transfer Learning.”</span> <em>IEEE Transactions on Knowledge and Data Engineering</em> 22 (10): 1345–59.
</div>
<div id="ref-patel2015predicting" class="csl-entry">
Patel, Jigar, Sahil Shah, Priyank Thakkar, and K Kotecha. 2015a. <span>“Predicting Stock and Stock Price Index Movement Using Trend Deterministic Data Preparation and Machine Learning Techniques.”</span> <em>Expert Systems with Applications</em> 42 (1): 259–68.
</div>
<div id="ref-patel2015bpredicting" class="csl-entry">
Patel, Jigar, Sahil Shah, Priyank Thakkar, and Ketan Kotecha. 2015b. <span>“Predicting Stock Market Index Using Fusion of Machine Learning Techniques.”</span> <em>Expert Systems with Applications</em> 42 (4): 2162–72.
</div>
<div id="ref-patton2010monotonicity" class="csl-entry">
Patton, Andrew J, and Allan Timmermann. 2010. <span>“Monotonicity in Asset Returns: <span>N</span>ew Tests with Applications to the Term Structure, the <span>CAPM</span>, and Portfolio Sorts.”</span> <em>Journal of Financial Economics</em> 98 (3): 605–25.
</div>
<div id="ref-patton2020you" class="csl-entry">
Patton, Andrew J, and Brian M Weller. 2020. <span>“What You See Is Not What You Get: <span>T</span>he Costs of Trading Market Anomalies.”</span> <em>Journal of Financial Economics</em> Forthcoming.
</div>
<div id="ref-pearl2009causality" class="csl-entry">
Pearl, Judea. 2009. <em>Causality: Models, Reasoning and Inference. Second Edition</em>. Vol. 29. Cambridge University Press.
</div>
<div id="ref-pedersen2020enhanced" class="csl-entry">
Pedersen, Lasse Heje, Abhilash Babu, and Ari Levine. 2020. <span>“Enhanced Portfolio Optimization.”</span> <em>SSRN Working Paper</em> 3530390.
</div>
<div id="ref-penasse2018understanding" class="csl-entry">
Penasse, Julien. 2022. <span>“Understanding Alpha Decay.”</span> <em>Management Science</em> Forthcoming.
</div>
<div id="ref-pendharkar2018trading" class="csl-entry">
Pendharkar, Parag C, and Patrick Cusatis. 2018. <span>“Trading Financial Indices with Reinforcement Learning Agents.”</span> <em>Expert Systems with Applications</em> 103: 1–13.
</div>
<div id="ref-pengimprovability" class="csl-entry">
Peng, Jingfu, and Yuhong Yang. 2021b. <span>“On Improvability of Model Selection by Model Averaging.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-peng2022improvability" class="csl-entry">
———. 2021a. <span>“On Improvability of Model Selection by Model Averaging.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-perrin2019machine" class="csl-entry">
Perrin, Sarah, and Thierry Roncalli. 2019. <span>“Machine Learning Optimization Algorithms &amp; Portfolio Allocation.”</span> <em>SSRN Working Paper</em> 3425827.
</div>
<div id="ref-pesaran2011forecast" class="csl-entry">
Pesaran, M Hashem, and Andreas Pick. 2011. <span>“Forecast Combination Across Estimation Windows.”</span> <em>Journal of Business &amp; Economic Statistics</em> 29 (2): 307–18.
</div>
<div id="ref-pesaran2021factor" class="csl-entry">
Pesaran, M Hashem, and Ron Smith. 2021. <span>“Factor Strengths, Pricing Errors, and Estimation of Risk Premia.”</span> <em>SSRN Working Paper</em> 3807010.
</div>
<div id="ref-peters2017elements" class="csl-entry">
Peters, Jonas, Dominik Janzing, and Bernhard Schölkopf. 2017. <em>Elements of Causal Inference: Foundations and Learning Algorithms</em>. MIT Press.
</div>
<div id="ref-petersen2009estimating" class="csl-entry">
Petersen, Mitchell A. 2009. <span>“Estimating Standard Errors in Finance Panel Data Sets: Comparing Approaches.”</span> <em>Review of Financial Studies</em> 22 (1): 435–80.
</div>
<div id="ref-pflug20121" class="csl-entry">
Pflug, Georg Ch, Alois Pichler, and David Wozabal. 2012. <span>“The 1/n Investment Strategy Is Optimal Under High Model Ambiguity.”</span> <em>Journal of Banking &amp; Finance</em> 36 (2): 410–17.
</div>
<div id="ref-pike2020combining" class="csl-entry">
Pike, Tyler, and Francisco Vazquez-Grande. 2020. <span>“Combining Forecasts: Can Machines Beat the Average?”</span> <em>SSRN Working Paper</em> 3691117.
</div>
<div id="ref-plyakha2014equal" class="csl-entry">
Plyakha, Yuliya, Raman Uppal, and Grigory Vilkov. 2016. <span>“Equal or Value Weighting? Implications for Asset-Pricing Tests.”</span> <em>SSRN Working Paper</em> 1787045.
</div>
<div id="ref-polyak1964some" class="csl-entry">
Polyak, Boris T. 1964. <span>“Some Methods of Speeding up the Convergence of Iteration Methods.”</span> <em>USSR Computational Mathematics and Mathematical Physics</em> 4 (5): 1–17.
</div>
<div id="ref-popov2019neural" class="csl-entry">
Popov, Sergei, Stanislav Morozov, and Artem Babenko. 2019. <span>“Neural Oblivious Decision Ensembles for Deep Learning on Tabular Data.”</span> <em>arXiv Preprint</em>, no. 1909.06312.
</div>
<div id="ref-powell2011review" class="csl-entry">
Powell, Warren B, and Jun Ma. 2011. <span>“A Review of Stochastic Algorithms with Continuous Value Function Approximation and Some New Approximate Policy Iteration Algorithms for Multidimensional Continuous Applications.”</span> <em>Journal of Control Theory and Applications</em> 9 (3): 336–52.
</div>
<div id="ref-de2020crowdsourced" class="csl-entry">
Prado, Marcos López de, and Frank J Fabozzi. 2020. <span>“Crowdsourced Investment Research Through Tournaments.”</span> <em>Journal of Financial Data Science</em> 2 (1): 86–93.
</div>
<div id="ref-probst2018tunability" class="csl-entry">
Probst, Philipp, Bernd Bischl, and Anne-Laure Boulesteix. 2018. <span>“Tunability: Importance of Hyperparameters of Machine Learning Algorithms.”</span> <em>arXiv Preprint</em>, no. 1802.09596.
</div>
<div id="ref-pukthuanthong2018protocol" class="csl-entry">
Pukthuanthong, Kuntara, Richard Roll, and Avanidhar Subrahmanyam. 2018. <span>“A Protocol for Factor Identification.”</span> <em>Review of Financial Studies</em> 32 (4): 1573–1607.
</div>
<div id="ref-quionero2009dataset" class="csl-entry">
Quionero-Candela, Joaquin, Masashi Sugiyama, Anton Schwaighofer, and Neil D Lawrence. 2009. <em>Dataset Shift in Machine Learning</em>. MIT Press.
</div>
<div id="ref-rapach2013international" class="csl-entry">
Rapach, David E, Jack K Strauss, and Guofu Zhou. 2013. <span>“International Stock Return Predictability: What Is the Role of the <span>U</span>nited <span>S</span>tates?”</span> <em>Journal of Finance</em> 68 (4): 1633–62.
</div>
<div id="ref-rapach2019time" class="csl-entry">
Rapach, David, and Guofu Zhou. 2019. <span>“Time-Series and Cross-Sectional Stock Return Forecasting: New Machine Learning Methods.”</span> <em>SSRN Working Paper</em> 3428095.
</div>
<div id="ref-rashmi2015dart" class="csl-entry">
Rashmi, Korlakai Vinayak, and Ran Gilad-Bachrach. 2015. <span>“DART: Dropouts Meet Multiple Additive Regression Trees.”</span> In <em>AISTATS</em>, 489–97.
</div>
<div id="ref-ravisankar2011detection" class="csl-entry">
Ravisankar, Pediredla, Vadlamani Ravi, G Raghava Rao, and Indranil Bose. 2011. <span>“Detection of Financial Statement Fraud and Feature Selection Using Data Mining Techniques.”</span> <em>Decision Support Systems</em> 50 (2): 491–500.
</div>
<div id="ref-razin2020drowning" class="csl-entry">
Razin, Ronny, and Gilat Levy. 2020. <span>“A Maximum Likelihood Approach to Combining Forecasts.”</span> <em>Theoretical Economics</em> Forthcoming.
</div>
<div id="ref-reboredo2012nonlinearity" class="csl-entry">
Reboredo, Juan C, José M Matı́as, and Raquel Garcia-Rubio. 2012. <span>“Nonlinearity in Forecasting of High-Frequency Stock Returns.”</span> <em>Computational Economics</em> 40 (3): 245–64.
</div>
<div id="ref-regenstein2018reproducible" class="csl-entry">
Regenstein, Jonathan K. 2018. <em>Reproducible Finance with r: Code Flows and Shiny Apps for Portfolio Analysis</em>. Chapman &amp; Hall / CRC.
</div>
<div id="ref-ribeiro2016should" class="csl-entry">
Ribeiro, Marco Tulio, Sameer Singh, and Carlos Guestrin. 2016. <span>“Why Should <span>I</span> Trust You?: <span>E</span>xplaining the Predictions of Any Classifier.”</span> In <em>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 1135–44. ACM.
</div>
<div id="ref-ridgeway1999boosting" class="csl-entry">
Ridgeway, Greg, David Madigan, and Thomas Richardson. 1999. <span>“Boosting Methodology for Regression Problems.”</span> In <em>AISTATS</em>.
</div>
<div id="ref-ripley2007pattern" class="csl-entry">
Ripley, Brian D. 2007. <em>Pattern Recognition and Neural Networks</em>. Cambridge University Press.
</div>
<div id="ref-roberts1994simple" class="csl-entry">
Roberts, Gareth O, and Adrian FM Smith. 1994. <span>“Simple Conditions for the Convergence of the Gibbs Sampler and Metropolis-Hastings Algorithms.”</span> <em>Stochastic Processes and Their Applications</em> 49 (2): 207–16.
</div>
<div id="ref-roca2021new" class="csl-entry">
Roca, Florencia. 2021. <span>“What Is New in Value Investing? <span>A</span> Systematic Literature Review.”</span> <em>Journal of New Finance</em> 2 (2): 2.
</div>
<div id="ref-romano2005stepwise" class="csl-entry">
Romano, Joseph P, and Michael Wolf. 2005. <span>“Stepwise Multiple Testing as Formalized Data Snooping.”</span> <em>Econometrica</em> 73 (4): 1237–82.
</div>
<div id="ref-romano2013testing" class="csl-entry">
———. 2013. <span>“Testing for Monotonicity in Expected Asset Returns.”</span> <em>Journal of Empirical Finance</em> 23: 93–116.
</div>
<div id="ref-rosenblatt1958perceptron" class="csl-entry">
Rosenblatt, Frank. 1958. <span>“The Perceptron: A Probabilistic Model for Information Storage and Organization in the Brain.”</span> <em>Psychological Review</em> 65 (6): 386.
</div>
<div id="ref-ross1976arbitrage" class="csl-entry">
Ross, Stephen A. 1976. <span>“The Arbitrage Theory of Capital Asset Pricing.”</span> <em>Journal of Economic Theory</em> 13 (3): 341–60.
</div>
<div id="ref-rousseeuw2005robust" class="csl-entry">
Rousseeuw, Peter J, and Annick M Leroy. 2005. <em>Robust Regression and Outlier Detection</em>. Vol. 589. Wiley.
</div>
<div id="ref-ruf2019neural" class="csl-entry">
Ruf, Johannes, and Weiguan Wang. 2019. <span>“Neural Networks for Option Pricing and Hedging: A Literature Review.”</span> <em>arXiv Preprint</em>, no. 1911.05620.
</div>
<div id="ref-sangadiev2020deepfolio" class="csl-entry">
Sangadiev, Aiusha, Rodrigo Rivera-Castro, Kirill Stepanov, Andrey Poddubny, Kirill Bubenchikov, Nikita Bekezin, Polina Pilyugina, and Evgeny Burnaev. 2020. <span>“Deep<span>F</span>olio: <span>C</span>onvolutional Neural Networks for Portfolios with Limit Order Book Data.”</span> <em>arXiv Preprint</em>, no. 2008.12152.
</div>
<div id="ref-santi2018exploring" class="csl-entry">
Santi, Caterina, and Remco CJ Zwinkels. 2018. <span>“Exploring Style Herding by Mutual Funds.”</span> <em>SSRN Working Paper</em> 2986059.
</div>
<div id="ref-sato2019model" class="csl-entry">
Sato, Yoshiharu. 2019. <span>“Model-Free Reinforcement Learning for Financial Portfolios: A Brief Survey.”</span> <em>arXiv Preprint</em>, no. 1904.04973.
</div>
<div id="ref-schafer1999multiple" class="csl-entry">
Schafer, Joseph L. 1999. <span>“Multiple Imputation: A Primer.”</span> <em>Statistical Methods in Medical Research</em> 8 (1): 3–15.
</div>
<div id="ref-schapire1990strength" class="csl-entry">
Schapire, Robert E. 1990. <span>“The Strength of Weak Learnability.”</span> <em>Machine Learning</em> 5 (2): 197–227.
</div>
<div id="ref-schapire2003boosting" class="csl-entry">
———. 2003. <span>“The Boosting Approach to Machine Learning: An Overview.”</span> In <em>Nonlinear Estimation and Classification</em>, 149–71. Springer.
</div>
<div id="ref-schapire2012boosting" class="csl-entry">
Schapire, Robert E, and Yoav Freund. 2012. <em>Boosting: Foundations and Algorithms</em>. MIT Press.
</div>
<div id="ref-schnaubelt2019comparison" class="csl-entry">
Schnaubelt, Matthias. 2019. <span>“A Comparison of Machine Learning Model Validation Schemes for Non-Stationary Time Series Data.”</span> FAU Discussion Papers in Economics.
</div>
<div id="ref-schueth2003socially" class="csl-entry">
Schueth, Steve. 2003. <span>“Socially Responsible Investing in the United States.”</span> <em>Journal of Business Ethics</em> 43 (3): 189–94.
</div>
<div id="ref-scornet2015consistency" class="csl-entry">
Scornet, Erwan, Gérard Biau, Jean-Philippe Vert, et al. 2015. <span>“Consistency of Random Forests.”</span> <em>Annals of Statistics</em> 43 (4): 1716–41.
</div>
<div id="ref-seni2010ensemble" class="csl-entry">
Seni, Giovanni, and John F Elder. 2010. <span>“Ensemble Methods in Data Mining: Improving Accuracy Through Combining Predictions.”</span> <em>Synthesis Lectures on Data Mining and Knowledge Discovery</em> 2 (1): 1–126.
</div>
<div id="ref-settles2009active" class="csl-entry">
Settles, Burr. 2009. <span>“Active Learning Literature Survey.”</span> University of Wisconsin-Madison Department of Computer Sciences.
</div>
<div id="ref-settles2012active" class="csl-entry">
———. 2012. <span>“Active Learning.”</span> <em>Synthesis Lectures on Artificial Intelligence and Machine Learning</em> 6 (1): 1–114.
</div>
<div id="ref-sezer2019financial" class="csl-entry">
Sezer, Omer Berat, Mehmet Ugur Gudelek, and Ahmet Murat Ozbayoglu. 2019. <span>“Financial Time Series Forecasting with Deep Learning: A Systematic Literature Review: 2005-2019.”</span> <em>arXiv Preprint</em>, no. 1911.13288.
</div>
<div id="ref-shah2014comparison" class="csl-entry">
Shah, Anoop D, Jonathan W Bartlett, James Carpenter, Owen Nicholas, and Harry Hemingway. 2014. <span>“Comparison of Random Forest and Parametric Imputation Models for Imputing Missing Data Using MICE: A CALIBER Study.”</span> <em>American Journal of Epidemiology</em> 179 (6): 764–74.
</div>
<div id="ref-shalit2020shapley" class="csl-entry">
Shalit, Haim. 2020. <span>“The Shapley Value of Regression Portfolios.”</span> <em>Journal of Asset Management</em> 21 (6): 506–12.
</div>
<div id="ref-shanaev2020efficient" class="csl-entry">
Shanaev, Savva, and Binam Ghimire. 2020. <span>“Efficient Scholars: Academic Attention and the Disappearance of Anomalies.”</span> <em>European Journal of Finance</em> Forthcoming: 1–27.
</div>
<div id="ref-shanken1992estimation" class="csl-entry">
Shanken, Jay. 1992. <span>“On the Estimation of Beta-Pricing Models.”</span> <em>Review of Financial Studies</em> 5 (1): 1–33.
</div>
<div id="ref-shapley1953value" class="csl-entry">
Shapley, Lloyd S. 1953. <span>“A Value for n-Person Games.”</span> <em>Contributions to the Theory of Games</em> 2 (28): 307–17.
</div>
<div id="ref-sharpe1964capital" class="csl-entry">
Sharpe, William F. 1964. <span>“Capital Asset Prices: A Theory of Market Equilibrium Under Conditions of Risk.”</span> <em>Journal of Finance</em> 19 (3): 425–42.
</div>
<div id="ref-sharpe1966mutual" class="csl-entry">
———. 1966. <span>“Mutual Fund Performance.”</span> <em>Journal of Business</em> 39 (1): 119–38.
</div>
<div id="ref-shea2020searching" class="csl-entry">
Shea, Yifei, and Erhard Radatz. 2020. <span>“Searching for Inner Peace with Value Factors.”</span> <em>Risk &amp; Reward</em>, 14–19.
</div>
<div id="ref-shu2021identifying" class="csl-entry">
Shu, Tengjia, and Ashish Tiwari. 2021. <span>“Identifying Signals of the Cross Section of Stock Returns.”</span> <em>SSRN Working Paper</em> 3898282.
</div>
<div id="ref-shwartz2021tabular" class="csl-entry">
Shwartz-Ziv, Ravid, and Amitai Armon. 2021. <span>“Tabular Data: Deep Learning Is Not All You Need.”</span> <em>arXiv Preprint</em>, no. 2106.03253.
</div>
<div id="ref-silver2016mastering" class="csl-entry">
Silver, David, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George Van Den Driessche, Julian Schrittwieser, Ioannis Antonoglou, Veda Panneershelvam, and Marc Lanctot. 2016. <span>“Mastering the Game of Go with Deep Neural Networks and Tree Search.”</span> <em>Nature</em> 529: 484–89.
</div>
<div id="ref-simonian2019machine" class="csl-entry">
Simonian, Joseph, Chenwei Wu, Daniel Itano, and Vyshaal Narayanam. 2019. <span>“A Machine Learning Approach to Risk Factors: <span>A</span> Case Study Using the <span>F</span>ama-<span>F</span>rench-<span>C</span>arhart Model.”</span> <em>Journal of Financial Data Science</em> 1 (1): 32–44.
</div>
<div id="ref-simonsohn2014p" class="csl-entry">
Simonsohn, Uri, Leif D Nelson, and Joseph P Simmons. 2014. <span>“P-Curve: A Key to the File-Drawer.”</span> <em>Journal of Experimental Psychology: General</em> 143 (2): 534.
</div>
<div id="ref-sirignano2019universal" class="csl-entry">
Sirignano, Justin, and Rama Cont. 2019. <span>“Universal Features of Price Formation in Financial Markets: Perspectives from Deep Learning.”</span> <em>Quantitative Finance</em> 19 (9): 1449–59.
</div>
<div id="ref-smith2018disciplined" class="csl-entry">
Smith, Leslie N. 2018. <span>“A Disciplined Approach to Neural Network Hyper-Parameters: Part 1–Learning Rate, Batch Size, Momentum, and Weight Decay.”</span> <em>arXiv Preprint</em>, no. 1803.09820.
</div>
<div id="ref-smith2020instability" class="csl-entry">
Smith, Simon, and Allan Timmermann. 2021. <span>“Have Risk Premia Vanished?”</span> <em>SSRN Working Paper</em> 3728192.
</div>
<div id="ref-snoek2012practical" class="csl-entry">
Snoek, Jasper, Hugo Larochelle, and Ryan P Adams. 2012. <span>“Practical Bayesian Optimization of Machine Learning Algorithms.”</span> In <em>Advances in Neural Information Processing Systems</em>, 2951–59.
</div>
<div id="ref-snow2020machine" class="csl-entry">
Snow, Derek. 2020. <span>“Machine Learning in Asset Management: Part 2: Portfolio Construction—Weight Optimization.”</span> <em>Journal of Financial Data Science</em> Forthcoming.
</div>
<div id="ref-soleymani2020financial" class="csl-entry">
Soleymani, Farzan, and Eric Paquet. 2020. <span>“Financial Portfolio Optimization with Online Deep Reinforcement Learning and Restricted Stacked Autoencoder-DeepBreath.”</span> <em>Expert Systems with Applications</em> Forthcoming: 113456.
</div>
<div id="ref-sparapani2019r" class="csl-entry">
Sparapani, Rodney, Charles Spanbauer, and Robert McCulloch. 2019. <span>“The <span>BART</span> <span>R</span> Package.”</span> Comprehensive R Archive Network. <a href="https://cran.r-project.org/web/packages/BART/vignettes/the-BART-R-package.pdf">https://cran.r-project.org/web/packages/BART/vignettes/the-BART-R-package.pdf</a>.
</div>
<div id="ref-spirtes2000causation" class="csl-entry">
Spirtes, Peter, Clark N Glymour, Richard Scheines, and David Heckerman. 2000. <em>Causation, Prediction, and Search</em>. MIT Press.
</div>
<div id="ref-srivastava2014dropout" class="csl-entry">
Srivastava, Nitish, Geoffrey Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan Salakhutdinov. 2014. <span>“Dropout: A Simple Way to Prevent Neural Networks from Overfitting.”</span> <em>Journal of Machine Learning Research</em> 15 (1): 1929–58.
</div>
<div id="ref-stagnol2021understanding" class="csl-entry">
Stagnol, Lauren, Christian Lopez, Thierry Roncalli, Bruno Taillardat, and Smart Beta Team. 2021. <span>“Understanding the Performance of the Equity Value Factor.”</span> <em>Amundi Working Paper</em>.
</div>
<div id="ref-stambaugh1999predictive" class="csl-entry">
Stambaugh, Robert F. 1999. <span>“Predictive Regressions.”</span> <em>Journal of Financial Economics</em> 54 (3): 375–421.
</div>
<div id="ref-staniak2018explanations" class="csl-entry">
Staniak, Mateusz, and Przemyslaw Biecek. 2018. <span>“Explanations of Model Predictions with Live and breakDown Packages.”</span> <em>arXiv Preprint</em>, no. 1804.01955.
</div>
<div id="ref-stekhoven2011missforest" class="csl-entry">
Stekhoven, Daniel J, and Peter Bühlmann. 2011. <span>“MissForest—Non-Parametric Missing Value Imputation for Mixed-Type Data.”</span> <em>Bioinformatics</em> 28 (1): 112–18.
</div>
<div id="ref-stevens1998inverse" class="csl-entry">
Stevens, Guy VG. 1998. <span>“On the Inverse of the Covariance Matrix in Portfolio Analysis.”</span> <em>Journal of Finance</em> 53 (5): 1821–27.
</div>
<div id="ref-suhonen2017quantifying" class="csl-entry">
Suhonen, Antti, Matthias Lennkh, and Fabrice Perez. 2017. <span>“Quantifying Backtest Overfitting in Alternative Beta Strategies.”</span> <em>Journal of Portfolio Management</em> 43 (2): 90–104.
</div>
<div id="ref-sun2020time" class="csl-entry">
Sun, Yuying, YM Hong, T Lee, Shouyang Wang, and Xinyu Zhang. 2020. <span>“Time-Varying Model Averaging.”</span> <em>Journal of Econometrics</em> Forthcoming.
</div>
<div id="ref-sutton2018reinforcement" class="csl-entry">
Sutton, Richard S, and Andrew G Barto. 2018. <em>Reinforcement Learning: <span>A</span>n Introduction (2nd Edition)</em>. MIT Press.
</div>
<div id="ref-taghian2020learning" class="csl-entry">
Taghian, Mehran, Ahmad Asadi, and Reza Safabakhsh. 2020. <span>“Learning Financial Asset-Specific Trading Rules via Deep Reinforcement Learning.”</span> <em>arXiv Preprint</em>, no. 2010.14194.
</div>
<div id="ref-textor2016robust" class="csl-entry">
Textor, Johannes, Benito van der Zander, Mark S Gilthorpe, Maciej Liśkiewicz, and George TH Ellison. 2016. <span>“Robust Causal Inference Using Directed Acyclic Graphs: The r Package <span>‘Dagitty’</span>.”</span> <em>International Journal of Epidemiology</em> 45 (6): 1887–94.
</div>
<div id="ref-theate2020application" class="csl-entry">
Théate, Thibaut, and Damien Ernst. 2020. <span>“An Application of Deep Reinforcement Learning to Algorithmic Trading.”</span> <em>arXiv Preprint</em>, no. 2004.06627.
</div>
<div id="ref-tibshirani1996regression" class="csl-entry">
Tibshirani, Robert. 1996. <span>“Regression Shrinkage and Selection via the Lasso.”</span> <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 267–88.
</div>
<div id="ref-tierney1994markov" class="csl-entry">
Tierney, Luke. 1994. <span>“Markov Chains for Exploring Posterior Distributions.”</span> <em>Annals of Statistics</em>, 1701–28.
</div>
<div id="ref-tikka2017identifying" class="csl-entry">
Tikka, Santtu, and Juha Karvanen. 2017. <span>“Identifying Causal Effects with the <span>R</span> Package Causaleffect.”</span> <em>Journal of Statistical Software</em> 76 (1): 1–30.
</div>
<div id="ref-timmermann2018forecasting" class="csl-entry">
Timmermann, Allan. 2018. <span>“Forecasting Methods in Finance.”</span> <em>Annual Review of Financial Economics</em> 10: 449–79.
</div>
<div id="ref-ting2002instance" class="csl-entry">
Ting, Kai Ming. 2002. <span>“An Instance-Weighting Method to Induce Cost-Sensitive Trees.”</span> <em>IEEE Transactions on Knowledge &amp; Data Engineering</em>, no. 3: 659–65.
</div>
<div id="ref-tobek2021does" class="csl-entry">
Tobek, Ondrej, and Martin Hronec. 2021. <span>“Does It Pay to Follow Anomalies Research? <span>M</span>achine Learning Approach with International Evidence.”</span> <em>Journal of Financial Markets</em> Forthcoming: 100588.
</div>
<div id="ref-treynor1965rate" class="csl-entry">
Treynor, Jack L. 1965. <span>“How to Rate Management of Investment Funds.”</span> <em>Harvard Business Review</em> 43 (1): 63–75.
</div>
<div id="ref-tsantekidis2017forecasting" class="csl-entry">
Tsantekidis, Avraam, Nikolaos Passalis, Anastasios Tefas, Juho Kanniainen, Moncef Gabbouj, and Alexandros Iosifidis. 2017. <span>“Forecasting Stock Prices from the Limit Order Book Using Convolutional Neural Networks.”</span> In <em>2017 IEEE 19th Conference on Business Informatics (CBI)</em>, 1:7–12.
</div>
<div id="ref-tsiakas2020equity" class="csl-entry">
Tsiakas, Ilias, Jiahan Li, and Haibin Zhang. 2020. <span>“Equity Premium Prediction and the State of the Economy.”</span> <em>Journal of Empirical Finance</em> Forthcoming.
</div>
<div id="ref-tu2010incorporating" class="csl-entry">
Tu, Jun, and Guofu Zhou. 2010. <span>“Incorporating Economic Objectives into Bayesian Priors: Portfolio Choice Under Parameter Uncertainty.”</span> <em>Journal of Financial and Quantitative Analysis</em> 45 (4): 959–86.
</div>
<div id="ref-uematsu2019high" class="csl-entry">
Uematsu, Yoshimasa, and Shinya Tanaka. 2019. <span>“High-Dimensional Macroeconomic Forecasting and Variable Selection via Penalized Regression.”</span> <em>Econometrics Journal</em> 22 (1): 34–56.
</div>
<div id="ref-van2018flexible" class="csl-entry">
Van Buuren, Stef. 2018. <em>Flexible Imputation of Missing Data</em>. Chapman &amp; Hall / CRC.
</div>
<div id="ref-van2011size" class="csl-entry">
Van Dijk, Mathijs A. 2011. <span>“Is Size Dead? <span>A</span> Review of the Size Effect in Equity Returns.”</span> <em>Journal of Banking &amp; Finance</em> 35 (12): 3263–74.
</div>
<div id="ref-vapnik1963pattern" class="csl-entry">
Vapnik, Vladimir, and A. Lerner. 1963. <span>“Pattern Recognition Using Generalized Portrait Method.”</span> <em>Automation and Remote Control</em> 24: 774–80.
</div>
<div id="ref-vayanos2013institutional" class="csl-entry">
Vayanos, Dimitri, and Paul Woolley. 2013. <span>“An Institutional Theory of Momentum and Reversal.”</span> <em>Review of Financial Studies</em> 26 (5): 1087–1145.
</div>
<div id="ref-vidal2020born" class="csl-entry">
Vidal, Thibaut, Toni Pacheco, and Maximilian Schiffer. 2020. <span>“Born-Again Tree Ensembles.”</span> <em>arXiv Preprint</em>, no. 2003.11132.
</div>
<div id="ref-vincent2020investment" class="csl-entry">
Vincent, Kendro, Yu-Chin Hsu, and Hsiou-Wei Lin. 2020. <span>“Investment Styles and the Multiple Testing of Cross-Sectional Stock Return Predictability.”</span> <em>Journal of Financial Markets</em> Forthcoming: 100598.
</div>
<div id="ref-virtanen1987forecasting" class="csl-entry">
Virtanen, Ilkka, and Paavo Yli-Olli. 1987. <span>“Forecasting Stock Market Prices in a Thin Security Market.”</span> <em>Omega</em> 15 (2): 145–55.
</div>
<div id="ref-volpati2020zooming" class="csl-entry">
Volpati, Valerio, Michael Benzaquen, Zoltan Eisler, Iacopo Mastromatteo, Bence Toth, and Jean-Philippe Bouchaud. 2020. <span>“Zooming in on Equity Factor Crowding.”</span> <em>arXiv Preprint</em>, no. 2001.04185.
</div>
<div id="ref-von1972probabilistic" class="csl-entry">
Von Holstein, Carl-Axel S Staël. 1972. <span>“Probabilistic Forecasting: An Experiment Related to the Stock Market.”</span> <em>Organizational Behavior and Human Performance</em> 8 (1): 139–58.
</div>
<div id="ref-wang2011comparative" class="csl-entry">
Wang, Gang, Jinxing Hao, Jian Ma, and Hongbing Jiang. 2011. <span>“A Comparative Assessment of Ensemble Learning for Credit Scoring.”</span> <em>Expert Systems with Applications</em> 38 (1): 223–30.
</div>
<div id="ref-wang2019continuous" class="csl-entry">
Wang, Haoran, and Xun Yu Zhou. 2019. <span>“Continuous-Time Mean-Variance Portfolio Selection: A Reinforcement Learning Framework.”</span> <em>SSRN Working Paper</em> 3382932.
</div>
<div id="ref-wang2012stock" class="csl-entry">
Wang, Ju-Jie, Jian-Zhou Wang, Zhe-George Zhang, and Shu-Po Guo. 2012. <span>“Stock Index Forecasting Based on a Hybrid Model.”</span> <em>Omega</em> 40 (6): 758–66.
</div>
<div id="ref-wang2019portfolio" class="csl-entry">
Wang, Wuyu, Weizi Li, Ning Zhang, and Kecheng Liu. 2020. <span>“Portfolio Formation with Preselection Using Deep Learning from Long-Term Financial Data.”</span> <em>Expert Systems with Applications</em> 143: 113042.
</div>
<div id="ref-wang2022forecast" class="csl-entry">
Wang, Xiaoqian, Rob J Hyndman, Feng Li, and Yanfei Kang. 2022. <span>“Forecast Combinations: An over 50-Year Review.”</span> <em>arXiv Preprint</em>, no. 2205.04216.
</div>
<div id="ref-watkins1992q" class="csl-entry">
Watkins, Christopher JCH, and Peter Dayan. 1992. <span>“Q-Learning.”</span> <em>Machine Learning</em> 8 (3-4): 279–92.
</div>
<div id="ref-wei2019model" class="csl-entry">
Wei, Haoran, Yuanbo Wang, Lidia Mangu, and Keith Decker. 2019. <span>“Model-Based Reinforcement Learning for Predictions and Control for Limit Order Books.”</span> <em>arXiv Preprint</em>, no. 1910.03743.
</div>
<div id="ref-wei2021absolute" class="csl-entry">
Wei, Yi. 2021. <span>“Absolute Value Constraint: <span>T</span>he Reason for Invalid Performance Evaluation Results of Neural Network Models for Stock Price Prediction.”</span> <em>arXiv Preprint</em> 2101.10942.
</div>
<div id="ref-weiss2016survey" class="csl-entry">
Weiss, Karl, Taghi M Khoshgoftaar, and DingDing Wang. 2016. <span>“A Survey of Transfer Learning.”</span> <em>Journal of Big Data</em> 3 (1): 9.
</div>
<div id="ref-white1988economic" class="csl-entry">
White, Halbert. 1988. <span>“Economic Prediction Using Neural Networks: The Case of IBM Daily Stock Returns.”</span>
</div>
<div id="ref-white2000reality" class="csl-entry">
———. 2000. <span>“A Reality Check for Data Snooping.”</span> <em>Econometrica</em> 68 (5): 1097–1126.
</div>
<div id="ref-wickham2019welcome" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, L McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the Tidyverse.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686.
</div>
<div id="ref-widrow1960adaptive" class="csl-entry">
Widrow, Bernard, and Marcian E Hoff. 1960. <span>“Adaptive Switching Circuits.”</span> In <em>IRE WESCON Convention Record</em>, 4:96–104.
</div>
<div id="ref-wiese2019quant" class="csl-entry">
Wiese, Magnus, Robert Knobloch, Ralf Korn, and Peter Kretschmer. 2020. <span>“Quant GANs: Deep Generation of Financial Time Series.”</span> <em>Quantitative Finance</em> Forthcoming.
</div>
<div id="ref-wolpert1992connection" class="csl-entry">
Wolpert, David H. 1992a. <span>“On the Connection Between in-Sample Testing and Generalization Error.”</span> <em>Complex Systems</em> 6 (1): 47.
</div>
<div id="ref-wolpert1992stacked" class="csl-entry">
———. 1992b. <span>“Stacked Generalization.”</span> <em>Neural Networks</em> 5 (2): 241–59.
</div>
<div id="ref-wolpert1997no" class="csl-entry">
Wolpert, David H, and William G Macready. 1997. <span>“No Free Lunch Theorems for Optimization.”</span> <em>IEEE Transactions on Evolutionary Computation</em> 1 (1): 67–82.
</div>
<div id="ref-wong2020non" class="csl-entry">
Wong, Steven YK, Jennifer Chan, Lamiae Azizi, and Richard YD Xu. 2020. <span>“Time-Varying Neural Network for Stock Return Prediction.”</span> <em>arXiv Preprint</em>, no. 2003.02515.
</div>
<div id="ref-wu2020cross" class="csl-entry">
Wu, Wenbo, Jiaqi Chen, Zhibin Yang, and Michael L Tindall. 2020. <span>“A Cross-Sectional Machine Learning Approach for Hedge Fund Return Prediction and Selection.”</span> <em>Management Science</em> Forthcoming.
</div>
<div id="ref-xiong2018practical" class="csl-entry">
Xiong, Zhuoran, Xiao-Yang Liu, Shan Zhong, Hongyang Yang, and Anwar Walid. 2018. <span>“Practical Deep Reinforcement Learning Approach for Stock Trading.”</span> <em>arXiv Preprint</em>, no. 1811.07522.
</div>
<div id="ref-xu2020testing" class="csl-entry">
Xu, Ke-Li. 2020. <span>“Testing for Multiple-Horizon Predictability: Direct Regression Based Versus Implication Based.”</span> <em>Review of Financial Studies</em> Forthcoming.
</div>
<div id="ref-yang2020weighted" class="csl-entry">
Yang, Hanlin. 2020a. <span>“A Weighted Least Squares Estimator of Factor Momentum.”</span> <em>SSRN Working Paper</em> 3443998.
</div>
<div id="ref-yang2020decomposing" class="csl-entry">
———. 2020b. <span>“Decomposing Factor Momentum.”</span> <em>SSRN Working Paper</em> 3517888.
</div>
<div id="ref-yang2018investor" class="csl-entry">
Yang, Steve Y, Yangyang Yu, and Saud Almahdi. 2018. <span>“An Investor Sentiment Reward-Based Trading System Using Gaussian Inverse Reinforcement Learning Algorithm.”</span> <em>Expert Systems with Applications</em> 114: 388–401.
</div>
<div id="ref-yin2020equity" class="csl-entry">
Yin, Anwen. 2020. <span>“Equity Premium Prediction and Optimal Portfolio Decision with Bagging.”</span> <em>North American Journal of Economics and Finance</em>, 101274.
</div>
<div id="ref-yu2019model" class="csl-entry">
Yu, Pengqian, Joon Sern Lee, Ilya Kulyatin, Zekun Shi, and Sakyasingha Dasgupta. 2019. <span>“Model-Based Deep Reinforcement Learning for Dynamic Portfolio Optimization.”</span> <em>arXiv Preprint</em>, no. 1901.08740.
</div>
<div id="ref-zaremba2020have" class="csl-entry">
Zaremba, Adam, Mehmet Umutlu, and Alina Maydubura. 2020. <span>“Where Have the Profits Gone? <span>M</span>arket Efficiency and the Disappearing Equity Anomalies in Country and Industry Returns.”</span> <em>Journal of Banking &amp; Finance</em> Forthcoming: 105966.
</div>
<div id="ref-zeiler2012adadelta" class="csl-entry">
Zeiler, Matthew D. 2012. <span>“ADADELTA: An Adaptive Learning Rate Method.”</span> <em>arXiv Preprint</em>, no. 1212.5701.
</div>
<div id="ref-zhang2012ensemble" class="csl-entry">
Zhang, Cha, and Yunqian Ma. 2012. <em>Ensemble Machine Learning: Methods and Applications</em>. Springer.
</div>
<div id="ref-zhang2009stock" class="csl-entry">
Zhang, Yudong, and Lenan Wu. 2009. <span>“Stock Market Prediction of s&amp;p 500 via Combination of Improved BCO Approach and BP Neural Network.”</span> <em>Expert Systems with Applications</em> 36 (5): 8849–54.
</div>
<div id="ref-zhang2020deep" class="csl-entry">
Zhang, Zihao, Stefan Zohren, and Stephen Roberts. 2020. <span>“Deep Reinforcement Learning for Trading.”</span> <em>Journal of Financial Data Science</em> 2 (2): 25–40.
</div>
<div id="ref-zhao2021efficient" class="csl-entry">
Zhao, Long, and Rui Gao. 2022. <span>“An Efficient Dimension Reduction for Portfolio Optimization via the Most Robust Solution.”</span> <em>SSRN Working Paper</em> 3991393.
</div>
<div id="ref-zhao2019causal" class="csl-entry">
Zhao, Qingyuan, and Trevor Hastie. 2020. <span>“Causal Interpretations of Black-Box Models.”</span> <em>Journal of Business &amp; Economic Statistics</em> Forthcoming.
</div>
<div id="ref-zhou2012ensemble" class="csl-entry">
Zhou, Zhi-Hua. 2012. <em>Ensemble Methods: Foundations and Algorithms</em>. Chapman &amp; Hall / CRC.
</div>
<div id="ref-zou2005regularization" class="csl-entry">
Zou, Hui, and Trevor Hastie. 2005. <span>“Regularization and Variable Selection via the Elastic Net.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 67 (2): 301–20.
</div>
<div id="ref-zuckerman2019man" class="csl-entry">
Zuckerman, Gregory. 2019. <em>The Man Who Solved the Market: How Jim Simons Launched the Quant Revolution</em>. Penguin Random House.
</div>
</div>
</div>
</div>









































  <div class="chapter-nav">
<div class="prev"><a href="python.html"><span class="header-section-number">18</span> Python notebooks</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#solutions-to-exercises"><span class="header-section-number">19</span> Solutions to exercises</a></li>
<li><a class="nav-link" href="#chapter-3"><span class="header-section-number">19.1</span> Chapter 3</a></li>
<li><a class="nav-link" href="#chapter-4"><span class="header-section-number">19.2</span> Chapter 4</a></li>
<li><a class="nav-link" href="#chapter-5"><span class="header-section-number">19.3</span> Chapter 5</a></li>
<li><a class="nav-link" href="#chapter-6"><span class="header-section-number">19.4</span> Chapter 6</a></li>
<li><a class="nav-link" href="#chapter-7-the-autoencoder-model-universal-approximation"><span class="header-section-number">19.5</span> Chapter 7: the autoencoder model &amp; universal approximation</a></li>
<li><a class="nav-link" href="#chapter-8"><span class="header-section-number">19.6</span> Chapter 8</a></li>
<li><a class="nav-link" href="#chapter-11-ensemble-neural-network"><span class="header-section-number">19.7</span> Chapter 11: ensemble neural network</a></li>
<li>
<a class="nav-link" href="#chapter-12"><span class="header-section-number">19.8</span> Chapter 12</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ew-portfolios-with-the-tidyverse"><span class="header-section-number">19.8.1</span> EW portfolios with the tidyverse</a></li>
<li><a class="nav-link" href="#advanced-weighting-function"><span class="header-section-number">19.8.2</span> Advanced weighting function</a></li>
<li><a class="nav-link" href="#functional-programming-in-the-backtest"><span class="header-section-number">19.8.3</span> Functional programming in the backtest</a></li>
</ul>
</li>
<li><a class="nav-link" href="#chapter-15"><span class="header-section-number">19.9</span> Chapter 15</a></li>
<li><a class="nav-link" href="#chapter-16"><span class="header-section-number">19.10</span> Chapter 16</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Machine Learning for Factor Investing</strong>" was written by Guillaume Coqueret and Tony Guida. It was last built on 2022-06-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
